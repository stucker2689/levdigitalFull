<!-- REGION 01: GENERAL CONFIGURATION START-->
<!-- User Note: I Want To Use The Reporting Engine To Generate Reports -->
<apex:page standardController="ffr__ReportingDefinition__c" extensions="ffr.ReportingTemplateController" readOnly="true" showHeader="true" sidebar="false" standardStylesheets="false" renderas="{!RenderReportAs}">
<!-- User Note: I Want To Have A Single Format For All Of My Reports So That I Can Style The Fonts And Colors -->
<!-- User Note: A Standard Stylesheet Has Been Provided In The Static Resources -->
<!-- User Note: You Can Create Your Own Stylsheet In The Static Resources And Apply It To Your Reports -->
<!-- User Note: The Style Has Been Designed To Allow Variations Within Different Types Of Reports -->
<!-- User Note: Change The Last Character From D To S On The Style Classes Applied To Each Line Will Produce A Summary Report -->
<!-- User Note: A Summary Report Hides The Lowest Level Of Rows But Retains Calculations -->
    <apex:stylesheet value="{!URLFOR($Resource.ffr__ReportingDefaultStyles, 'ReportingDefaultStyles.css')}"/>
    <apex:stylesheet value="{!StyleSheetName}"/>
<!-- Variable to represent boolean true/false when needing to set other variables to these states -->
<apex:variable var="true" value="{!1=1}"/>
<apex:variable var="false" value="{!1=0}"/>
<apex:variable var="displayheader" value="{!true}"/>

<!-- User Note: I Want To Format Values On A Report In Different Ways -->
<!-- User Note: A Number Formatter Component Has Been Provided To Support Different Formats -->
<!-- User Note: The Coding Structure For The Variable Is As Follows Value/Percent Numberofdecimals Normal/Reversed Brakets/Minus 3Charcterinternationalcurrencycode/None-->
<!-- User Note: Good Practice Is To Reverse Values Using A Format Rather Than Create Calculations On The Visualforce Page So Running Totals Can Be Easily Maintained-->
<!-- User Note: You Can Add Your Own Formats To The List Below Try To Keep A Good Coding Structure-->
<apex:variable var="V2NCB" value="{0, number,#,###,###,##0.00;(#,###,###,##0.00)}"/>
<apex:variable var="P2NCB" value="{0, number,#,###,###,##0.00%;(#,###,###,##0.00%)}"/>
<apex:variable var="V0NCB" value="{0, number,#,###,###,##0;(#,###,###,##0)}"/>
<apex:variable var="P0NCB" value="{0, number,#,###,###,##0%;(#,###,###,##0%)}"/>
<apex:variable var="V2RCB" value="{0, number,(#,###,###,##0.00);#,###,###,##0.00}"/>
<apex:variable var="P2RCB" value="{0, number,(#,###,###,##0.00%);#,###,###,##0.00%}"/>
<apex:variable var="V0RCB" value="{0, number,(#,###,###,##0);#,###,###,##0}"/>
<apex:variable var="P0RCB" value="{0, number,(#,###,###,##0%);#,###,###,##0%}"/>
<apex:variable var="V2NCBUSD" value="{0, number, $#,###,###,##0.00;$(#,###,###,##0.00)}"/>
<apex:variable var="V2RCBUSD" value="{0, number, $(#,###,###,##0.00);$#,###,###,##0.00}"/>
<!-- User Note: I Want To Change All Of The Value Formats Quickly Across The Whole Of The Report -->
<!-- User Note: Having The Variables Above Assigned To A Second Variable Here Means That Just Changing This Field Will -->
<!-- User Note: Apply The Results To All The Fields Where It Is Used -->
<!-- User Note: It Is Possible To Use Individual Variables Against A Line This Method Allows You To Make A Single Change To All Related Formats -->
<apex:variable var="VN" value="{!V0NCB}"/>
<apex:variable var="PN" value="{!P2NCB}"/>
<apex:variable var="VR" value="{!V0RCB}"/>
<apex:variable var="PR" value="{!P2RCB}"/>
<apex:variable var="VZ" value="0"/>
<apex:variable var="PZ" value="0.00%"/>
<!-- REGION 01: GENERAL CONFIGURATION END-->
<!-- REGION 02: REPORT HEADER START -->
<!-- Demand The Report Definition Fields To Be Loaded Even If Data Is Not Found -->
<apex:outputText value="{!ffr__ReportingDefinition__c.Name}" rendered="false"/>
<apex:outputText value="{!ffr__ReportingDefinition__c.ffr__Description__c}" rendered="false"/>
<apex:outputText value="{!ffr__ReportingDefinition__c.ffr__Title__c}" rendered="false"/>
<apex:outputText value="{!ffr__ReportingDefinition__c.ffr__DisplayPrompts__c}" rendered="false"/>
<apex:outputText value="{!ffr__ReportingDefinition__c.ffr__ReportingTemplate__c}" rendered="false"/>
<apex:outputText value="{!ffr__ReportingDefinition__c.ffr__StyleSheet__c}" rendered="false"/>
<apex:outputText value="{!ffr__ReportingDefinition__c.ffr__PrintStyleSheet__c}" rendered="false"/>
<apex:outputText value="{!ffr__ReportingDefinition__c.ffr__CompanyLogo__c}" rendered="false"/>
<apex:outputText value="{!ffr__ReportingDefinition__c.ffr__PrintChatterFeed__c}" rendered="false"/>
<!-- User Note: Show The Error Messages From The Reporting Engine -->
<apex:pageBlock title="Messages" rendered="{!hasMessages}">
<apex:messages />
</apex:pageBlock>
<div class="chatterPosition"></div>
<!-- User Note: I Want A Consistent Header Format To All Of My Reports With Titles Descriptions And Runtime Prompts Etc -->
<!-- User Note: When Creating New Templates This Well Formatted Header Should Be Copied And Used Across All The Reports -->
<table class="ffrgridd">
<tr>
<td><apex:image url="{!URLFOR(StaticResourceImages, CompanyLogo)}" rendered="{!DisplayCompanyLogo}" styleClass="logoReport"/></td>
</tr>
<tr>
<td><h1 class="ffrtitle">{!ffr__ReportingDefinition__c.ffr__Title__c}</h1></td>
<td align="right">{!NOW()}</td>
</tr>
<tr><td class="ffrgridspacer2"></td></tr>
<tr>
<td><h1 class="ffrname">{!ffr__ReportingDefinition__c.Name}</h1></td>
<td align="right"><h2 class="ffrwhiteonwhite">{!ffr__ReportingDefinition__c.ffr__ReportingTemplate__c}</h2></td>
</tr>
<tr><td class="ffrgridspacer2"></td></tr>
<tr>
<td align="left">{!ffr__ReportingDefinition__c.ffr__Description__c}</td>
<td align="right"><h2 class="ffrwhiteonwhite">{!ffr__ReportingDefinition__c.ffr__StyleSheet__c}</h2></td>
</tr>
</table>
<!-- User Note: Create a new table to display the prompt information -->
<table class="ffrgridnotfullpage">
<tr><td class="ffrgridspacer2"></td></tr>
<tr>
<td align="left">
<table class="ffrgrid">
<apex:repeat value="{!promptList}" var="prompt" >
<tr>
<td align="left">{!prompt.label}</td>
<td align="left" class="ffrgridspacer"></td>
<td align="left"><strong>{!prompt.value}</strong></td>
</tr>
</apex:repeat>
</table>
</td>
</tr>
</table>
<!-- User Note: Insert a space after the header -->
<table class="ffrgrid">
<tr><td class="ffrgridspacer"></td></tr>
</table>
<!-- REGION 02: REPORT HEADER END -->
<!-- REGION 03: REPORT BODY START -->
<!-- This template uses any number of data ranges -->
<apex:repeat value="{!reportingDataKeyList}" var="reportingDataKey">
<apex:variable var="dataRange" value="{!reportingData[reportingDataKey]}"/>
<!-- Configuration of columns and groups (elastic template responds dynamically to existence of groups and columns -->
<!-- Column setup -->
<!-- Set the default column rendering state variables to "false" -->
<apex:variable var="RenderColumnA" value="{!false}"/>
<apex:variable var="RenderColumnB" value="{!false}"/>
<apex:variable var="RenderColumnC" value="{!false}"/>
<apex:variable var="RenderColumnD" value="{!false}"/>
<apex:variable var="RenderColumnE" value="{!false}"/>
<apex:variable var="RenderColumnF" value="{!false}"/>
<apex:variable var="RenderColumnG" value="{!false}"/>
<apex:variable var="RenderColumnH" value="{!false}"/>
<apex:variable var="RenderColumnI" value="{!false}"/>
<apex:variable var="RenderColumnJ" value="{!false}"/>
<apex:variable var="RenderColumnK" value="{!false}"/>
<apex:variable var="RenderColumnL" value="{!false}"/>
<apex:variable var="RenderColumnM" value="{!false}"/>
<apex:variable var="RenderColumnN" value="{!false}"/>
<apex:variable var="RenderColumnO" value="{!false}"/>
<apex:variable var="RenderColumnP" value="{!false}"/>
<apex:variable var="RenderColumnQ" value="{!false}"/>
<apex:variable var="RenderColumnR" value="{!false}"/>
<apex:variable var="RenderColumnS" value="{!false}"/>
<apex:variable var="RenderColumnT" value="{!false}"/>
<apex:variable var="RenderColumnU" value="{!false}"/>
<apex:variable var="RenderColumnV" value="{!false}"/>
<apex:variable var="RenderColumnW" value="{!false}"/>
<apex:variable var="RenderColumnX" value="{!false}"/>
<apex:variable var="RenderColumnY" value="{!false}"/>
<apex:variable var="RenderColumnZ" value="{!false}"/>
<!-- Set the default column rendering state for calculated columns -->
<!-- Now set the column rendering state variables according to which columns have been used (via column filter mappings) -->
<apex:repeat var="columnKey" value="{!dataRange.columnKeyList}">
    <apex:variable var="RenderColumnA" value="{!true}" rendered="{!columnKey=='A'}" />
    <apex:variable var="RenderColumnB" value="{!true}" rendered="{!columnKey=='B'}" />
    <apex:variable var="RenderColumnC" value="{!true}" rendered="{!columnKey=='C'}" />
    <apex:variable var="RenderColumnD" value="{!true}" rendered="{!columnKey=='D'}" />
    <apex:variable var="RenderColumnE" value="{!true}" rendered="{!columnKey=='E'}" />
    <apex:variable var="RenderColumnF" value="{!true}" rendered="{!columnKey=='F'}" />
    <apex:variable var="RenderColumnG" value="{!true}" rendered="{!columnKey=='G'}" />
    <apex:variable var="RenderColumnH" value="{!true}" rendered="{!columnKey=='H'}" />
    <apex:variable var="RenderColumnI" value="{!true}" rendered="{!columnKey=='I'}" />
    <apex:variable var="RenderColumnJ" value="{!true}" rendered="{!columnKey=='J'}" />
    <apex:variable var="RenderColumnK" value="{!true}" rendered="{!columnKey=='K'}" />
    <apex:variable var="RenderColumnL" value="{!true}" rendered="{!columnKey=='L'}" />
    <apex:variable var="RenderColumnM" value="{!true}" rendered="{!columnKey=='M'}" />
    <apex:variable var="RenderColumnN" value="{!true}" rendered="{!columnKey=='N'}" />
    <apex:variable var="RenderColumnO" value="{!true}" rendered="{!columnKey=='O'}" />
    <apex:variable var="RenderColumnP" value="{!true}" rendered="{!columnKey=='P'}" />
    <apex:variable var="RenderColumnQ" value="{!true}" rendered="{!columnKey=='Q'}" />
    <apex:variable var="RenderColumnR" value="{!true}" rendered="{!columnKey=='R'}" />
    <apex:variable var="RenderColumnS" value="{!true}" rendered="{!columnKey=='S'}" />
    <apex:variable var="RenderColumnT" value="{!true}" rendered="{!columnKey=='T'}" />
    <apex:variable var="RenderColumnU" value="{!true}" rendered="{!columnKey=='U'}" />
    <apex:variable var="RenderColumnV" value="{!true}" rendered="{!columnKey=='V'}" />
    <apex:variable var="RenderColumnW" value="{!true}" rendered="{!columnKey=='W'}" />
    <apex:variable var="RenderColumnX" value="{!true}" rendered="{!columnKey=='X'}" />
    <apex:variable var="RenderColumnY" value="{!true}" rendered="{!columnKey=='Y'}" />
    <apex:variable var="RenderColumnZ" value="{!true}" rendered="{!columnKey=='Z'}" />
</apex:repeat>
<!-- Group setup-->
<!-- Set the default group value rendering state variables to "false" -->
<apex:variable var="RenderGroup02" value="{!false}"/>
<apex:variable var="RenderGroup03" value="{!false}"/>
<apex:variable var="RenderGroup04" value="{!false}"/>
<apex:variable var="RenderGroup05" value="{!false}"/>
<apex:variable var="RenderGroup10" value="{!false}"/>
<apex:variable var="RenderGroup11" value="{!false}"/>
<apex:variable var="RenderGroup12" value="{!false}"/>
<apex:variable var="RenderGroup13" value="{!false}"/>
<apex:variable var="RenderGroup14" value="{!false}"/>
<apex:variable var="RenderGroup15" value="{!false}"/>
<apex:variable var="RenderGroup16" value="{!false}"/>
<apex:variable var="RenderGroup17" value="{!false}"/>
<apex:variable var="RenderGroup18" value="{!false}"/>
<apex:variable var="RenderGroup19" value="{!false}"/>
<apex:variable var="RenderGroup20" value="{!false}"/>
<!-- We need to know whether to keep group subtotals. Default condition is false -->
<apex:variable var="RenderGroupSubtotals" value="{!false}"/>
<!-- Now set the group rendering state variables according to which group values have been used, and count them -->
<!-- Additionally, if we have any of groups 01-09 we need to maintain group subtotals -->
<apex:repeat var="groupKey" value="{!dataRange.groupKeyList}">
<!-- Group-groups -->
<apex:outputPanel layout="none" rendered="{!groupKey=='02'}">
<apex:variable var="RenderGroup02" value="{!true}"/>
<apex:variable var="RenderGroupSubtotals" value="{!true}"/>
</apex:outputPanel>
<apex:outputPanel layout="none" rendered="{!groupKey=='03'}">
<apex:variable var="RenderGroup03" value="{!true}"/>
<apex:variable var="RenderGroupSubtotals" value="{!true}"/>
</apex:outputPanel>
<apex:outputPanel layout="none" rendered="{!groupKey=='04'}">
<apex:variable var="RenderGroup04" value="{!true}"/>
<apex:variable var="RenderGroupSubtotals" value="{!true}"/>
</apex:outputPanel>
<apex:outputPanel layout="none" rendered="{!groupKey=='05'}">
<apex:variable var="RenderGroup05" value="{!true}"/>
<apex:variable var="RenderGroupSubtotals" value="{!true}"/>
</apex:outputPanel>
<!-- Line-groups -->
<apex:outputPanel layout="none" rendered="{!groupKey=='10'}">
<apex:variable var="RenderGroup10" value="{!true}"/>
</apex:outputPanel>
<apex:outputPanel layout="none" rendered="{!groupKey=='11'}">
<apex:variable var="RenderGroup11" value="{!true}"/>
</apex:outputPanel>
<apex:outputPanel layout="none" rendered="{!groupKey=='12'}">
<apex:variable var="RenderGroup12" value="{!true}"/>
</apex:outputPanel>
<apex:outputPanel layout="none" rendered="{!groupKey=='13'}">
<apex:variable var="RenderGroup13" value="{!true}"/>
</apex:outputPanel>
<apex:outputPanel layout="none" rendered="{!groupKey=='14'}">
<apex:variable var="RenderGroup14" value="{!true}"/>
</apex:outputPanel>
<apex:outputPanel layout="none" rendered="{!groupKey=='15'}">
<apex:variable var="RenderGroup15" value="{!true}"/>
</apex:outputPanel>
<apex:outputPanel layout="none" rendered="{!groupKey=='16'}">
<apex:variable var="RenderGroup16" value="{!true}"/>
</apex:outputPanel>
<apex:outputPanel layout="none" rendered="{!groupKey=='17'}">
<apex:variable var="RenderGroup17" value="{!true}"/>
</apex:outputPanel>
<apex:outputPanel layout="none" rendered="{!groupKey=='18'}">
<apex:variable var="RenderGroup18" value="{!true}"/>
</apex:outputPanel>
<apex:outputPanel layout="none" rendered="{!groupKey=='19'}">
<apex:variable var="RenderGroup19" value="{!true}"/>
</apex:outputPanel>
<apex:outputPanel layout="none" rendered="{!groupKey=='20'}">
<apex:variable var="RenderGroup20" value="{!true}"/>
</apex:outputPanel>
</apex:repeat>
<table class="ffrgridnotfullpage">
<tr>
<!-- Column headings -->
<!-- Note that these are contained within outputPanels which are rendered (displayed) depending on the appropriate column render state variable -->
<!-- Groups 1-5 are groups with sub-totals (groups), 10- are groups without sub-totals (lines) -->
<!-- Group Lines for groups 1-9 (with sub-totals) are hidden - only the Subtotal Line will be displayed -->
<th class="{!if(RenderGroup10,'ffrgridtitleleftd','ffrhidden')}"><apex:outputPanel layout="none" rendered="{!RenderGroup10}"><!--{!dataRange.groupLabels['10']}--></apex:outputPanel></th>
<th class="{!if(RenderGroup11,'ffrgridtitleleftd','ffrhidden')}"><apex:outputPanel layout="none" rendered="{!RenderGroup11}"><!--{!dataRange.groupLabels['11']}--></apex:outputPanel></th>
<th class="{!if(RenderGroup12,'ffrgridtitleleftd','ffrhidden')}"><apex:outputPanel layout="none" rendered="{!RenderGroup12}"><!--{!dataRange.groupLabels['12']}--></apex:outputPanel></th>
<th class="{!if(RenderGroup13,'ffrgridtitleleftd','ffrhidden')}"><apex:outputPanel layout="none" rendered="{!RenderGroup13}"><!--{!dataRange.groupLabels['13']}--></apex:outputPanel></th>
<th class="{!if(RenderGroup14,'ffrgridtitleleftd','ffrhidden')}"><apex:outputPanel layout="none" rendered="{!RenderGroup14}"><!--{!dataRange.groupLabels['14']}--></apex:outputPanel></th>
<th class="{!if(RenderGroup15,'ffrgridtitleleftd','ffrhidden')}"><apex:outputPanel layout="none" rendered="{!RenderGroup15}"><!--{!dataRange.groupLabels['15']}--></apex:outputPanel></th>
<th class="{!if(RenderGroup16,'ffrgridtitleleftd','ffrhidden')}"><apex:outputPanel layout="none" rendered="{!RenderGroup16}"><!--{!dataRange.groupLabels['16']}--></apex:outputPanel></th>
<th class="{!if(RenderGroup17,'ffrgridtitleleftd','ffrhidden')}"><apex:outputPanel layout="none" rendered="{!RenderGroup17}"><!--{!dataRange.groupLabels['17']}--></apex:outputPanel></th>
<th class="{!if(RenderGroup18,'ffrgridtitleleftd','ffrhidden')}"><apex:outputPanel layout="none" rendered="{!RenderGroup18}"><!--{!dataRange.groupLabels['18']}--></apex:outputPanel></th>
<th class="{!if(RenderGroup19,'ffrgridtitleleftd','ffrhidden')}"><apex:outputPanel layout="none" rendered="{!RenderGroup19}"><!--{!dataRange.groupLabels['19']}--></apex:outputPanel></th>
<th class="{!if(RenderGroup20,'ffrgridtitleleftd','ffrhidden')}"><apex:outputPanel layout="none" rendered="{!RenderGroup20}"><!--{!dataRange.groupLabels['20']}--></apex:outputPanel></th>
<th class="ffrgridspacer"/>
<th style="min-width:120px" class="{!if(RenderColumnA,'ffrgridtitlerightd','ffrsubtotalhidden')}"><apex:outputPanel layout="none" rendered="{!RenderColumnA}">{!promptList[1].value}</apex:outputPanel></th>
<th style="min-width:120px" class="{!if(RenderColumnB,'ffrgridtitlerightd','ffrsubtotalhidden')}"><apex:outputPanel layout="none" rendered="{!RenderColumnB}">{!LEFT(promptList[1].value,4)} {!dataRange.columnLabels['B']}</apex:outputPanel></th>

<!--<th style="min-width:120px" class="{!if(RenderColumnB,'ffrgridtitlerightd','ffrsubtotalhidden')}"><apex:outputPanel layout="none" rendered="{!RenderColumnB}"><a href="{!Label['L04']}{!Label['L05']}" target="_blank" style="text-decoration:none;">{!dataRange.columnLabels['B']}</a></apex:outputPanel></th>-->

<!--<th style="min-width:120px" class="{!if(RenderColumnA && RenderColumnB,'ffrgridtitlerightd','ffrsubtotalhidden')}"><apex:outputPanel layout="none" rendered="{!RenderColumnA && RenderColumnB}">{!Label['L20']}</apex:outputPanel></th>
<th style="min-width:80px" class="{!if(RenderColumnA && RenderColumnB,'ffrgridtitlerightd','ffrsubtotalhidden')}"><apex:outputPanel layout="none" rendered="{!RenderColumnA && RenderColumnB}">{!Label['L22']}</apex:outputPanel></th>-->
<th style="min-width:120px" class="{!if(RenderColumnC,'ffrgridtitlerightd','ffrsubtotalhidden')}"><apex:outputPanel layout="none" rendered="{!RenderColumnC}">{!dataRange.columnLabels['C']}</apex:outputPanel></th>
<th style="min-width:120px" class="{!if(RenderColumnD,'ffrgridtitlerightd','ffrsubtotalhidden')}"><apex:outputPanel layout="none" rendered="{!RenderColumnD}">{!dataRange.columnLabels['D']}</apex:outputPanel></th>
<!--<th style="min-width:120px" class="{!if(RenderColumnC && RenderColumnD,'ffrgridtitlerightd','ffrsubtotalhidden')}"><apex:outputPanel layout="none" rendered="{!RenderColumnC && RenderColumnD}">{!Label['L21']}</apex:outputPanel></th>
<th style="min-width:80px" class="{!if(RenderColumnC && RenderColumnD,'ffrgridtitlerightd','ffrsubtotalhidden')}"><apex:outputPanel layout="none" rendered="{!RenderColumnC && RenderColumnD}">{!Label['L23']}</apex:outputPanel></th>-->
<th style="min-width:120px" class="{!if(RenderColumnE,'ffrgridtitlerightd','ffrsubtotalhidden')}"><apex:outputPanel layout="none" rendered="{!RenderColumnE}">{!dataRange.columnLabels['E']}</apex:outputPanel></th>
<th style="min-width:120px" class="{!if(RenderColumnF,'ffrgridtitlerightd','ffrsubtotalhidden')}"><apex:outputPanel layout="none" rendered="{!RenderColumnF}">{!dataRange.columnLabels['F']}</apex:outputPanel></th>
<th style="min-width:120px" class="{!if(RenderColumnG,'ffrgridtitlerightd','ffrsubtotalhidden')}"><apex:outputPanel layout="none" rendered="{!RenderColumnG}">{!dataRange.columnLabels['G']}</apex:outputPanel></th>
<th style="min-width:120px" class="{!if(RenderColumnH,'ffrgridtitlerightd','ffrsubtotalhidden')}"><apex:outputPanel layout="none" rendered="{!RenderColumnH}">{!dataRange.columnLabels['H']}</apex:outputPanel></th>
<th style="min-width:120px" class="{!if(RenderColumnI,'ffrgridtitlerightd','ffrsubtotalhidden')}"><apex:outputPanel layout="none" rendered="{!RenderColumnI}">{!dataRange.columnLabels['I']}</apex:outputPanel></th>
<th style="min-width:120px" class="{!if(RenderColumnJ,'ffrgridtitlerightd','ffrsubtotalhidden')}"><apex:outputPanel layout="none" rendered="{!RenderColumnJ}">{!dataRange.columnLabels['J']}</apex:outputPanel></th>
<th style="min-width:120px" class="{!if(RenderColumnK,'ffrgridtitlerightd','ffrsubtotalhidden')}"><apex:outputPanel layout="none" rendered="{!RenderColumnK}">{!dataRange.columnLabels['K']}</apex:outputPanel></th>
<th style="min-width:120px" class="{!if(RenderColumnL,'ffrgridtitlerightd','ffrsubtotalhidden')}"><apex:outputPanel layout="none" rendered="{!RenderColumnL}">{!dataRange.columnLabels['L']}</apex:outputPanel></th>
<th style="min-width:120px" class="{!if(RenderColumnM,'ffrgridtitlerightd','ffrsubtotalhidden')}"><apex:outputPanel layout="none" rendered="{!RenderColumnM}">{!dataRange.columnLabels['M']}</apex:outputPanel></th>
<th style="min-width:120px" class="{!if(RenderColumnN,'ffrgridtitlerightd','ffrsubtotalhidden')}"><apex:outputPanel layout="none" rendered="{!RenderColumnN}">{!dataRange.columnLabels['N']}</apex:outputPanel></th>
<th style="min-width:120px" class="{!if(RenderColumnO,'ffrgridtitlerightd','ffrsubtotalhidden')}"><apex:outputPanel layout="none" rendered="{!RenderColumnO}">{!dataRange.columnLabels['O']}</apex:outputPanel></th>
<th style="min-width:120px" class="{!if(RenderColumnP,'ffrgridtitlerightd','ffrsubtotalhidden')}"><apex:outputPanel layout="none" rendered="{!RenderColumnP}">{!dataRange.columnLabels['P']}</apex:outputPanel></th>
<th style="min-width:120px" class="{!if(RenderColumnQ,'ffrgridtitlerightd','ffrsubtotalhidden')}"><apex:outputPanel layout="none" rendered="{!RenderColumnQ}">{!dataRange.columnLabels['Q']}</apex:outputPanel></th>
<th style="min-width:120px" class="{!if(RenderColumnR,'ffrgridtitlerightd','ffrsubtotalhidden')}"><apex:outputPanel layout="none" rendered="{!RenderColumnR}">{!dataRange.columnLabels['R']}</apex:outputPanel></th>
<th style="min-width:120px" class="{!if(RenderColumnS,'ffrgridtitlerightd','ffrsubtotalhidden')}"><apex:outputPanel layout="none" rendered="{!RenderColumnS}">{!dataRange.columnLabels['S']}</apex:outputPanel></th>
<th style="min-width:120px" class="{!if(RenderColumnT,'ffrgridtitlerightd','ffrsubtotalhidden')}"><apex:outputPanel layout="none" rendered="{!RenderColumnT}">{!dataRange.columnLabels['T']}</apex:outputPanel></th>
<th style="min-width:120px" class="{!if(RenderColumnU,'ffrgridtitlerightd','ffrsubtotalhidden')}"><apex:outputPanel layout="none" rendered="{!RenderColumnU}">{!dataRange.columnLabels['U']}</apex:outputPanel></th>
<th style="min-width:120px" class="{!if(RenderColumnV,'ffrgridtitlerightd','ffrsubtotalhidden')}"><apex:outputPanel layout="none" rendered="{!RenderColumnV}">{!dataRange.columnLabels['V']}</apex:outputPanel></th>
<th style="min-width:120px" class="{!if(RenderColumnW,'ffrgridtitlerightd','ffrsubtotalhidden')}"><apex:outputPanel layout="none" rendered="{!RenderColumnW}">{!dataRange.columnLabels['W']}</apex:outputPanel></th>
<th style="min-width:120px" class="{!if(RenderColumnX,'ffrgridtitlerightd','ffrsubtotalhidden')}"><apex:outputPanel layout="none" rendered="{!RenderColumnX}">{!dataRange.columnLabels['X']}</apex:outputPanel></th>
<th style="min-width:120px" class="{!if(RenderColumnY,'ffrgridtitlerightd','ffrsubtotalhidden')}"><apex:outputPanel layout="none" rendered="{!RenderColumnY}">{!dataRange.columnLabels['Y']}</apex:outputPanel></th>
<th style="min-width:120px" class="{!if(RenderColumnZ,'ffrgridtitlerightd','ffrsubtotalhidden')}"><apex:outputPanel layout="none" rendered="{!RenderColumnZ}">{!dataRange.columnLabels['Z']}</apex:outputPanel></th>
</tr>
<!-- Set all column grand-totals to zero (if the column is in use - determined by column render state variables) -->
<tr><td class = "ffrhidden">
<apex:variable value="{!0}" var="grandTotalColumnA" rendered="{!RenderColumnA}"/>
<apex:variable value="{!0}" var="grandTotalColumnB" rendered="{!RenderColumnB}"/>
<apex:variable value="{!0}" var="grandTotalColumnC" rendered="{!RenderColumnC}"/>
<apex:variable value="{!0}" var="grandTotalColumnD" rendered="{!RenderColumnD}"/>
<apex:variable value="{!0}" var="grandTotalColumnE" rendered="{!RenderColumnE}"/>
<apex:variable value="{!0}" var="grandTotalColumnF" rendered="{!RenderColumnF}"/>
<apex:variable value="{!0}" var="grandTotalColumnG" rendered="{!RenderColumnG}"/>
<apex:variable value="{!0}" var="grandTotalColumnH" rendered="{!RenderColumnH}"/>
<apex:variable value="{!0}" var="grandTotalColumnI" rendered="{!RenderColumnI}"/>
<apex:variable value="{!0}" var="grandTotalColumnJ" rendered="{!RenderColumnJ}"/>
<apex:variable value="{!0}" var="grandTotalColumnK" rendered="{!RenderColumnK}"/>
<apex:variable value="{!0}" var="grandTotalColumnL" rendered="{!RenderColumnL}"/>
<apex:variable value="{!0}" var="grandTotalColumnM" rendered="{!RenderColumnM}"/>
<apex:variable value="{!0}" var="grandTotalColumnN" rendered="{!RenderColumnN}"/>
<apex:variable value="{!0}" var="grandTotalColumnO" rendered="{!RenderColumnO}"/>
<apex:variable value="{!0}" var="grandTotalColumnP" rendered="{!RenderColumnP}"/>
<apex:variable value="{!0}" var="grandTotalColumnQ" rendered="{!RenderColumnQ}"/>
<apex:variable value="{!0}" var="grandTotalColumnR" rendered="{!RenderColumnR}"/>
<apex:variable value="{!0}" var="grandTotalColumnS" rendered="{!RenderColumnS}"/>
<apex:variable value="{!0}" var="grandTotalColumnT" rendered="{!RenderColumnT}"/>
<apex:variable value="{!0}" var="grandTotalColumnU" rendered="{!RenderColumnU}"/>
<apex:variable value="{!0}" var="grandTotalColumnV" rendered="{!RenderColumnV}"/>
<apex:variable value="{!0}" var="grandTotalColumnW" rendered="{!RenderColumnW}"/>
<apex:variable value="{!0}" var="grandTotalColumnX" rendered="{!RenderColumnX}"/>
<apex:variable value="{!0}" var="grandTotalColumnY" rendered="{!RenderColumnY}"/>
<apex:variable value="{!0}" var="grandTotalColumnZ" rendered="{!RenderColumnZ}"/>
<!-- We need to track Sales Revenue -->
<apex:variable value="{!0}" var="salesRevenueTotalColumnA" rendered="{!RenderColumnA}"/>
<apex:variable value="{!0}" var="salesRevenueTotalColumnB" rendered="{!RenderColumnB}"/>
<apex:variable value="{!0}" var="salesRevenueTotalColumnC" rendered="{!RenderColumnC}"/>
<apex:variable value="{!0}" var="salesRevenueTotalColumnD" rendered="{!RenderColumnD}"/>
<apex:variable value="{!0}" var="salesRevenueTotalColumnE" rendered="{!RenderColumnE}"/>
<apex:variable value="{!0}" var="salesRevenueTotalColumnF" rendered="{!RenderColumnF}"/>
<apex:variable value="{!0}" var="salesRevenueTotalColumnG" rendered="{!RenderColumnG}"/>
<apex:variable value="{!0}" var="salesRevenueTotalColumnH" rendered="{!RenderColumnH}"/>
<apex:variable value="{!0}" var="salesRevenueTotalColumnI" rendered="{!RenderColumnI}"/>
<apex:variable value="{!0}" var="salesRevenueTotalColumnJ" rendered="{!RenderColumnJ}"/>
<apex:variable value="{!0}" var="salesRevenueTotalColumnK" rendered="{!RenderColumnK}"/>
<apex:variable value="{!0}" var="salesRevenueTotalColumnL" rendered="{!RenderColumnL}"/>
<apex:variable value="{!0}" var="salesRevenueTotalColumnM" rendered="{!RenderColumnM}"/>
<apex:variable value="{!0}" var="salesRevenueTotalColumnN" rendered="{!RenderColumnN}"/>
<apex:variable value="{!0}" var="salesRevenueTotalColumnO" rendered="{!RenderColumnO}"/>
<apex:variable value="{!0}" var="salesRevenueTotalColumnP" rendered="{!RenderColumnP}"/>
<apex:variable value="{!0}" var="salesRevenueTotalColumnQ" rendered="{!RenderColumnQ}"/>
<apex:variable value="{!0}" var="salesRevenueTotalColumnR" rendered="{!RenderColumnR}"/>
<apex:variable value="{!0}" var="salesRevenueTotalColumnS" rendered="{!RenderColumnS}"/>
<apex:variable value="{!0}" var="salesRevenueTotalColumnT" rendered="{!RenderColumnT}"/>
<apex:variable value="{!0}" var="salesRevenueTotalColumnU" rendered="{!RenderColumnU}"/>
<apex:variable value="{!0}" var="salesRevenueTotalColumnV" rendered="{!RenderColumnV}"/>
<apex:variable value="{!0}" var="salesRevenueTotalColumnW" rendered="{!RenderColumnW}"/>
<apex:variable value="{!0}" var="salesRevenueTotalColumnX" rendered="{!RenderColumnX}"/>
<apex:variable value="{!0}" var="salesRevenueTotalColumnY" rendered="{!RenderColumnY}"/>
<apex:variable value="{!0}" var="salesRevenueTotalColumnZ" rendered="{!RenderColumnZ}"/>
</td></tr>
<!-- We need to track whether or not the Gross Margin calculations have been displayed - this defaults to false -->
<apex:variable value="{!false}" var="GrossMarginCalculationsDisplayed"/>


<apex:variable value="{!false}" var="OperatingEBITDACalculationsDisplayed"/>

<apex:variable value="{!false}" var="EBITDACalculationsDisplayed"/>

<apex:variable value="{!false}" var="NetProfitBeforeTaxCalculationsDisplayed"/>

<!-- Iterate over the Rows -->
<apex:repeat value="{!dataRange.rowList}" var="row" >
<!-- Setup for start of row -->
<apex:variable var="rowKeyNum" value="{!VALUE(row.key)}"/>
<!-- Row-sensitive number format -->
<apex:variable var="RowNumberPattern" value="{!if(rowKeyNum>10 && rowKeyNum<61,VN,VR)}"/>
<apex:variable var="RowPercentagePattern" value="{!PN}"/>
<!-- Display the Gross Margin calculations if they have not been displayed and all the Gross Margin rows have been processed -->
<apex:outputPanel layout="none" rendered="{!!GrossMarginCalculationsDisplayed && rowKeyNum>20}">
<!-- Set calculated values as variables (for ease of use) -->
<apex:variable value="{!(grandTotalColumnA-grandTotalColumnB)}" var="grandTotalVarianceAB"/>
<apex:variable value="{!(grandTotalColumnC-grandTotalColumnD)}" var="grandTotalVarianceCD"/>
<apex:variable value="{!if(grandTotalColumnB=0,(if(grandTotalColumnA=0,0,(grandTotalVarianceAB/grandTotalColumnA))),(grandTotalVarianceAB/grandTotalColumnB))}" var="grandTotalVariancePercAB"/>
<apex:variable value="{!if(grandTotalColumnD=0,(if(grandTotalColumnC=0,0,(grandTotalVarianceCD/grandTotalColumnC))),(grandTotalVarianceCD/grandTotalColumnD))}" var="grandTotalVariancePercCD"/>
<apex:variable value="{!if(salesRevenueTotalColumnA=0,0,grandTotalColumnA/salesRevenueTotalColumnA)}" var="grossMarginPercA"/>
<apex:variable value="{!if(salesRevenueTotalColumnB=0,0,grandTotalColumnB/salesRevenueTotalColumnB)}" var="grossMarginPercB"/>
<apex:variable value="{!if(salesRevenueTotalColumnC=0,0,grandTotalColumnC/salesRevenueTotalColumnC)}" var="grossMarginPercC"/>
<apex:variable value="{!if(salesRevenueTotalColumnD=0,0,grandTotalColumnD/salesRevenueTotalColumnD)}" var="grossMarginPercD"/>
<!-- Display Gross Margin -->
<!-- The number of groups to span is 11, as groups 1 to 5 are hidden and only displayed as a Subtotal Row -->
<tr>
    <td class="ffrcalcsumlabeld" colspan="11">{!label['L10']}</td>
    <td class="ffrgridspacerd"/>
    <th class="{!if(RenderColumnA,'ffrcalcsumd','ffrsubtotalhidden')}">{!label['L06']}<apex:outputText value="{!if(grandTotalColumnA==0,VZ,VR)}" rendered="{!RenderColumnA}"><apex:param value="{!grandTotalColumnA}"/></apex:outputText></th>
    <th class="{!if(RenderColumnB,'ffrcalcsumd','ffrsubtotalhidden')}">{!label['L06']}<apex:outputText value="{!if(grandTotalColumnB==0,VZ,VR)}" rendered="{!RenderColumnB}"><apex:param value="{!grandTotalColumnB}"/></apex:outputText></th>
   <!-- <th class="{!if(RenderColumnA && RenderColumnB,'ffrcalcsumd','ffrsubtotalhidden')}">{!label['L06']}<apex:outputText value="{!if(grandTotalVarianceAB==0,VZ,VR)}" rendered="{!RenderColumnA && RenderColumnB}"><apex:param value="{!grandTotalVarianceAB}"/></apex:outputText></th> -->
    <!--<th class="{!if(RenderColumnA && RenderColumnB,'ffrcalcsumd','ffrsubtotalhidden')}"><apex:outputText value="{!if(grandTotalVariancePercAB==0,PZ,PN)}" rendered="{!RenderColumnA && RenderColumnB}"><apex:param value="{!grandTotalVariancePercAB}"/></apex:outputText></th>-->
    <th class="{!if(RenderColumnC,'ffrcalcsumd','ffrsubtotalhidden')}">{!label['L06']}<apex:outputText value="{!if(grandTotalColumnC==0,VZ,VR)}" rendered="{!RenderColumnC}"><apex:param value="{!grandTotalColumnC}"/></apex:outputText></th>
   <th class="{!if(RenderColumnD,'ffrcalcsumd','ffrsubtotalhidden')}">{!label['L06']}<apex:outputText value="{!if(grandTotalColumnD==0,VZ,VR)}" rendered="{!RenderColumnD}"><apex:param value="{!grandTotalColumnD}"/></apex:outputText></th>
<!--    <th class="{!if(RenderColumnC && RenderColumnD,'ffrcalcsumd','ffrsubtotalhidden')}">{!label['L06']}<apex:outputText value="{!if(grandTotalVarianceCD==0,VZ,VR)}" rendered="{!RenderColumnC && RenderColumnD}"><apex:param value="{!grandTotalVarianceCD}"/></apex:outputText></th> -->
<!--    <th class="{!if(RenderColumnC && RenderColumnD,'ffrcalcsumd','ffrsubtotalhidden')}"><apex:outputText value="{!if(grandTotalVariancePercCD==0,PZ,PN)}" rendered="{!RenderColumnC && RenderColumnD}"><apex:param value="{!grandTotalVariancePercCD}"/></apex:outputText></th>-->
    <th class="{!if(RenderColumnE,'ffrcalcsumd','ffrsubtotalhidden')}">{!label['L06']}<apex:outputText value="{!if(grandTotalColumnE==0,VZ,VR)}" rendered="{!RenderColumnE}"><apex:param value="{!grandTotalColumnE}"/></apex:outputText></th>
    <th class="{!if(RenderColumnF,'ffrcalcsumd','ffrsubtotalhidden')}">{!label['L06']}<apex:outputText value="{!if(grandTotalColumnF==0,VZ,VR)}" rendered="{!RenderColumnF}"><apex:param value="{!grandTotalColumnF}"/></apex:outputText></th>
    <th class="{!if(RenderColumnG,'ffrcalcsumd','ffrsubtotalhidden')}">{!label['L06']}<apex:outputText value="{!if(grandTotalColumnG==0,VZ,VR)}" rendered="{!RenderColumnG}"><apex:param value="{!grandTotalColumnG}"/></apex:outputText></th>
    <th class="{!if(RenderColumnH,'ffrcalcsumd','ffrsubtotalhidden')}">{!label['L06']}<apex:outputText value="{!if(grandTotalColumnH==0,VZ,VR)}" rendered="{!RenderColumnH}"><apex:param value="{!grandTotalColumnH}"/></apex:outputText></th>
    <th class="{!if(RenderColumnI,'ffrcalcsumd','ffrsubtotalhidden')}">{!label['L06']}<apex:outputText value="{!if(grandTotalColumnI==0,VZ,VR)}" rendered="{!RenderColumnI}"><apex:param value="{!grandTotalColumnI}"/></apex:outputText></th>
    <th class="{!if(RenderColumnJ,'ffrcalcsumd','ffrsubtotalhidden')}">{!label['L06']}<apex:outputText value="{!if(grandTotalColumnJ==0,VZ,VR)}" rendered="{!RenderColumnJ}"><apex:param value="{!grandTotalColumnJ}"/></apex:outputText></th>
    <th class="{!if(RenderColumnK,'ffrcalcsumd','ffrsubtotalhidden')}">{!label['L06']}<apex:outputText value="{!if(grandTotalColumnK==0,VZ,VR)}" rendered="{!RenderColumnK}"><apex:param value="{!grandTotalColumnK}"/></apex:outputText></th>
    <th class="{!if(RenderColumnL,'ffrcalcsumd','ffrsubtotalhidden')}">{!label['L06']}<apex:outputText value="{!if(grandTotalColumnL==0,VZ,VR)}" rendered="{!RenderColumnL}"><apex:param value="{!grandTotalColumnL}"/></apex:outputText></th>
    <th class="{!if(RenderColumnM,'ffrcalcsumd','ffrsubtotalhidden')}">{!label['L06']}<apex:outputText value="{!if(grandTotalColumnM==0,VZ,VR)}" rendered="{!RenderColumnM}"><apex:param value="{!grandTotalColumnM}"/></apex:outputText></th>
    <th class="{!if(RenderColumnN,'ffrcalcsumd','ffrsubtotalhidden')}">{!label['L06']}<apex:outputText value="{!if(grandTotalColumnN==0,VZ,VR)}" rendered="{!RenderColumnN}"><apex:param value="{!grandTotalColumnN}"/></apex:outputText></th>
    <th class="{!if(RenderColumnO,'ffrcalcsumd','ffrsubtotalhidden')}">{!label['L06']}<apex:outputText value="{!if(grandTotalColumnO==0,VZ,VR)}" rendered="{!RenderColumnO}"><apex:param value="{!grandTotalColumnO}"/></apex:outputText></th>
    <th class="{!if(RenderColumnP,'ffrcalcsumd','ffrsubtotalhidden')}">{!label['L06']}<apex:outputText value="{!if(grandTotalColumnP==0,VZ,VR)}" rendered="{!RenderColumnP}"><apex:param value="{!grandTotalColumnP}"/></apex:outputText></th>
    <th class="{!if(RenderColumnQ,'ffrcalcsumd','ffrsubtotalhidden')}">{!label['L06']}<apex:outputText value="{!if(grandTotalColumnQ==0,VZ,VR)}" rendered="{!RenderColumnQ}"><apex:param value="{!grandTotalColumnQ}"/></apex:outputText></th>
    <th class="{!if(RenderColumnR,'ffrcalcsumd','ffrsubtotalhidden')}">{!label['L06']}<apex:outputText value="{!if(grandTotalColumnR==0,VZ,VR)}" rendered="{!RenderColumnR}"><apex:param value="{!grandTotalColumnR}"/></apex:outputText></th>
    <th class="{!if(RenderColumnS,'ffrcalcsumd','ffrsubtotalhidden')}">{!label['L06']}<apex:outputText value="{!if(grandTotalColumnS==0,VZ,VR)}" rendered="{!RenderColumnS}"><apex:param value="{!grandTotalColumnS}"/></apex:outputText></th>
    <th class="{!if(RenderColumnT,'ffrcalcsumd','ffrsubtotalhidden')}">{!label['L06']}<apex:outputText value="{!if(grandTotalColumnT==0,VZ,VR)}" rendered="{!RenderColumnT}"><apex:param value="{!grandTotalColumnT}"/></apex:outputText></th>
    <th class="{!if(RenderColumnU,'ffrcalcsumd','ffrsubtotalhidden')}">{!label['L06']}<apex:outputText value="{!if(grandTotalColumnU==0,VZ,VR)}" rendered="{!RenderColumnU}"><apex:param value="{!grandTotalColumnU}"/></apex:outputText></th>
    <th class="{!if(RenderColumnV,'ffrcalcsumd','ffrsubtotalhidden')}">{!label['L06']}<apex:outputText value="{!if(grandTotalColumnV==0,VZ,VR)}" rendered="{!RenderColumnV}"><apex:param value="{!grandTotalColumnV}"/></apex:outputText></th>
    <th class="{!if(RenderColumnW,'ffrcalcsumd','ffrsubtotalhidden')}">{!label['L06']}<apex:outputText value="{!if(grandTotalColumnW==0,VZ,VR)}" rendered="{!RenderColumnW}"><apex:param value="{!grandTotalColumnW}"/></apex:outputText></th>
    <th class="{!if(RenderColumnX,'ffrcalcsumd','ffrsubtotalhidden')}">{!label['L06']}<apex:outputText value="{!if(grandTotalColumnX==0,VZ,VR)}" rendered="{!RenderColumnX}"><apex:param value="{!grandTotalColumnX}"/></apex:outputText></th>
    <th class="{!if(RenderColumnY,'ffrcalcsumd','ffrsubtotalhidden')}">{!label['L06']}<apex:outputText value="{!if(grandTotalColumnY==0,VZ,VR)}" rendered="{!RenderColumnY}"><apex:param value="{!grandTotalColumnY}"/></apex:outputText></th>
    <th class="{!if(RenderColumnZ,'ffrcalcsumd','ffrsubtotalhidden')}">{!label['L06']}<apex:outputText value="{!if(grandTotalColumnZ==0,VZ,VR)}" rendered="{!RenderColumnZ}"><apex:param value="{!grandTotalColumnZ}"/></apex:outputText></th>
</tr>
<!-- Spacer -->
<tr><td class="ffrgridspacerd" colspan="11"></td></tr>
<!-- Display Gross Margin % -->
<tr>
<td class="ffrcalcsumlabeld" colspan="11">{!label['L11']}</td>
<td class="ffrgridspacerd"/>
<th class="{!if(RenderColumnA,'ffrcalcsumd','ffrsubtotalhidden')}"><apex:outputText value="{!if(grossMarginPercA==0,PZ,PN)}" rendered="{!RenderColumnA}"><apex:param value="{!grossMarginPercA}"/></apex:outputText></th>
<th class="{!if(RenderColumnB,'ffrcalcsumd','ffrsubtotalhidden')}"><apex:outputText value="{!if(grossMarginPercB==0,PZ,PN)}" rendered="{!RenderColumnB}"><apex:param value="{!grossMarginPercB}"/></apex:outputText></th>
<!--<th class="{!if(RenderColumnA && RenderColumnB,'ffrcalcsumd','ffrsubtotalhidden')}"><apex:outputText value="{!if((grossMarginPercA-grossMarginPercB)==0,PZ,PN)}" rendered="{!RenderColumnA && RenderColumnB}"><apex:param value="{!(grossMarginPercA-grossMarginPercB)}"/></apex:outputText></th>-->
<!--<th class="{!if(RenderColumnA && RenderColumnB,'ffrcalcsumd','ffrsubtotalhidden')}"><apex:outputText value="{!if((grossMarginPercA-grossMarginPercB)==0,PZ,PN)}" rendered="{!RenderColumnA && RenderColumnB}"><apex:param value="{!(grossMarginPercA-grossMarginPercB)}"/></apex:outputText></th> -->
<th class="{!if(RenderColumnC,'ffrcalcsumd','ffrsubtotalhidden')}"><apex:outputText value="{!if(grossMarginPercC==0,PZ,PN)}" rendered="{!RenderColumnC}"><apex:param value="{!grossMarginPercC}"/></apex:outputText></th>
<th class="{!if(RenderColumnD,'ffrcalcsumd','ffrsubtotalhidden')}"><apex:outputText value="{!if(grossMarginPercD==0,PZ,PN)}" rendered="{!RenderColumnD}"><apex:param value="{!grossMarginPercD}"/></apex:outputText></th>
<!--<th class="{!if(RenderColumnC && RenderColumnD,'ffrcalcsumd','ffrsubtotalhidden')}"><apex:outputText value="{!if((grossMarginPercC-grossMarginPercD)==0,PZ,PN)}" rendered="{!RenderColumnC && RenderColumnD}"><apex:param value="{!(grossMarginPercC-grossMarginPercD)}"/></apex:outputText></th>
<th class="{!if(RenderColumnC && RenderColumnD,'ffrcalcsumd','ffrsubtotalhidden')}"><apex:outputText value="{!if((grossMarginPercC-grossMarginPercD)==0,PZ,PN)}" rendered="{!RenderColumnC && RenderColumnD}"><apex:param value="{!(grossMarginPercC-grossMarginPercD)}"/></apex:outputText></th>-->
<th class="{!if(RenderColumnE,'ffrcalcsumd','ffrsubtotalhidden')}"><apex:outputText value="{!if(if(salesRevenueTotalColumnE=0,0,grandTotalColumnE/salesRevenueTotalColumnE)==0,PZ,PN)}" rendered="{!RenderColumnE}"><apex:param value="{!if(salesRevenueTotalColumnE=0,0,grandTotalColumnE/salesRevenueTotalColumnE)}"/></apex:outputText></th>
<th class="{!if(RenderColumnF,'ffrcalcsumd','ffrsubtotalhidden')}"><apex:outputText value="{!if(if(salesRevenueTotalColumnF=0,0,grandTotalColumnF/salesRevenueTotalColumnF)==0,PZ,PN)}" rendered="{!RenderColumnF}"><apex:param value="{!if(salesRevenueTotalColumnF=0,0,grandTotalColumnF/salesRevenueTotalColumnF)}"/></apex:outputText></th>
<th class="{!if(RenderColumnG,'ffrcalcsumd','ffrsubtotalhidden')}"><apex:outputText value="{!if(if(salesRevenueTotalColumnG=0,0,grandTotalColumnG/salesRevenueTotalColumnG)==0,PZ,PN)}" rendered="{!RenderColumnG}"><apex:param value="{!if(salesRevenueTotalColumnG=0,0,grandTotalColumnG/salesRevenueTotalColumnG)}"/></apex:outputText></th>
<th class="{!if(RenderColumnH,'ffrcalcsumd','ffrsubtotalhidden')}"><apex:outputText value="{!if(if(salesRevenueTotalColumnH=0,0,grandTotalColumnH/salesRevenueTotalColumnH)==0,PZ,PN)}" rendered="{!RenderColumnH}"><apex:param value="{!if(salesRevenueTotalColumnH=0,0,grandTotalColumnH/salesRevenueTotalColumnH)}"/></apex:outputText></th>
<th class="{!if(RenderColumnI,'ffrcalcsumd','ffrsubtotalhidden')}"><apex:outputText value="{!if(if(salesRevenueTotalColumnI=0,0,grandTotalColumnI/salesRevenueTotalColumnI)==0,PZ,PN)}" rendered="{!RenderColumnI}"><apex:param value="{!if(salesRevenueTotalColumnI=0,0,grandTotalColumnI/salesRevenueTotalColumnI)}"/></apex:outputText></th>
<th class="{!if(RenderColumnJ,'ffrcalcsumd','ffrsubtotalhidden')}"><apex:outputText value="{!if(if(salesRevenueTotalColumnJ=0,0,grandTotalColumnJ/salesRevenueTotalColumnJ)==0,PZ,PN)}" rendered="{!RenderColumnJ}"><apex:param value="{!if(salesRevenueTotalColumnJ=0,0,grandTotalColumnJ/salesRevenueTotalColumnJ)}"/></apex:outputText></th>
<th class="{!if(RenderColumnK,'ffrcalcsumd','ffrsubtotalhidden')}"><apex:outputText value="{!if(if(salesRevenueTotalColumnK=0,0,grandTotalColumnK/salesRevenueTotalColumnK)==0,PZ,PN)}" rendered="{!RenderColumnK}"><apex:param value="{!if(salesRevenueTotalColumnK=0,0,grandTotalColumnK/salesRevenueTotalColumnK)}"/></apex:outputText></th>
<th class="{!if(RenderColumnL,'ffrcalcsumd','ffrsubtotalhidden')}"><apex:outputText value="{!if(if(salesRevenueTotalColumnL=0,0,grandTotalColumnL/salesRevenueTotalColumnL)==0,PZ,PN)}" rendered="{!RenderColumnL}"><apex:param value="{!if(salesRevenueTotalColumnL=0,0,grandTotalColumnL/salesRevenueTotalColumnL)}"/></apex:outputText></th>
<th class="{!if(RenderColumnM,'ffrcalcsumd','ffrsubtotalhidden')}"><apex:outputText value="{!if(if(salesRevenueTotalColumnM=0,0,grandTotalColumnM/salesRevenueTotalColumnM)==0,PZ,PN)}" rendered="{!RenderColumnM}"><apex:param value="{!if(salesRevenueTotalColumnM=0,0,grandTotalColumnM/salesRevenueTotalColumnM)}"/></apex:outputText></th>
<th class="{!if(RenderColumnN,'ffrcalcsumd','ffrsubtotalhidden')}"><apex:outputText value="{!if(if(salesRevenueTotalColumnN=0,0,grandTotalColumnN/salesRevenueTotalColumnN)==0,PZ,PN)}" rendered="{!RenderColumnN}"><apex:param value="{!if(salesRevenueTotalColumnN=0,0,grandTotalColumnN/salesRevenueTotalColumnN)}"/></apex:outputText></th>
<th class="{!if(RenderColumnO,'ffrcalcsumd','ffrsubtotalhidden')}"><apex:outputText value="{!if(if(salesRevenueTotalColumnO=0,0,grandTotalColumnO/salesRevenueTotalColumnO)==0,PZ,PN)}" rendered="{!RenderColumnO}"><apex:param value="{!if(salesRevenueTotalColumnO=0,0,grandTotalColumnO/salesRevenueTotalColumnO)}"/></apex:outputText></th>
<th class="{!if(RenderColumnP,'ffrcalcsumd','ffrsubtotalhidden')}"><apex:outputText value="{!if(if(salesRevenueTotalColumnP=0,0,grandTotalColumnP/salesRevenueTotalColumnP)==0,PZ,PN)}" rendered="{!RenderColumnP}"><apex:param value="{!if(salesRevenueTotalColumnP=0,0,grandTotalColumnP/salesRevenueTotalColumnP)}"/></apex:outputText></th>
<th class="{!if(RenderColumnQ,'ffrcalcsumd','ffrsubtotalhidden')}"><apex:outputText value="{!if(if(salesRevenueTotalColumnQ=0,0,grandTotalColumnQ/salesRevenueTotalColumnQ)==0,PZ,PN)}" rendered="{!RenderColumnQ}"><apex:param value="{!if(salesRevenueTotalColumnQ=0,0,grandTotalColumnQ/salesRevenueTotalColumnQ)}"/></apex:outputText></th>
<th class="{!if(RenderColumnR,'ffrcalcsumd','ffrsubtotalhidden')}"><apex:outputText value="{!if(if(salesRevenueTotalColumnR=0,0,grandTotalColumnR/salesRevenueTotalColumnR)==0,PZ,PN)}" rendered="{!RenderColumnR}"><apex:param value="{!if(salesRevenueTotalColumnR=0,0,grandTotalColumnR/salesRevenueTotalColumnR)}"/></apex:outputText></th>
<th class="{!if(RenderColumnS,'ffrcalcsumd','ffrsubtotalhidden')}"><apex:outputText value="{!if(if(salesRevenueTotalColumnS=0,0,grandTotalColumnS/salesRevenueTotalColumnS)==0,PZ,PN)}" rendered="{!RenderColumnS}"><apex:param value="{!if(salesRevenueTotalColumnS=0,0,grandTotalColumnS/salesRevenueTotalColumnS)}"/></apex:outputText></th>
<th class="{!if(RenderColumnT,'ffrcalcsumd','ffrsubtotalhidden')}"><apex:outputText value="{!if(if(salesRevenueTotalColumnT=0,0,grandTotalColumnT/salesRevenueTotalColumnT)==0,PZ,PN)}" rendered="{!RenderColumnT}"><apex:param value="{!if(salesRevenueTotalColumnT=0,0,grandTotalColumnT/salesRevenueTotalColumnT)}"/></apex:outputText></th>
<th class="{!if(RenderColumnU,'ffrcalcsumd','ffrsubtotalhidden')}"><apex:outputText value="{!if(if(salesRevenueTotalColumnU=0,0,grandTotalColumnU/salesRevenueTotalColumnU)==0,PZ,PN)}" rendered="{!RenderColumnU}"><apex:param value="{!if(salesRevenueTotalColumnU=0,0,grandTotalColumnU/salesRevenueTotalColumnU)}"/></apex:outputText></th>
<th class="{!if(RenderColumnV,'ffrcalcsumd','ffrsubtotalhidden')}"><apex:outputText value="{!if(if(salesRevenueTotalColumnV=0,0,grandTotalColumnV/salesRevenueTotalColumnV)==0,PZ,PN)}" rendered="{!RenderColumnV}"><apex:param value="{!if(salesRevenueTotalColumnV=0,0,grandTotalColumnV/salesRevenueTotalColumnV)}"/></apex:outputText></th>
<th class="{!if(RenderColumnW,'ffrcalcsumd','ffrsubtotalhidden')}"><apex:outputText value="{!if(if(salesRevenueTotalColumnW=0,0,grandTotalColumnW/salesRevenueTotalColumnW)==0,PZ,PN)}" rendered="{!RenderColumnW}"><apex:param value="{!if(salesRevenueTotalColumnW=0,0,grandTotalColumnW/salesRevenueTotalColumnW)}"/></apex:outputText></th>
<th class="{!if(RenderColumnX,'ffrcalcsumd','ffrsubtotalhidden')}"><apex:outputText value="{!if(if(salesRevenueTotalColumnX=0,0,grandTotalColumnX/salesRevenueTotalColumnX)==0,PZ,PN)}" rendered="{!RenderColumnX}"><apex:param value="{!if(salesRevenueTotalColumnX=0,0,grandTotalColumnX/salesRevenueTotalColumnX)}"/></apex:outputText></th>
<th class="{!if(RenderColumnY,'ffrcalcsumd','ffrsubtotalhidden')}"><apex:outputText value="{!if(if(salesRevenueTotalColumnY=0,0,grandTotalColumnY/salesRevenueTotalColumnY)==0,PZ,PN)}" rendered="{!RenderColumnY}"><apex:param value="{!if(salesRevenueTotalColumnY=0,0,grandTotalColumnY/salesRevenueTotalColumnY)}"/></apex:outputText></th>
<th class="{!if(RenderColumnZ,'ffrcalcsumd','ffrsubtotalhidden')}"><apex:outputText value="{!if(if(salesRevenueTotalColumnZ=0,0,grandTotalColumnZ/salesRevenueTotalColumnZ)==0,PZ,PN)}" rendered="{!RenderColumnZ}"><apex:param value="{!if(salesRevenueTotalColumnZ=0,0,grandTotalColumnZ/salesRevenueTotalColumnZ)}"/></apex:outputText></th>
</tr>
<!-- Spacer -->
<tr><td class="ffrgridspacerd" colspan="11"></td></tr>
<!-- Set the flag to indicate that we have displayed Gross Margin calculations -->
<apex:variable value="{!true}" var="GrossMarginCalculationsDisplayed"/>
</apex:outputPanel>



<!--Operating EBITDA calculation -->
<apex:outputPanel layout="none" rendered="{!!OperatingEBITDACalculationsDisplayed && rowKeyNum>39}">
<!-- Set calculated values as variables (for ease of use) -->
<apex:variable value="{!(grandTotalColumnA-grandTotalColumnB)}" var="grandTotalVarianceAB"/>
<apex:variable value="{!(grandTotalColumnC-grandTotalColumnD)}" var="grandTotalVarianceCD"/>
<apex:variable value="{!if(grandTotalColumnB=0,(if(grandTotalColumnA=0,0,(grandTotalVarianceAB/grandTotalColumnA))),(grandTotalVarianceAB/grandTotalColumnB))}" var="grandTotalVariancePercAB"/>
<apex:variable value="{!if(grandTotalColumnD=0,(if(grandTotalColumnC=0,0,(grandTotalVarianceCD/grandTotalColumnC))),(grandTotalVarianceCD/grandTotalColumnD))}" var="grandTotalVariancePercCD"/>
<apex:variable value="{!if(salesRevenueTotalColumnA=0,0,grandTotalColumnA/salesRevenueTotalColumnA)}" var="grossMarginPercA"/>
<apex:variable value="{!if(salesRevenueTotalColumnB=0,0,grandTotalColumnB/salesRevenueTotalColumnB)}" var="grossMarginPercB"/>
<apex:variable value="{!if(salesRevenueTotalColumnC=0,0,grandTotalColumnC/salesRevenueTotalColumnC)}" var="grossMarginPercC"/>
<apex:variable value="{!if(salesRevenueTotalColumnD=0,0,grandTotalColumnD/salesRevenueTotalColumnD)}" var="grossMarginPercD"/>
<!-- Display Gross Margin -->
<!-- The number of groups to span is 11, as groups 1 to 5 are hidden and only displayed as a Subtotal Row -->
<tr>
    <td class="ffrcalcsumlabeld" colspan="11">{!label['L14']}</td>
    <td class="ffrgridspacerd"/>
    <th class="{!if(RenderColumnA,'ffrcalcsumd','ffrsubtotalhidden')}">{!label['L06']}<apex:outputText value="{!if(grandTotalColumnA==0,VZ,VR)}" rendered="{!RenderColumnA}"><apex:param value="{!grandTotalColumnA}"/></apex:outputText></th>
    <th class="{!if(RenderColumnB,'ffrcalcsumd','ffrsubtotalhidden')}">{!label['L06']}<apex:outputText value="{!if(grandTotalColumnB==0,VZ,VR)}" rendered="{!RenderColumnB}"><apex:param value="{!grandTotalColumnB}"/></apex:outputText></th>
    <!--<th class="{!if(RenderColumnA && RenderColumnB,'ffrcalcsumd','ffrsubtotalhidden')}">{!label['L06']}<apex:outputText value="{!if(grandTotalVarianceAB==0,VZ,VR)}" rendered="{!RenderColumnA && RenderColumnB}"><apex:param value="{!grandTotalVarianceAB}"/></apex:outputText></th>
    <th class="{!if(RenderColumnA && RenderColumnB,'ffrcalcsumd','ffrsubtotalhidden')}"><apex:outputText value="{!if(grandTotalVariancePercAB==0,PZ,PN)}" rendered="{!RenderColumnA && RenderColumnB}"><apex:param value="{!grandTotalVariancePercAB}"/></apex:outputText></th>-->
    <th class="{!if(RenderColumnC,'ffrcalcsumd','ffrsubtotalhidden')}">{!label['L06']}<apex:outputText value="{!if(grandTotalColumnC==0,VZ,VR)}" rendered="{!RenderColumnC}"><apex:param value="{!grandTotalColumnC}"/></apex:outputText></th>
    <th class="{!if(RenderColumnD,'ffrcalcsumd','ffrsubtotalhidden')}">{!label['L06']}<apex:outputText value="{!if(grandTotalColumnD==0,VZ,VR)}" rendered="{!RenderColumnD}"><apex:param value="{!grandTotalColumnD}"/></apex:outputText></th>
    <!--<th class="{!if(RenderColumnC && RenderColumnD,'ffrcalcsumd','ffrsubtotalhidden')}">{!label['L06']}<apex:outputText value="{!if(grandTotalVarianceCD==0,VZ,VR)}" rendered="{!RenderColumnC && RenderColumnD}"><apex:param value="{!grandTotalVarianceCD}"/></apex:outputText></th>
    <th class="{!if(RenderColumnC && RenderColumnD,'ffrcalcsumd','ffrsubtotalhidden')}"><apex:outputText value="{!if(grandTotalVariancePercCD==0,PZ,PN)}" rendered="{!RenderColumnC && RenderColumnD}"><apex:param value="{!grandTotalVariancePercCD}"/></apex:outputText></th> -->
    <th class="{!if(RenderColumnE,'ffrcalcsumd','ffrsubtotalhidden')}">{!label['L06']}<apex:outputText value="{!if(grandTotalColumnE==0,VZ,VR)}" rendered="{!RenderColumnE}"><apex:param value="{!grandTotalColumnE}"/></apex:outputText></th>
    <th class="{!if(RenderColumnF,'ffrcalcsumd','ffrsubtotalhidden')}">{!label['L06']}<apex:outputText value="{!if(grandTotalColumnF==0,VZ,VR)}" rendered="{!RenderColumnF}"><apex:param value="{!grandTotalColumnF}"/></apex:outputText></th>
    <th class="{!if(RenderColumnG,'ffrcalcsumd','ffrsubtotalhidden')}">{!label['L06']}<apex:outputText value="{!if(grandTotalColumnG==0,VZ,VR)}" rendered="{!RenderColumnG}"><apex:param value="{!grandTotalColumnG}"/></apex:outputText></th>
    <th class="{!if(RenderColumnH,'ffrcalcsumd','ffrsubtotalhidden')}">{!label['L06']}<apex:outputText value="{!if(grandTotalColumnH==0,VZ,VR)}" rendered="{!RenderColumnH}"><apex:param value="{!grandTotalColumnH}"/></apex:outputText></th>
    <th class="{!if(RenderColumnI,'ffrcalcsumd','ffrsubtotalhidden')}">{!label['L06']}<apex:outputText value="{!if(grandTotalColumnI==0,VZ,VR)}" rendered="{!RenderColumnI}"><apex:param value="{!grandTotalColumnI}"/></apex:outputText></th>
    <th class="{!if(RenderColumnJ,'ffrcalcsumd','ffrsubtotalhidden')}">{!label['L06']}<apex:outputText value="{!if(grandTotalColumnJ==0,VZ,VR)}" rendered="{!RenderColumnJ}"><apex:param value="{!grandTotalColumnJ}"/></apex:outputText></th>
    <th class="{!if(RenderColumnK,'ffrcalcsumd','ffrsubtotalhidden')}">{!label['L06']}<apex:outputText value="{!if(grandTotalColumnK==0,VZ,VR)}" rendered="{!RenderColumnK}"><apex:param value="{!grandTotalColumnK}"/></apex:outputText></th>
    <th class="{!if(RenderColumnL,'ffrcalcsumd','ffrsubtotalhidden')}">{!label['L06']}<apex:outputText value="{!if(grandTotalColumnL==0,VZ,VR)}" rendered="{!RenderColumnL}"><apex:param value="{!grandTotalColumnL}"/></apex:outputText></th>
    <th class="{!if(RenderColumnM,'ffrcalcsumd','ffrsubtotalhidden')}">{!label['L06']}<apex:outputText value="{!if(grandTotalColumnM==0,VZ,VR)}" rendered="{!RenderColumnM}"><apex:param value="{!grandTotalColumnM}"/></apex:outputText></th>
    <th class="{!if(RenderColumnN,'ffrcalcsumd','ffrsubtotalhidden')}">{!label['L06']}<apex:outputText value="{!if(grandTotalColumnN==0,VZ,VR)}" rendered="{!RenderColumnN}"><apex:param value="{!grandTotalColumnN}"/></apex:outputText></th>
    <th class="{!if(RenderColumnO,'ffrcalcsumd','ffrsubtotalhidden')}">{!label['L06']}<apex:outputText value="{!if(grandTotalColumnO==0,VZ,VR)}" rendered="{!RenderColumnO}"><apex:param value="{!grandTotalColumnO}"/></apex:outputText></th>
    <th class="{!if(RenderColumnP,'ffrcalcsumd','ffrsubtotalhidden')}">{!label['L06']}<apex:outputText value="{!if(grandTotalColumnP==0,VZ,VR)}" rendered="{!RenderColumnP}"><apex:param value="{!grandTotalColumnP}"/></apex:outputText></th>
    <th class="{!if(RenderColumnQ,'ffrcalcsumd','ffrsubtotalhidden')}">{!label['L06']}<apex:outputText value="{!if(grandTotalColumnQ==0,VZ,VR)}" rendered="{!RenderColumnQ}"><apex:param value="{!grandTotalColumnQ}"/></apex:outputText></th>
    <th class="{!if(RenderColumnR,'ffrcalcsumd','ffrsubtotalhidden')}">{!label['L06']}<apex:outputText value="{!if(grandTotalColumnR==0,VZ,VR)}" rendered="{!RenderColumnR}"><apex:param value="{!grandTotalColumnR}"/></apex:outputText></th>
    <th class="{!if(RenderColumnS,'ffrcalcsumd','ffrsubtotalhidden')}">{!label['L06']}<apex:outputText value="{!if(grandTotalColumnS==0,VZ,VR)}" rendered="{!RenderColumnS}"><apex:param value="{!grandTotalColumnS}"/></apex:outputText></th>
    <th class="{!if(RenderColumnT,'ffrcalcsumd','ffrsubtotalhidden')}">{!label['L06']}<apex:outputText value="{!if(grandTotalColumnT==0,VZ,VR)}" rendered="{!RenderColumnT}"><apex:param value="{!grandTotalColumnT}"/></apex:outputText></th>
    <th class="{!if(RenderColumnU,'ffrcalcsumd','ffrsubtotalhidden')}">{!label['L06']}<apex:outputText value="{!if(grandTotalColumnU==0,VZ,VR)}" rendered="{!RenderColumnU}"><apex:param value="{!grandTotalColumnU}"/></apex:outputText></th>
    <th class="{!if(RenderColumnV,'ffrcalcsumd','ffrsubtotalhidden')}">{!label['L06']}<apex:outputText value="{!if(grandTotalColumnV==0,VZ,VR)}" rendered="{!RenderColumnV}"><apex:param value="{!grandTotalColumnV}"/></apex:outputText></th>
    <th class="{!if(RenderColumnW,'ffrcalcsumd','ffrsubtotalhidden')}">{!label['L06']}<apex:outputText value="{!if(grandTotalColumnW==0,VZ,VR)}" rendered="{!RenderColumnW}"><apex:param value="{!grandTotalColumnW}"/></apex:outputText></th>
    <th class="{!if(RenderColumnX,'ffrcalcsumd','ffrsubtotalhidden')}">{!label['L06']}<apex:outputText value="{!if(grandTotalColumnX==0,VZ,VR)}" rendered="{!RenderColumnX}"><apex:param value="{!grandTotalColumnX}"/></apex:outputText></th>
    <th class="{!if(RenderColumnY,'ffrcalcsumd','ffrsubtotalhidden')}">{!label['L06']}<apex:outputText value="{!if(grandTotalColumnY==0,VZ,VR)}" rendered="{!RenderColumnY}"><apex:param value="{!grandTotalColumnY}"/></apex:outputText></th>
    <th class="{!if(RenderColumnZ,'ffrcalcsumd','ffrsubtotalhidden')}">{!label['L06']}<apex:outputText value="{!if(grandTotalColumnZ==0,VZ,VR)}" rendered="{!RenderColumnZ}"><apex:param value="{!grandTotalColumnZ}"/></apex:outputText></th>
</tr>
<!-- Spacer -->
<tr><td class="ffrgridspacerd" colspan="11"></td></tr>
<!-- Display Gross Margin % -->
<tr>
<td class="ffrcalcsumlabeld" colspan="11">{!label['L17']}</td>
<td class="ffrgridspacerd"/>
<th class="{!if(RenderColumnA,'ffrcalcsumd','ffrsubtotalhidden')}"><apex:outputText value="{!if(grossMarginPercA==0,PZ,PN)}" rendered="{!RenderColumnA}"><apex:param value="{!grossMarginPercA}"/></apex:outputText></th>
<th class="{!if(RenderColumnB,'ffrcalcsumd','ffrsubtotalhidden')}"><apex:outputText value="{!if(grossMarginPercB==0,PZ,PN)}" rendered="{!RenderColumnB}"><apex:param value="{!grossMarginPercB}"/></apex:outputText></th>
<!--<th class="{!if(RenderColumnA && RenderColumnB,'ffrcalcsumd','ffrsubtotalhidden')}"><apex:outputText value="{!if((grossMarginPercA-grossMarginPercB)==0,PZ,PN)}" rendered="{!RenderColumnA && RenderColumnB}"><apex:param value="{!(grossMarginPercA-grossMarginPercB)}"/></apex:outputText></th>
<th class="{!if(RenderColumnA && RenderColumnB,'ffrcalcsumd','ffrsubtotalhidden')}"><apex:outputText value="{!if((grossMarginPercA-grossMarginPercB)==0,PZ,PN)}" rendered="{!RenderColumnA && RenderColumnB}"><apex:param value="{!(grossMarginPercA-grossMarginPercB)}"/></apex:outputText></th>-->
<th class="{!if(RenderColumnC,'ffrcalcsumd','ffrsubtotalhidden')}"><apex:outputText value="{!if(grossMarginPercC==0,PZ,PN)}" rendered="{!RenderColumnC}"><apex:param value="{!grossMarginPercC}"/></apex:outputText></th>
<th class="{!if(RenderColumnD,'ffrcalcsumd','ffrsubtotalhidden')}"><apex:outputText value="{!if(grossMarginPercD==0,PZ,PN)}" rendered="{!RenderColumnD}"><apex:param value="{!grossMarginPercD}"/></apex:outputText></th>
<!--<th class="{!if(RenderColumnC && RenderColumnD,'ffrcalcsumd','ffrsubtotalhidden')}"><apex:outputText value="{!if((grossMarginPercC-grossMarginPercD)==0,PZ,PN)}" rendered="{!RenderColumnC && RenderColumnD}"><apex:param value="{!(grossMarginPercC-grossMarginPercD)}"/></apex:outputText></th>
<th class="{!if(RenderColumnC && RenderColumnD,'ffrcalcsumd','ffrsubtotalhidden')}"><apex:outputText value="{!if((grossMarginPercC-grossMarginPercD)==0,PZ,PN)}" rendered="{!RenderColumnC && RenderColumnD}"><apex:param value="{!(grossMarginPercC-grossMarginPercD)}"/></apex:outputText></th>-->
<th class="{!if(RenderColumnE,'ffrcalcsumd','ffrsubtotalhidden')}"><apex:outputText value="{!if(if(salesRevenueTotalColumnE=0,0,grandTotalColumnE/salesRevenueTotalColumnE)==0,PZ,PN)}" rendered="{!RenderColumnE}"><apex:param value="{!if(salesRevenueTotalColumnE=0,0,grandTotalColumnE/salesRevenueTotalColumnE)}"/></apex:outputText></th>
<th class="{!if(RenderColumnF,'ffrcalcsumd','ffrsubtotalhidden')}"><apex:outputText value="{!if(if(salesRevenueTotalColumnF=0,0,grandTotalColumnF/salesRevenueTotalColumnF)==0,PZ,PN)}" rendered="{!RenderColumnF}"><apex:param value="{!if(salesRevenueTotalColumnF=0,0,grandTotalColumnF/salesRevenueTotalColumnF)}"/></apex:outputText></th>
<th class="{!if(RenderColumnG,'ffrcalcsumd','ffrsubtotalhidden')}"><apex:outputText value="{!if(if(salesRevenueTotalColumnG=0,0,grandTotalColumnG/salesRevenueTotalColumnG)==0,PZ,PN)}" rendered="{!RenderColumnG}"><apex:param value="{!if(salesRevenueTotalColumnG=0,0,grandTotalColumnG/salesRevenueTotalColumnG)}"/></apex:outputText></th>
<th class="{!if(RenderColumnH,'ffrcalcsumd','ffrsubtotalhidden')}"><apex:outputText value="{!if(if(salesRevenueTotalColumnH=0,0,grandTotalColumnH/salesRevenueTotalColumnH)==0,PZ,PN)}" rendered="{!RenderColumnH}"><apex:param value="{!if(salesRevenueTotalColumnH=0,0,grandTotalColumnH/salesRevenueTotalColumnH)}"/></apex:outputText></th>
<th class="{!if(RenderColumnI,'ffrcalcsumd','ffrsubtotalhidden')}"><apex:outputText value="{!if(if(salesRevenueTotalColumnI=0,0,grandTotalColumnI/salesRevenueTotalColumnI)==0,PZ,PN)}" rendered="{!RenderColumnI}"><apex:param value="{!if(salesRevenueTotalColumnI=0,0,grandTotalColumnI/salesRevenueTotalColumnI)}"/></apex:outputText></th>
<th class="{!if(RenderColumnJ,'ffrcalcsumd','ffrsubtotalhidden')}"><apex:outputText value="{!if(if(salesRevenueTotalColumnJ=0,0,grandTotalColumnJ/salesRevenueTotalColumnJ)==0,PZ,PN)}" rendered="{!RenderColumnJ}"><apex:param value="{!if(salesRevenueTotalColumnJ=0,0,grandTotalColumnJ/salesRevenueTotalColumnJ)}"/></apex:outputText></th>
<th class="{!if(RenderColumnK,'ffrcalcsumd','ffrsubtotalhidden')}"><apex:outputText value="{!if(if(salesRevenueTotalColumnK=0,0,grandTotalColumnK/salesRevenueTotalColumnK)==0,PZ,PN)}" rendered="{!RenderColumnK}"><apex:param value="{!if(salesRevenueTotalColumnK=0,0,grandTotalColumnK/salesRevenueTotalColumnK)}"/></apex:outputText></th>
<th class="{!if(RenderColumnL,'ffrcalcsumd','ffrsubtotalhidden')}"><apex:outputText value="{!if(if(salesRevenueTotalColumnL=0,0,grandTotalColumnL/salesRevenueTotalColumnL)==0,PZ,PN)}" rendered="{!RenderColumnL}"><apex:param value="{!if(salesRevenueTotalColumnL=0,0,grandTotalColumnL/salesRevenueTotalColumnL)}"/></apex:outputText></th>
<th class="{!if(RenderColumnM,'ffrcalcsumd','ffrsubtotalhidden')}"><apex:outputText value="{!if(if(salesRevenueTotalColumnM=0,0,grandTotalColumnM/salesRevenueTotalColumnM)==0,PZ,PN)}" rendered="{!RenderColumnM}"><apex:param value="{!if(salesRevenueTotalColumnM=0,0,grandTotalColumnM/salesRevenueTotalColumnM)}"/></apex:outputText></th>
<th class="{!if(RenderColumnN,'ffrcalcsumd','ffrsubtotalhidden')}"><apex:outputText value="{!if(if(salesRevenueTotalColumnN=0,0,grandTotalColumnN/salesRevenueTotalColumnN)==0,PZ,PN)}" rendered="{!RenderColumnN}"><apex:param value="{!if(salesRevenueTotalColumnN=0,0,grandTotalColumnN/salesRevenueTotalColumnN)}"/></apex:outputText></th>
<th class="{!if(RenderColumnO,'ffrcalcsumd','ffrsubtotalhidden')}"><apex:outputText value="{!if(if(salesRevenueTotalColumnO=0,0,grandTotalColumnO/salesRevenueTotalColumnO)==0,PZ,PN)}" rendered="{!RenderColumnO}"><apex:param value="{!if(salesRevenueTotalColumnO=0,0,grandTotalColumnO/salesRevenueTotalColumnO)}"/></apex:outputText></th>
<th class="{!if(RenderColumnP,'ffrcalcsumd','ffrsubtotalhidden')}"><apex:outputText value="{!if(if(salesRevenueTotalColumnP=0,0,grandTotalColumnP/salesRevenueTotalColumnP)==0,PZ,PN)}" rendered="{!RenderColumnP}"><apex:param value="{!if(salesRevenueTotalColumnP=0,0,grandTotalColumnP/salesRevenueTotalColumnP)}"/></apex:outputText></th>
<th class="{!if(RenderColumnQ,'ffrcalcsumd','ffrsubtotalhidden')}"><apex:outputText value="{!if(if(salesRevenueTotalColumnQ=0,0,grandTotalColumnQ/salesRevenueTotalColumnQ)==0,PZ,PN)}" rendered="{!RenderColumnQ}"><apex:param value="{!if(salesRevenueTotalColumnQ=0,0,grandTotalColumnQ/salesRevenueTotalColumnQ)}"/></apex:outputText></th>
<th class="{!if(RenderColumnR,'ffrcalcsumd','ffrsubtotalhidden')}"><apex:outputText value="{!if(if(salesRevenueTotalColumnR=0,0,grandTotalColumnR/salesRevenueTotalColumnR)==0,PZ,PN)}" rendered="{!RenderColumnR}"><apex:param value="{!if(salesRevenueTotalColumnR=0,0,grandTotalColumnR/salesRevenueTotalColumnR)}"/></apex:outputText></th>
<th class="{!if(RenderColumnS,'ffrcalcsumd','ffrsubtotalhidden')}"><apex:outputText value="{!if(if(salesRevenueTotalColumnS=0,0,grandTotalColumnS/salesRevenueTotalColumnS)==0,PZ,PN)}" rendered="{!RenderColumnS}"><apex:param value="{!if(salesRevenueTotalColumnS=0,0,grandTotalColumnS/salesRevenueTotalColumnS)}"/></apex:outputText></th>
<th class="{!if(RenderColumnT,'ffrcalcsumd','ffrsubtotalhidden')}"><apex:outputText value="{!if(if(salesRevenueTotalColumnT=0,0,grandTotalColumnT/salesRevenueTotalColumnT)==0,PZ,PN)}" rendered="{!RenderColumnT}"><apex:param value="{!if(salesRevenueTotalColumnT=0,0,grandTotalColumnT/salesRevenueTotalColumnT)}"/></apex:outputText></th>
<th class="{!if(RenderColumnU,'ffrcalcsumd','ffrsubtotalhidden')}"><apex:outputText value="{!if(if(salesRevenueTotalColumnU=0,0,grandTotalColumnU/salesRevenueTotalColumnU)==0,PZ,PN)}" rendered="{!RenderColumnU}"><apex:param value="{!if(salesRevenueTotalColumnU=0,0,grandTotalColumnU/salesRevenueTotalColumnU)}"/></apex:outputText></th>
<th class="{!if(RenderColumnV,'ffrcalcsumd','ffrsubtotalhidden')}"><apex:outputText value="{!if(if(salesRevenueTotalColumnV=0,0,grandTotalColumnV/salesRevenueTotalColumnV)==0,PZ,PN)}" rendered="{!RenderColumnV}"><apex:param value="{!if(salesRevenueTotalColumnV=0,0,grandTotalColumnV/salesRevenueTotalColumnV)}"/></apex:outputText></th>
<th class="{!if(RenderColumnW,'ffrcalcsumd','ffrsubtotalhidden')}"><apex:outputText value="{!if(if(salesRevenueTotalColumnW=0,0,grandTotalColumnW/salesRevenueTotalColumnW)==0,PZ,PN)}" rendered="{!RenderColumnW}"><apex:param value="{!if(salesRevenueTotalColumnW=0,0,grandTotalColumnW/salesRevenueTotalColumnW)}"/></apex:outputText></th>
<th class="{!if(RenderColumnX,'ffrcalcsumd','ffrsubtotalhidden')}"><apex:outputText value="{!if(if(salesRevenueTotalColumnX=0,0,grandTotalColumnX/salesRevenueTotalColumnX)==0,PZ,PN)}" rendered="{!RenderColumnX}"><apex:param value="{!if(salesRevenueTotalColumnX=0,0,grandTotalColumnX/salesRevenueTotalColumnX)}"/></apex:outputText></th>
<th class="{!if(RenderColumnY,'ffrcalcsumd','ffrsubtotalhidden')}"><apex:outputText value="{!if(if(salesRevenueTotalColumnY=0,0,grandTotalColumnY/salesRevenueTotalColumnY)==0,PZ,PN)}" rendered="{!RenderColumnY}"><apex:param value="{!if(salesRevenueTotalColumnY=0,0,grandTotalColumnY/salesRevenueTotalColumnY)}"/></apex:outputText></th>
<th class="{!if(RenderColumnZ,'ffrcalcsumd','ffrsubtotalhidden')}"><apex:outputText value="{!if(if(salesRevenueTotalColumnZ=0,0,grandTotalColumnZ/salesRevenueTotalColumnZ)==0,PZ,PN)}" rendered="{!RenderColumnZ}"><apex:param value="{!if(salesRevenueTotalColumnZ=0,0,grandTotalColumnZ/salesRevenueTotalColumnZ)}"/></apex:outputText></th>
</tr>
<!-- Spacer -->
<tr><td class="ffrgridspacerd" colspan="11"></td></tr>
<!-- Set the flag to indicate that we have displayed Gross Margin calculations -->
<apex:variable value="{!true}" var="OperatingEBITDACalculationsDisplayed"/>
</apex:outputPanel>


<!--EBITDA calculation -->
<apex:outputPanel layout="none" rendered="{!!EBITDACalculationsDisplayed && rowKeyNum>49}">
<!-- Set calculated values as variables (for ease of use) -->
<apex:variable value="{!(grandTotalColumnA-grandTotalColumnB)}" var="grandTotalVarianceAB"/>
<apex:variable value="{!(grandTotalColumnC-grandTotalColumnD)}" var="grandTotalVarianceCD"/>
<apex:variable value="{!if(grandTotalColumnB=0,(if(grandTotalColumnA=0,0,(grandTotalVarianceAB/grandTotalColumnA))),(grandTotalVarianceAB/grandTotalColumnB))}" var="grandTotalVariancePercAB"/>
<apex:variable value="{!if(grandTotalColumnD=0,(if(grandTotalColumnC=0,0,(grandTotalVarianceCD/grandTotalColumnC))),(grandTotalVarianceCD/grandTotalColumnD))}" var="grandTotalVariancePercCD"/>
<apex:variable value="{!if(salesRevenueTotalColumnA=0,0,grandTotalColumnA/salesRevenueTotalColumnA)}" var="grossMarginPercA"/>
<apex:variable value="{!if(salesRevenueTotalColumnB=0,0,grandTotalColumnB/salesRevenueTotalColumnB)}" var="grossMarginPercB"/>
<apex:variable value="{!if(salesRevenueTotalColumnC=0,0,grandTotalColumnC/salesRevenueTotalColumnC)}" var="grossMarginPercC"/>
<apex:variable value="{!if(salesRevenueTotalColumnD=0,0,grandTotalColumnD/salesRevenueTotalColumnD)}" var="grossMarginPercD"/>
<!-- Display Gross Margin -->
<!-- The number of groups to span is 11, as groups 1 to 5 are hidden and only displayed as a Subtotal Row -->
<tr>
    <td class="ffrcalcsumlabeld" colspan="11">{!label['L15']}</td>
    <td class="ffrgridspacerd"/>
    <th class="{!if(RenderColumnA,'ffrcalcsumd','ffrsubtotalhidden')}">{!label['L06']}<apex:outputText value="{!if(grandTotalColumnA==0,VZ,VR)}" rendered="{!RenderColumnA}"><apex:param value="{!grandTotalColumnA}"/></apex:outputText></th>
    <th class="{!if(RenderColumnB,'ffrcalcsumd','ffrsubtotalhidden')}">{!label['L06']}<apex:outputText value="{!if(grandTotalColumnB==0,VZ,VR)}" rendered="{!RenderColumnB}"><apex:param value="{!grandTotalColumnB}"/></apex:outputText></th>
   <!-- <th class="{!if(RenderColumnA && RenderColumnB,'ffrcalcsumd','ffrsubtotalhidden')}">{!label['L06']}<apex:outputText value="{!if(grandTotalVarianceAB==0,VZ,VR)}" rendered="{!RenderColumnA && RenderColumnB}"><apex:param value="{!grandTotalVarianceAB}"/></apex:outputText></th>
    <th class="{!if(RenderColumnA && RenderColumnB,'ffrcalcsumd','ffrsubtotalhidden')}"><apex:outputText value="{!if(grandTotalVariancePercAB==0,PZ,PN)}" rendered="{!RenderColumnA && RenderColumnB}"><apex:param value="{!grandTotalVariancePercAB}"/></apex:outputText></th>-->
    <th class="{!if(RenderColumnC,'ffrcalcsumd','ffrsubtotalhidden')}">{!label['L06']}<apex:outputText value="{!if(grandTotalColumnC==0,VZ,VR)}" rendered="{!RenderColumnC}"><apex:param value="{!grandTotalColumnC}"/></apex:outputText></th>
    <th class="{!if(RenderColumnD,'ffrcalcsumd','ffrsubtotalhidden')}">{!label['L06']}<apex:outputText value="{!if(grandTotalColumnD==0,VZ,VR)}" rendered="{!RenderColumnD}"><apex:param value="{!grandTotalColumnD}"/></apex:outputText></th>
    <!--<th class="{!if(RenderColumnC && RenderColumnD,'ffrcalcsumd','ffrsubtotalhidden')}">{!label['L06']}<apex:outputText value="{!if(grandTotalVarianceCD==0,VZ,VR)}" rendered="{!RenderColumnC && RenderColumnD}"><apex:param value="{!grandTotalVarianceCD}"/></apex:outputText></th>
    <th class="{!if(RenderColumnC && RenderColumnD,'ffrcalcsumd','ffrsubtotalhidden')}"><apex:outputText value="{!if(grandTotalVariancePercCD==0,PZ,PN)}" rendered="{!RenderColumnC && RenderColumnD}"><apex:param value="{!grandTotalVariancePercCD}"/></apex:outputText></th> -->
    <th class="{!if(RenderColumnE,'ffrcalcsumd','ffrsubtotalhidden')}">{!label['L06']}<apex:outputText value="{!if(grandTotalColumnE==0,VZ,VR)}" rendered="{!RenderColumnE}"><apex:param value="{!grandTotalColumnE}"/></apex:outputText></th>
    <th class="{!if(RenderColumnF,'ffrcalcsumd','ffrsubtotalhidden')}">{!label['L06']}<apex:outputText value="{!if(grandTotalColumnF==0,VZ,VR)}" rendered="{!RenderColumnF}"><apex:param value="{!grandTotalColumnF}"/></apex:outputText></th>
    <th class="{!if(RenderColumnG,'ffrcalcsumd','ffrsubtotalhidden')}">{!label['L06']}<apex:outputText value="{!if(grandTotalColumnG==0,VZ,VR)}" rendered="{!RenderColumnG}"><apex:param value="{!grandTotalColumnG}"/></apex:outputText></th>
    <th class="{!if(RenderColumnH,'ffrcalcsumd','ffrsubtotalhidden')}">{!label['L06']}<apex:outputText value="{!if(grandTotalColumnH==0,VZ,VR)}" rendered="{!RenderColumnH}"><apex:param value="{!grandTotalColumnH}"/></apex:outputText></th>
    <th class="{!if(RenderColumnI,'ffrcalcsumd','ffrsubtotalhidden')}">{!label['L06']}<apex:outputText value="{!if(grandTotalColumnI==0,VZ,VR)}" rendered="{!RenderColumnI}"><apex:param value="{!grandTotalColumnI}"/></apex:outputText></th>
    <th class="{!if(RenderColumnJ,'ffrcalcsumd','ffrsubtotalhidden')}">{!label['L06']}<apex:outputText value="{!if(grandTotalColumnJ==0,VZ,VR)}" rendered="{!RenderColumnJ}"><apex:param value="{!grandTotalColumnJ}"/></apex:outputText></th>
    <th class="{!if(RenderColumnK,'ffrcalcsumd','ffrsubtotalhidden')}">{!label['L06']}<apex:outputText value="{!if(grandTotalColumnK==0,VZ,VR)}" rendered="{!RenderColumnK}"><apex:param value="{!grandTotalColumnK}"/></apex:outputText></th>
    <th class="{!if(RenderColumnL,'ffrcalcsumd','ffrsubtotalhidden')}">{!label['L06']}<apex:outputText value="{!if(grandTotalColumnL==0,VZ,VR)}" rendered="{!RenderColumnL}"><apex:param value="{!grandTotalColumnL}"/></apex:outputText></th>
    <th class="{!if(RenderColumnM,'ffrcalcsumd','ffrsubtotalhidden')}">{!label['L06']}<apex:outputText value="{!if(grandTotalColumnM==0,VZ,VR)}" rendered="{!RenderColumnM}"><apex:param value="{!grandTotalColumnM}"/></apex:outputText></th>
    <th class="{!if(RenderColumnN,'ffrcalcsumd','ffrsubtotalhidden')}">{!label['L06']}<apex:outputText value="{!if(grandTotalColumnN==0,VZ,VR)}" rendered="{!RenderColumnN}"><apex:param value="{!grandTotalColumnN}"/></apex:outputText></th>
    <th class="{!if(RenderColumnO,'ffrcalcsumd','ffrsubtotalhidden')}">{!label['L06']}<apex:outputText value="{!if(grandTotalColumnO==0,VZ,VR)}" rendered="{!RenderColumnO}"><apex:param value="{!grandTotalColumnO}"/></apex:outputText></th>
    <th class="{!if(RenderColumnP,'ffrcalcsumd','ffrsubtotalhidden')}">{!label['L06']}<apex:outputText value="{!if(grandTotalColumnP==0,VZ,VR)}" rendered="{!RenderColumnP}"><apex:param value="{!grandTotalColumnP}"/></apex:outputText></th>
    <th class="{!if(RenderColumnQ,'ffrcalcsumd','ffrsubtotalhidden')}">{!label['L06']}<apex:outputText value="{!if(grandTotalColumnQ==0,VZ,VR)}" rendered="{!RenderColumnQ}"><apex:param value="{!grandTotalColumnQ}"/></apex:outputText></th>
    <th class="{!if(RenderColumnR,'ffrcalcsumd','ffrsubtotalhidden')}">{!label['L06']}<apex:outputText value="{!if(grandTotalColumnR==0,VZ,VR)}" rendered="{!RenderColumnR}"><apex:param value="{!grandTotalColumnR}"/></apex:outputText></th>
    <th class="{!if(RenderColumnS,'ffrcalcsumd','ffrsubtotalhidden')}">{!label['L06']}<apex:outputText value="{!if(grandTotalColumnS==0,VZ,VR)}" rendered="{!RenderColumnS}"><apex:param value="{!grandTotalColumnS}"/></apex:outputText></th>
    <th class="{!if(RenderColumnT,'ffrcalcsumd','ffrsubtotalhidden')}">{!label['L06']}<apex:outputText value="{!if(grandTotalColumnT==0,VZ,VR)}" rendered="{!RenderColumnT}"><apex:param value="{!grandTotalColumnT}"/></apex:outputText></th>
    <th class="{!if(RenderColumnU,'ffrcalcsumd','ffrsubtotalhidden')}">{!label['L06']}<apex:outputText value="{!if(grandTotalColumnU==0,VZ,VR)}" rendered="{!RenderColumnU}"><apex:param value="{!grandTotalColumnU}"/></apex:outputText></th>
    <th class="{!if(RenderColumnV,'ffrcalcsumd','ffrsubtotalhidden')}">{!label['L06']}<apex:outputText value="{!if(grandTotalColumnV==0,VZ,VR)}" rendered="{!RenderColumnV}"><apex:param value="{!grandTotalColumnV}"/></apex:outputText></th>
    <th class="{!if(RenderColumnW,'ffrcalcsumd','ffrsubtotalhidden')}">{!label['L06']}<apex:outputText value="{!if(grandTotalColumnW==0,VZ,VR)}" rendered="{!RenderColumnW}"><apex:param value="{!grandTotalColumnW}"/></apex:outputText></th>
    <th class="{!if(RenderColumnX,'ffrcalcsumd','ffrsubtotalhidden')}">{!label['L06']}<apex:outputText value="{!if(grandTotalColumnX==0,VZ,VR)}" rendered="{!RenderColumnX}"><apex:param value="{!grandTotalColumnX}"/></apex:outputText></th>
    <th class="{!if(RenderColumnY,'ffrcalcsumd','ffrsubtotalhidden')}">{!label['L06']}<apex:outputText value="{!if(grandTotalColumnY==0,VZ,VR)}" rendered="{!RenderColumnY}"><apex:param value="{!grandTotalColumnY}"/></apex:outputText></th>
    <th class="{!if(RenderColumnZ,'ffrcalcsumd','ffrsubtotalhidden')}">{!label['L06']}<apex:outputText value="{!if(grandTotalColumnZ==0,VZ,VR)}" rendered="{!RenderColumnZ}"><apex:param value="{!grandTotalColumnZ}"/></apex:outputText></th>
</tr>
<!-- Spacer -->
<tr><td class="ffrgridspacerd" colspan="11"></td></tr>
<!-- Display Gross Margin % -->
<tr>
<td class="ffrcalcsumlabeld" colspan="11">{!label['L18']}</td>
<td class="ffrgridspacerd"/>
<th class="{!if(RenderColumnA,'ffrcalcsumd','ffrsubtotalhidden')}"><apex:outputText value="{!if(grossMarginPercA==0,PZ,PN)}" rendered="{!RenderColumnA}"><apex:param value="{!grossMarginPercA}"/></apex:outputText></th>
<th class="{!if(RenderColumnB,'ffrcalcsumd','ffrsubtotalhidden')}"><apex:outputText value="{!if(grossMarginPercB==0,PZ,PN)}" rendered="{!RenderColumnB}"><apex:param value="{!grossMarginPercB}"/></apex:outputText></th>
<!--<th class="{!if(RenderColumnA && RenderColumnB,'ffrcalcsumd','ffrsubtotalhidden')}"><apex:outputText value="{!if((grossMarginPercA-grossMarginPercB)==0,PZ,PN)}" rendered="{!RenderColumnA && RenderColumnB}"><apex:param value="{!(grossMarginPercA-grossMarginPercB)}"/></apex:outputText></th>
<th class="{!if(RenderColumnA && RenderColumnB,'ffrcalcsumd','ffrsubtotalhidden')}"><apex:outputText value="{!if((grossMarginPercA-grossMarginPercB)==0,PZ,PN)}" rendered="{!RenderColumnA && RenderColumnB}"><apex:param value="{!(grossMarginPercA-grossMarginPercB)}"/></apex:outputText></th>-->
<th class="{!if(RenderColumnC,'ffrcalcsumd','ffrsubtotalhidden')}"><apex:outputText value="{!if(grossMarginPercC==0,PZ,PN)}" rendered="{!RenderColumnC}"><apex:param value="{!grossMarginPercC}"/></apex:outputText></th>
<th class="{!if(RenderColumnD,'ffrcalcsumd','ffrsubtotalhidden')}"><apex:outputText value="{!if(grossMarginPercD==0,PZ,PN)}" rendered="{!RenderColumnD}"><apex:param value="{!grossMarginPercD}"/></apex:outputText></th>
<!--<th class="{!if(RenderColumnC && RenderColumnD,'ffrcalcsumd','ffrsubtotalhidden')}"><apex:outputText value="{!if((grossMarginPercC-grossMarginPercD)==0,PZ,PN)}" rendered="{!RenderColumnC && RenderColumnD}"><apex:param value="{!(grossMarginPercC-grossMarginPercD)}"/></apex:outputText></th>
<th class="{!if(RenderColumnC && RenderColumnD,'ffrcalcsumd','ffrsubtotalhidden')}"><apex:outputText value="{!if((grossMarginPercC-grossMarginPercD)==0,PZ,PN)}" rendered="{!RenderColumnC && RenderColumnD}"><apex:param value="{!(grossMarginPercC-grossMarginPercD)}"/></apex:outputText></th>-->
<th class="{!if(RenderColumnE,'ffrcalcsumd','ffrsubtotalhidden')}"><apex:outputText value="{!if(if(salesRevenueTotalColumnE=0,0,grandTotalColumnE/salesRevenueTotalColumnE)==0,PZ,PN)}" rendered="{!RenderColumnE}"><apex:param value="{!if(salesRevenueTotalColumnE=0,0,grandTotalColumnE/salesRevenueTotalColumnE)}"/></apex:outputText></th>
<th class="{!if(RenderColumnF,'ffrcalcsumd','ffrsubtotalhidden')}"><apex:outputText value="{!if(if(salesRevenueTotalColumnF=0,0,grandTotalColumnF/salesRevenueTotalColumnF)==0,PZ,PN)}" rendered="{!RenderColumnF}"><apex:param value="{!if(salesRevenueTotalColumnF=0,0,grandTotalColumnF/salesRevenueTotalColumnF)}"/></apex:outputText></th>
<th class="{!if(RenderColumnG,'ffrcalcsumd','ffrsubtotalhidden')}"><apex:outputText value="{!if(if(salesRevenueTotalColumnG=0,0,grandTotalColumnG/salesRevenueTotalColumnG)==0,PZ,PN)}" rendered="{!RenderColumnG}"><apex:param value="{!if(salesRevenueTotalColumnG=0,0,grandTotalColumnG/salesRevenueTotalColumnG)}"/></apex:outputText></th>
<th class="{!if(RenderColumnH,'ffrcalcsumd','ffrsubtotalhidden')}"><apex:outputText value="{!if(if(salesRevenueTotalColumnH=0,0,grandTotalColumnH/salesRevenueTotalColumnH)==0,PZ,PN)}" rendered="{!RenderColumnH}"><apex:param value="{!if(salesRevenueTotalColumnH=0,0,grandTotalColumnH/salesRevenueTotalColumnH)}"/></apex:outputText></th>
<th class="{!if(RenderColumnI,'ffrcalcsumd','ffrsubtotalhidden')}"><apex:outputText value="{!if(if(salesRevenueTotalColumnI=0,0,grandTotalColumnI/salesRevenueTotalColumnI)==0,PZ,PN)}" rendered="{!RenderColumnI}"><apex:param value="{!if(salesRevenueTotalColumnI=0,0,grandTotalColumnI/salesRevenueTotalColumnI)}"/></apex:outputText></th>
<th class="{!if(RenderColumnJ,'ffrcalcsumd','ffrsubtotalhidden')}"><apex:outputText value="{!if(if(salesRevenueTotalColumnJ=0,0,grandTotalColumnJ/salesRevenueTotalColumnJ)==0,PZ,PN)}" rendered="{!RenderColumnJ}"><apex:param value="{!if(salesRevenueTotalColumnJ=0,0,grandTotalColumnJ/salesRevenueTotalColumnJ)}"/></apex:outputText></th>
<th class="{!if(RenderColumnK,'ffrcalcsumd','ffrsubtotalhidden')}"><apex:outputText value="{!if(if(salesRevenueTotalColumnK=0,0,grandTotalColumnK/salesRevenueTotalColumnK)==0,PZ,PN)}" rendered="{!RenderColumnK}"><apex:param value="{!if(salesRevenueTotalColumnK=0,0,grandTotalColumnK/salesRevenueTotalColumnK)}"/></apex:outputText></th>
<th class="{!if(RenderColumnL,'ffrcalcsumd','ffrsubtotalhidden')}"><apex:outputText value="{!if(if(salesRevenueTotalColumnL=0,0,grandTotalColumnL/salesRevenueTotalColumnL)==0,PZ,PN)}" rendered="{!RenderColumnL}"><apex:param value="{!if(salesRevenueTotalColumnL=0,0,grandTotalColumnL/salesRevenueTotalColumnL)}"/></apex:outputText></th>
<th class="{!if(RenderColumnM,'ffrcalcsumd','ffrsubtotalhidden')}"><apex:outputText value="{!if(if(salesRevenueTotalColumnM=0,0,grandTotalColumnM/salesRevenueTotalColumnM)==0,PZ,PN)}" rendered="{!RenderColumnM}"><apex:param value="{!if(salesRevenueTotalColumnM=0,0,grandTotalColumnM/salesRevenueTotalColumnM)}"/></apex:outputText></th>
<th class="{!if(RenderColumnN,'ffrcalcsumd','ffrsubtotalhidden')}"><apex:outputText value="{!if(if(salesRevenueTotalColumnN=0,0,grandTotalColumnN/salesRevenueTotalColumnN)==0,PZ,PN)}" rendered="{!RenderColumnN}"><apex:param value="{!if(salesRevenueTotalColumnN=0,0,grandTotalColumnN/salesRevenueTotalColumnN)}"/></apex:outputText></th>
<th class="{!if(RenderColumnO,'ffrcalcsumd','ffrsubtotalhidden')}"><apex:outputText value="{!if(if(salesRevenueTotalColumnO=0,0,grandTotalColumnO/salesRevenueTotalColumnO)==0,PZ,PN)}" rendered="{!RenderColumnO}"><apex:param value="{!if(salesRevenueTotalColumnO=0,0,grandTotalColumnO/salesRevenueTotalColumnO)}"/></apex:outputText></th>
<th class="{!if(RenderColumnP,'ffrcalcsumd','ffrsubtotalhidden')}"><apex:outputText value="{!if(if(salesRevenueTotalColumnP=0,0,grandTotalColumnP/salesRevenueTotalColumnP)==0,PZ,PN)}" rendered="{!RenderColumnP}"><apex:param value="{!if(salesRevenueTotalColumnP=0,0,grandTotalColumnP/salesRevenueTotalColumnP)}"/></apex:outputText></th>
<th class="{!if(RenderColumnQ,'ffrcalcsumd','ffrsubtotalhidden')}"><apex:outputText value="{!if(if(salesRevenueTotalColumnQ=0,0,grandTotalColumnQ/salesRevenueTotalColumnQ)==0,PZ,PN)}" rendered="{!RenderColumnQ}"><apex:param value="{!if(salesRevenueTotalColumnQ=0,0,grandTotalColumnQ/salesRevenueTotalColumnQ)}"/></apex:outputText></th>
<th class="{!if(RenderColumnR,'ffrcalcsumd','ffrsubtotalhidden')}"><apex:outputText value="{!if(if(salesRevenueTotalColumnR=0,0,grandTotalColumnR/salesRevenueTotalColumnR)==0,PZ,PN)}" rendered="{!RenderColumnR}"><apex:param value="{!if(salesRevenueTotalColumnR=0,0,grandTotalColumnR/salesRevenueTotalColumnR)}"/></apex:outputText></th>
<th class="{!if(RenderColumnS,'ffrcalcsumd','ffrsubtotalhidden')}"><apex:outputText value="{!if(if(salesRevenueTotalColumnS=0,0,grandTotalColumnS/salesRevenueTotalColumnS)==0,PZ,PN)}" rendered="{!RenderColumnS}"><apex:param value="{!if(salesRevenueTotalColumnS=0,0,grandTotalColumnS/salesRevenueTotalColumnS)}"/></apex:outputText></th>
<th class="{!if(RenderColumnT,'ffrcalcsumd','ffrsubtotalhidden')}"><apex:outputText value="{!if(if(salesRevenueTotalColumnT=0,0,grandTotalColumnT/salesRevenueTotalColumnT)==0,PZ,PN)}" rendered="{!RenderColumnT}"><apex:param value="{!if(salesRevenueTotalColumnT=0,0,grandTotalColumnT/salesRevenueTotalColumnT)}"/></apex:outputText></th>
<th class="{!if(RenderColumnU,'ffrcalcsumd','ffrsubtotalhidden')}"><apex:outputText value="{!if(if(salesRevenueTotalColumnU=0,0,grandTotalColumnU/salesRevenueTotalColumnU)==0,PZ,PN)}" rendered="{!RenderColumnU}"><apex:param value="{!if(salesRevenueTotalColumnU=0,0,grandTotalColumnU/salesRevenueTotalColumnU)}"/></apex:outputText></th>
<th class="{!if(RenderColumnV,'ffrcalcsumd','ffrsubtotalhidden')}"><apex:outputText value="{!if(if(salesRevenueTotalColumnV=0,0,grandTotalColumnV/salesRevenueTotalColumnV)==0,PZ,PN)}" rendered="{!RenderColumnV}"><apex:param value="{!if(salesRevenueTotalColumnV=0,0,grandTotalColumnV/salesRevenueTotalColumnV)}"/></apex:outputText></th>
<th class="{!if(RenderColumnW,'ffrcalcsumd','ffrsubtotalhidden')}"><apex:outputText value="{!if(if(salesRevenueTotalColumnW=0,0,grandTotalColumnW/salesRevenueTotalColumnW)==0,PZ,PN)}" rendered="{!RenderColumnW}"><apex:param value="{!if(salesRevenueTotalColumnW=0,0,grandTotalColumnW/salesRevenueTotalColumnW)}"/></apex:outputText></th>
<th class="{!if(RenderColumnX,'ffrcalcsumd','ffrsubtotalhidden')}"><apex:outputText value="{!if(if(salesRevenueTotalColumnX=0,0,grandTotalColumnX/salesRevenueTotalColumnX)==0,PZ,PN)}" rendered="{!RenderColumnX}"><apex:param value="{!if(salesRevenueTotalColumnX=0,0,grandTotalColumnX/salesRevenueTotalColumnX)}"/></apex:outputText></th>
<th class="{!if(RenderColumnY,'ffrcalcsumd','ffrsubtotalhidden')}"><apex:outputText value="{!if(if(salesRevenueTotalColumnY=0,0,grandTotalColumnY/salesRevenueTotalColumnY)==0,PZ,PN)}" rendered="{!RenderColumnY}"><apex:param value="{!if(salesRevenueTotalColumnY=0,0,grandTotalColumnY/salesRevenueTotalColumnY)}"/></apex:outputText></th>
<th class="{!if(RenderColumnZ,'ffrcalcsumd','ffrsubtotalhidden')}"><apex:outputText value="{!if(if(salesRevenueTotalColumnZ=0,0,grandTotalColumnZ/salesRevenueTotalColumnZ)==0,PZ,PN)}" rendered="{!RenderColumnZ}"><apex:param value="{!if(salesRevenueTotalColumnZ=0,0,grandTotalColumnZ/salesRevenueTotalColumnZ)}"/></apex:outputText></th>
</tr>
<!-- Spacer -->
<tr><td class="ffrgridspacerd" colspan="11"></td></tr>
<!-- Set the flag to indicate that we have displayed Gross Margin calculations -->
<apex:variable value="{!true}" var="EBITDACalculationsDisplayed"/>
</apex:outputPanel>

<!--Net Profit before Tax calculation -->
<apex:outputPanel layout="none" rendered="{!!NetProfitBeforeTaxCalculationsDisplayed && rowKeyNum>59}">
<!-- Set calculated values as variables (for ease of use) -->
<apex:variable value="{!(grandTotalColumnA-grandTotalColumnB)}" var="grandTotalVarianceAB"/>
<apex:variable value="{!(grandTotalColumnC-grandTotalColumnD)}" var="grandTotalVarianceCD"/>
<apex:variable value="{!if(grandTotalColumnB=0,(if(grandTotalColumnA=0,0,(grandTotalVarianceAB/grandTotalColumnA))),(grandTotalVarianceAB/grandTotalColumnB))}" var="grandTotalVariancePercAB"/>
<apex:variable value="{!if(grandTotalColumnD=0,(if(grandTotalColumnC=0,0,(grandTotalVarianceCD/grandTotalColumnC))),(grandTotalVarianceCD/grandTotalColumnD))}" var="grandTotalVariancePercCD"/>
<apex:variable value="{!if(salesRevenueTotalColumnA=0,0,grandTotalColumnA/salesRevenueTotalColumnA)}" var="grossMarginPercA"/>
<apex:variable value="{!if(salesRevenueTotalColumnB=0,0,grandTotalColumnB/salesRevenueTotalColumnB)}" var="grossMarginPercB"/>
<apex:variable value="{!if(salesRevenueTotalColumnC=0,0,grandTotalColumnC/salesRevenueTotalColumnC)}" var="grossMarginPercC"/>
<apex:variable value="{!if(salesRevenueTotalColumnD=0,0,grandTotalColumnD/salesRevenueTotalColumnD)}" var="grossMarginPercD"/>
<!-- Display Gross Margin -->
<!-- The number of groups to span is 11, as groups 1 to 5 are hidden and only displayed as a Subtotal Row -->
<tr>
    <td class="ffrcalcsumlabeld" colspan="11">{!label['L16']}</td>
    <td class="ffrgridspacerd"/>
    <th class="{!if(RenderColumnA,'ffrcalcsumd','ffrsubtotalhidden')}">{!label['L06']}<apex:outputText value="{!if(grandTotalColumnA==0,VZ,VR)}" rendered="{!RenderColumnA}"><apex:param value="{!grandTotalColumnA}"/></apex:outputText></th>
    <th class="{!if(RenderColumnB,'ffrcalcsumd','ffrsubtotalhidden')}">{!label['L06']}<apex:outputText value="{!if(grandTotalColumnB==0,VZ,VR)}" rendered="{!RenderColumnB}"><apex:param value="{!grandTotalColumnB}"/></apex:outputText></th>
    <!--<th class="{!if(RenderColumnA && RenderColumnB,'ffrcalcsumd','ffrsubtotalhidden')}">{!label['L06']}<apex:outputText value="{!if(grandTotalVarianceAB==0,VZ,VR)}" rendered="{!RenderColumnA && RenderColumnB}"><apex:param value="{!grandTotalVarianceAB}"/></apex:outputText></th>
    <th class="{!if(RenderColumnA && RenderColumnB,'ffrcalcsumd','ffrsubtotalhidden')}"><apex:outputText value="{!if(grandTotalVariancePercAB==0,PZ,PN)}" rendered="{!RenderColumnA && RenderColumnB}"><apex:param value="{!grandTotalVariancePercAB}"/></apex:outputText></th> -->
    <th class="{!if(RenderColumnC,'ffrcalcsumd','ffrsubtotalhidden')}">{!label['L06']}<apex:outputText value="{!if(grandTotalColumnC==0,VZ,VR)}" rendered="{!RenderColumnC}"><apex:param value="{!grandTotalColumnC}"/></apex:outputText></th>
    <th class="{!if(RenderColumnD,'ffrcalcsumd','ffrsubtotalhidden')}">{!label['L06']}<apex:outputText value="{!if(grandTotalColumnD==0,VZ,VR)}" rendered="{!RenderColumnD}"><apex:param value="{!grandTotalColumnD}"/></apex:outputText></th>
    <!--<th class="{!if(RenderColumnC && RenderColumnD,'ffrcalcsumd','ffrsubtotalhidden')}">{!label['L06']}<apex:outputText value="{!if(grandTotalVarianceCD==0,VZ,VR)}" rendered="{!RenderColumnC && RenderColumnD}"><apex:param value="{!grandTotalVarianceCD}"/></apex:outputText></th>
    <th class="{!if(RenderColumnC && RenderColumnD,'ffrcalcsumd','ffrsubtotalhidden')}"><apex:outputText value="{!if(grandTotalVariancePercCD==0,PZ,PN)}" rendered="{!RenderColumnC && RenderColumnD}"><apex:param value="{!grandTotalVariancePercCD}"/></apex:outputText></th>-->
    <th class="{!if(RenderColumnE,'ffrcalcsumd','ffrsubtotalhidden')}">{!label['L06']}<apex:outputText value="{!if(grandTotalColumnE==0,VZ,VR)}" rendered="{!RenderColumnE}"><apex:param value="{!grandTotalColumnE}"/></apex:outputText></th>
    <th class="{!if(RenderColumnF,'ffrcalcsumd','ffrsubtotalhidden')}">{!label['L06']}<apex:outputText value="{!if(grandTotalColumnF==0,VZ,VR)}" rendered="{!RenderColumnF}"><apex:param value="{!grandTotalColumnF}"/></apex:outputText></th>
    <th class="{!if(RenderColumnG,'ffrcalcsumd','ffrsubtotalhidden')}">{!label['L06']}<apex:outputText value="{!if(grandTotalColumnG==0,VZ,VR)}" rendered="{!RenderColumnG}"><apex:param value="{!grandTotalColumnG}"/></apex:outputText></th>
    <th class="{!if(RenderColumnH,'ffrcalcsumd','ffrsubtotalhidden')}">{!label['L06']}<apex:outputText value="{!if(grandTotalColumnH==0,VZ,VR)}" rendered="{!RenderColumnH}"><apex:param value="{!grandTotalColumnH}"/></apex:outputText></th>
    <th class="{!if(RenderColumnI,'ffrcalcsumd','ffrsubtotalhidden')}">{!label['L06']}<apex:outputText value="{!if(grandTotalColumnI==0,VZ,VR)}" rendered="{!RenderColumnI}"><apex:param value="{!grandTotalColumnI}"/></apex:outputText></th>
    <th class="{!if(RenderColumnJ,'ffrcalcsumd','ffrsubtotalhidden')}">{!label['L06']}<apex:outputText value="{!if(grandTotalColumnJ==0,VZ,VR)}" rendered="{!RenderColumnJ}"><apex:param value="{!grandTotalColumnJ}"/></apex:outputText></th>
    <th class="{!if(RenderColumnK,'ffrcalcsumd','ffrsubtotalhidden')}">{!label['L06']}<apex:outputText value="{!if(grandTotalColumnK==0,VZ,VR)}" rendered="{!RenderColumnK}"><apex:param value="{!grandTotalColumnK}"/></apex:outputText></th>
    <th class="{!if(RenderColumnL,'ffrcalcsumd','ffrsubtotalhidden')}">{!label['L06']}<apex:outputText value="{!if(grandTotalColumnL==0,VZ,VR)}" rendered="{!RenderColumnL}"><apex:param value="{!grandTotalColumnL}"/></apex:outputText></th>
    <th class="{!if(RenderColumnM,'ffrcalcsumd','ffrsubtotalhidden')}">{!label['L06']}<apex:outputText value="{!if(grandTotalColumnM==0,VZ,VR)}" rendered="{!RenderColumnM}"><apex:param value="{!grandTotalColumnM}"/></apex:outputText></th>
    <th class="{!if(RenderColumnN,'ffrcalcsumd','ffrsubtotalhidden')}">{!label['L06']}<apex:outputText value="{!if(grandTotalColumnN==0,VZ,VR)}" rendered="{!RenderColumnN}"><apex:param value="{!grandTotalColumnN}"/></apex:outputText></th>
    <th class="{!if(RenderColumnO,'ffrcalcsumd','ffrsubtotalhidden')}">{!label['L06']}<apex:outputText value="{!if(grandTotalColumnO==0,VZ,VR)}" rendered="{!RenderColumnO}"><apex:param value="{!grandTotalColumnO}"/></apex:outputText></th>
    <th class="{!if(RenderColumnP,'ffrcalcsumd','ffrsubtotalhidden')}">{!label['L06']}<apex:outputText value="{!if(grandTotalColumnP==0,VZ,VR)}" rendered="{!RenderColumnP}"><apex:param value="{!grandTotalColumnP}"/></apex:outputText></th>
    <th class="{!if(RenderColumnQ,'ffrcalcsumd','ffrsubtotalhidden')}">{!label['L06']}<apex:outputText value="{!if(grandTotalColumnQ==0,VZ,VR)}" rendered="{!RenderColumnQ}"><apex:param value="{!grandTotalColumnQ}"/></apex:outputText></th>
    <th class="{!if(RenderColumnR,'ffrcalcsumd','ffrsubtotalhidden')}">{!label['L06']}<apex:outputText value="{!if(grandTotalColumnR==0,VZ,VR)}" rendered="{!RenderColumnR}"><apex:param value="{!grandTotalColumnR}"/></apex:outputText></th>
    <th class="{!if(RenderColumnS,'ffrcalcsumd','ffrsubtotalhidden')}">{!label['L06']}<apex:outputText value="{!if(grandTotalColumnS==0,VZ,VR)}" rendered="{!RenderColumnS}"><apex:param value="{!grandTotalColumnS}"/></apex:outputText></th>
    <th class="{!if(RenderColumnT,'ffrcalcsumd','ffrsubtotalhidden')}">{!label['L06']}<apex:outputText value="{!if(grandTotalColumnT==0,VZ,VR)}" rendered="{!RenderColumnT}"><apex:param value="{!grandTotalColumnT}"/></apex:outputText></th>
    <th class="{!if(RenderColumnU,'ffrcalcsumd','ffrsubtotalhidden')}">{!label['L06']}<apex:outputText value="{!if(grandTotalColumnU==0,VZ,VR)}" rendered="{!RenderColumnU}"><apex:param value="{!grandTotalColumnU}"/></apex:outputText></th>
    <th class="{!if(RenderColumnV,'ffrcalcsumd','ffrsubtotalhidden')}">{!label['L06']}<apex:outputText value="{!if(grandTotalColumnV==0,VZ,VR)}" rendered="{!RenderColumnV}"><apex:param value="{!grandTotalColumnV}"/></apex:outputText></th>
    <th class="{!if(RenderColumnW,'ffrcalcsumd','ffrsubtotalhidden')}">{!label['L06']}<apex:outputText value="{!if(grandTotalColumnW==0,VZ,VR)}" rendered="{!RenderColumnW}"><apex:param value="{!grandTotalColumnW}"/></apex:outputText></th>
    <th class="{!if(RenderColumnX,'ffrcalcsumd','ffrsubtotalhidden')}">{!label['L06']}<apex:outputText value="{!if(grandTotalColumnX==0,VZ,VR)}" rendered="{!RenderColumnX}"><apex:param value="{!grandTotalColumnX}"/></apex:outputText></th>
    <th class="{!if(RenderColumnY,'ffrcalcsumd','ffrsubtotalhidden')}">{!label['L06']}<apex:outputText value="{!if(grandTotalColumnY==0,VZ,VR)}" rendered="{!RenderColumnY}"><apex:param value="{!grandTotalColumnY}"/></apex:outputText></th>
    <th class="{!if(RenderColumnZ,'ffrcalcsumd','ffrsubtotalhidden')}">{!label['L06']}<apex:outputText value="{!if(grandTotalColumnZ==0,VZ,VR)}" rendered="{!RenderColumnZ}"><apex:param value="{!grandTotalColumnZ}"/></apex:outputText></th>
</tr>
<!-- Spacer -->
<tr><td class="ffrgridspacerd" colspan="11"></td></tr>
<!-- Display Gross Margin % -->
<tr>
<td class="ffrcalcsumlabeld" colspan="11">{!label['L19']}</td>
<td class="ffrgridspacerd"/>
<th class="{!if(RenderColumnA,'ffrcalcsumd','ffrsubtotalhidden')}"><apex:outputText value="{!if(grossMarginPercA==0,PZ,PN)}" rendered="{!RenderColumnA}"><apex:param value="{!grossMarginPercA}"/></apex:outputText></th>
<th class="{!if(RenderColumnB,'ffrcalcsumd','ffrsubtotalhidden')}"><apex:outputText value="{!if(grossMarginPercB==0,PZ,PN)}" rendered="{!RenderColumnB}"><apex:param value="{!grossMarginPercB}"/></apex:outputText></th>
<!--<th class="{!if(RenderColumnA && RenderColumnB,'ffrcalcsumd','ffrsubtotalhidden')}"><apex:outputText value="{!if((grossMarginPercA-grossMarginPercB)==0,PZ,PN)}" rendered="{!RenderColumnA && RenderColumnB}"><apex:param value="{!(grossMarginPercA-grossMarginPercB)}"/></apex:outputText></th>
<th class="{!if(RenderColumnA && RenderColumnB,'ffrcalcsumd','ffrsubtotalhidden')}"><apex:outputText value="{!if((grossMarginPercA-grossMarginPercB)==0,PZ,PN)}" rendered="{!RenderColumnA && RenderColumnB}"><apex:param value="{!(grossMarginPercA-grossMarginPercB)}"/></apex:outputText></th>-->
<th class="{!if(RenderColumnC,'ffrcalcsumd','ffrsubtotalhidden')}"><apex:outputText value="{!if(grossMarginPercC==0,PZ,PN)}" rendered="{!RenderColumnC}"><apex:param value="{!grossMarginPercC}"/></apex:outputText></th>
<th class="{!if(RenderColumnD,'ffrcalcsumd','ffrsubtotalhidden')}"><apex:outputText value="{!if(grossMarginPercD==0,PZ,PN)}" rendered="{!RenderColumnD}"><apex:param value="{!grossMarginPercD}"/></apex:outputText></th>
<!--<th class="{!if(RenderColumnC && RenderColumnD,'ffrcalcsumd','ffrsubtotalhidden')}"><apex:outputText value="{!if((grossMarginPercC-grossMarginPercD)==0,PZ,PN)}" rendered="{!RenderColumnC && RenderColumnD}"><apex:param value="{!(grossMarginPercC-grossMarginPercD)}"/></apex:outputText></th>
<th class="{!if(RenderColumnC && RenderColumnD,'ffrcalcsumd','ffrsubtotalhidden')}"><apex:outputText value="{!if((grossMarginPercC-grossMarginPercD)==0,PZ,PN)}" rendered="{!RenderColumnC && RenderColumnD}"><apex:param value="{!(grossMarginPercC-grossMarginPercD)}"/></apex:outputText></th>-->
<th class="{!if(RenderColumnE,'ffrcalcsumd','ffrsubtotalhidden')}"><apex:outputText value="{!if(if(salesRevenueTotalColumnE=0,0,grandTotalColumnE/salesRevenueTotalColumnE)==0,PZ,PN)}" rendered="{!RenderColumnE}"><apex:param value="{!if(salesRevenueTotalColumnE=0,0,grandTotalColumnE/salesRevenueTotalColumnE)}"/></apex:outputText></th>
<th class="{!if(RenderColumnF,'ffrcalcsumd','ffrsubtotalhidden')}"><apex:outputText value="{!if(if(salesRevenueTotalColumnF=0,0,grandTotalColumnF/salesRevenueTotalColumnF)==0,PZ,PN)}" rendered="{!RenderColumnF}"><apex:param value="{!if(salesRevenueTotalColumnF=0,0,grandTotalColumnF/salesRevenueTotalColumnF)}"/></apex:outputText></th>
<th class="{!if(RenderColumnG,'ffrcalcsumd','ffrsubtotalhidden')}"><apex:outputText value="{!if(if(salesRevenueTotalColumnG=0,0,grandTotalColumnG/salesRevenueTotalColumnG)==0,PZ,PN)}" rendered="{!RenderColumnG}"><apex:param value="{!if(salesRevenueTotalColumnG=0,0,grandTotalColumnG/salesRevenueTotalColumnG)}"/></apex:outputText></th>
<th class="{!if(RenderColumnH,'ffrcalcsumd','ffrsubtotalhidden')}"><apex:outputText value="{!if(if(salesRevenueTotalColumnH=0,0,grandTotalColumnH/salesRevenueTotalColumnH)==0,PZ,PN)}" rendered="{!RenderColumnH}"><apex:param value="{!if(salesRevenueTotalColumnH=0,0,grandTotalColumnH/salesRevenueTotalColumnH)}"/></apex:outputText></th>
<th class="{!if(RenderColumnI,'ffrcalcsumd','ffrsubtotalhidden')}"><apex:outputText value="{!if(if(salesRevenueTotalColumnI=0,0,grandTotalColumnI/salesRevenueTotalColumnI)==0,PZ,PN)}" rendered="{!RenderColumnI}"><apex:param value="{!if(salesRevenueTotalColumnI=0,0,grandTotalColumnI/salesRevenueTotalColumnI)}"/></apex:outputText></th>
<th class="{!if(RenderColumnJ,'ffrcalcsumd','ffrsubtotalhidden')}"><apex:outputText value="{!if(if(salesRevenueTotalColumnJ=0,0,grandTotalColumnJ/salesRevenueTotalColumnJ)==0,PZ,PN)}" rendered="{!RenderColumnJ}"><apex:param value="{!if(salesRevenueTotalColumnJ=0,0,grandTotalColumnJ/salesRevenueTotalColumnJ)}"/></apex:outputText></th>
<th class="{!if(RenderColumnK,'ffrcalcsumd','ffrsubtotalhidden')}"><apex:outputText value="{!if(if(salesRevenueTotalColumnK=0,0,grandTotalColumnK/salesRevenueTotalColumnK)==0,PZ,PN)}" rendered="{!RenderColumnK}"><apex:param value="{!if(salesRevenueTotalColumnK=0,0,grandTotalColumnK/salesRevenueTotalColumnK)}"/></apex:outputText></th>
<th class="{!if(RenderColumnL,'ffrcalcsumd','ffrsubtotalhidden')}"><apex:outputText value="{!if(if(salesRevenueTotalColumnL=0,0,grandTotalColumnL/salesRevenueTotalColumnL)==0,PZ,PN)}" rendered="{!RenderColumnL}"><apex:param value="{!if(salesRevenueTotalColumnL=0,0,grandTotalColumnL/salesRevenueTotalColumnL)}"/></apex:outputText></th>
<th class="{!if(RenderColumnM,'ffrcalcsumd','ffrsubtotalhidden')}"><apex:outputText value="{!if(if(salesRevenueTotalColumnM=0,0,grandTotalColumnM/salesRevenueTotalColumnM)==0,PZ,PN)}" rendered="{!RenderColumnM}"><apex:param value="{!if(salesRevenueTotalColumnM=0,0,grandTotalColumnM/salesRevenueTotalColumnM)}"/></apex:outputText></th>
<th class="{!if(RenderColumnN,'ffrcalcsumd','ffrsubtotalhidden')}"><apex:outputText value="{!if(if(salesRevenueTotalColumnN=0,0,grandTotalColumnN/salesRevenueTotalColumnN)==0,PZ,PN)}" rendered="{!RenderColumnN}"><apex:param value="{!if(salesRevenueTotalColumnN=0,0,grandTotalColumnN/salesRevenueTotalColumnN)}"/></apex:outputText></th>
<th class="{!if(RenderColumnO,'ffrcalcsumd','ffrsubtotalhidden')}"><apex:outputText value="{!if(if(salesRevenueTotalColumnO=0,0,grandTotalColumnO/salesRevenueTotalColumnO)==0,PZ,PN)}" rendered="{!RenderColumnO}"><apex:param value="{!if(salesRevenueTotalColumnO=0,0,grandTotalColumnO/salesRevenueTotalColumnO)}"/></apex:outputText></th>
<th class="{!if(RenderColumnP,'ffrcalcsumd','ffrsubtotalhidden')}"><apex:outputText value="{!if(if(salesRevenueTotalColumnP=0,0,grandTotalColumnP/salesRevenueTotalColumnP)==0,PZ,PN)}" rendered="{!RenderColumnP}"><apex:param value="{!if(salesRevenueTotalColumnP=0,0,grandTotalColumnP/salesRevenueTotalColumnP)}"/></apex:outputText></th>
<th class="{!if(RenderColumnQ,'ffrcalcsumd','ffrsubtotalhidden')}"><apex:outputText value="{!if(if(salesRevenueTotalColumnQ=0,0,grandTotalColumnQ/salesRevenueTotalColumnQ)==0,PZ,PN)}" rendered="{!RenderColumnQ}"><apex:param value="{!if(salesRevenueTotalColumnQ=0,0,grandTotalColumnQ/salesRevenueTotalColumnQ)}"/></apex:outputText></th>
<th class="{!if(RenderColumnR,'ffrcalcsumd','ffrsubtotalhidden')}"><apex:outputText value="{!if(if(salesRevenueTotalColumnR=0,0,grandTotalColumnR/salesRevenueTotalColumnR)==0,PZ,PN)}" rendered="{!RenderColumnR}"><apex:param value="{!if(salesRevenueTotalColumnR=0,0,grandTotalColumnR/salesRevenueTotalColumnR)}"/></apex:outputText></th>
<th class="{!if(RenderColumnS,'ffrcalcsumd','ffrsubtotalhidden')}"><apex:outputText value="{!if(if(salesRevenueTotalColumnS=0,0,grandTotalColumnS/salesRevenueTotalColumnS)==0,PZ,PN)}" rendered="{!RenderColumnS}"><apex:param value="{!if(salesRevenueTotalColumnS=0,0,grandTotalColumnS/salesRevenueTotalColumnS)}"/></apex:outputText></th>
<th class="{!if(RenderColumnT,'ffrcalcsumd','ffrsubtotalhidden')}"><apex:outputText value="{!if(if(salesRevenueTotalColumnT=0,0,grandTotalColumnT/salesRevenueTotalColumnT)==0,PZ,PN)}" rendered="{!RenderColumnT}"><apex:param value="{!if(salesRevenueTotalColumnT=0,0,grandTotalColumnT/salesRevenueTotalColumnT)}"/></apex:outputText></th>
<th class="{!if(RenderColumnU,'ffrcalcsumd','ffrsubtotalhidden')}"><apex:outputText value="{!if(if(salesRevenueTotalColumnU=0,0,grandTotalColumnU/salesRevenueTotalColumnU)==0,PZ,PN)}" rendered="{!RenderColumnU}"><apex:param value="{!if(salesRevenueTotalColumnU=0,0,grandTotalColumnU/salesRevenueTotalColumnU)}"/></apex:outputText></th>
<th class="{!if(RenderColumnV,'ffrcalcsumd','ffrsubtotalhidden')}"><apex:outputText value="{!if(if(salesRevenueTotalColumnV=0,0,grandTotalColumnV/salesRevenueTotalColumnV)==0,PZ,PN)}" rendered="{!RenderColumnV}"><apex:param value="{!if(salesRevenueTotalColumnV=0,0,grandTotalColumnV/salesRevenueTotalColumnV)}"/></apex:outputText></th>
<th class="{!if(RenderColumnW,'ffrcalcsumd','ffrsubtotalhidden')}"><apex:outputText value="{!if(if(salesRevenueTotalColumnW=0,0,grandTotalColumnW/salesRevenueTotalColumnW)==0,PZ,PN)}" rendered="{!RenderColumnW}"><apex:param value="{!if(salesRevenueTotalColumnW=0,0,grandTotalColumnW/salesRevenueTotalColumnW)}"/></apex:outputText></th>
<th class="{!if(RenderColumnX,'ffrcalcsumd','ffrsubtotalhidden')}"><apex:outputText value="{!if(if(salesRevenueTotalColumnX=0,0,grandTotalColumnX/salesRevenueTotalColumnX)==0,PZ,PN)}" rendered="{!RenderColumnX}"><apex:param value="{!if(salesRevenueTotalColumnX=0,0,grandTotalColumnX/salesRevenueTotalColumnX)}"/></apex:outputText></th>
<th class="{!if(RenderColumnY,'ffrcalcsumd','ffrsubtotalhidden')}"><apex:outputText value="{!if(if(salesRevenueTotalColumnY=0,0,grandTotalColumnY/salesRevenueTotalColumnY)==0,PZ,PN)}" rendered="{!RenderColumnY}"><apex:param value="{!if(salesRevenueTotalColumnY=0,0,grandTotalColumnY/salesRevenueTotalColumnY)}"/></apex:outputText></th>
<th class="{!if(RenderColumnZ,'ffrcalcsumd','ffrsubtotalhidden')}"><apex:outputText value="{!if(if(salesRevenueTotalColumnZ=0,0,grandTotalColumnZ/salesRevenueTotalColumnZ)==0,PZ,PN)}" rendered="{!RenderColumnZ}"><apex:param value="{!if(salesRevenueTotalColumnZ=0,0,grandTotalColumnZ/salesRevenueTotalColumnZ)}"/></apex:outputText></th>
</tr>
<!-- Spacer -->
<tr><td class="ffrgridspacerd" colspan="11"></td></tr>
<!-- Set the flag to indicate that we have displayed Gross Margin calculations -->
<apex:variable value="{!true}" var="NetProfitBeforeTaxCalculationsDisplayed"/>
</apex:outputPanel>

<td class="ffrcalcsumlabeld" colspan="11">
<label for="{!rowKeyNum}" style="{!IF(OR(RenderReportAs == 'pdf',rowKeyNum>90),'display:none;','')}">+</label>
<label for="{!rowKeyNum}" style="{!IF(rowKeyNum>90,'display:none;','')}">{!row.label}</label>
<input style="display:none;" type="checkbox" name="{!rowKeyNum}" id="{!rowKeyNum}" data-toggle="toggle"/>
</td>
<tbody class="hide">

<!-- For each row, reset all column row-totals and subtotals to zero (if the column is in use - determined by column render state variables) -->
<!-- It calculates one Row Subtotal per Group (01 to 05), so we need rowSubtotal variables for each group (ie, rowSubtotalGroup02) -->
<tr><td class = "ffrhidden">
<apex:variable value="{!0}" var="rowTotalColumnA" rendered="{!RenderColumnA}"/>
<apex:variable value="{!0}" var="rowTotalColumnB" rendered="{!RenderColumnB}"/>
<apex:variable value="{!0}" var="rowTotalColumnC" rendered="{!RenderColumnC}"/>
<apex:variable value="{!0}" var="rowTotalColumnD" rendered="{!RenderColumnD}"/>
<apex:variable value="{!0}" var="rowTotalColumnE" rendered="{!RenderColumnE}"/>
<apex:variable value="{!0}" var="rowTotalColumnF" rendered="{!RenderColumnF}"/>
<apex:variable value="{!0}" var="rowTotalColumnG" rendered="{!RenderColumnG}"/>
<apex:variable value="{!0}" var="rowTotalColumnH" rendered="{!RenderColumnH}"/>
<apex:variable value="{!0}" var="rowTotalColumnI" rendered="{!RenderColumnI}"/>
<apex:variable value="{!0}" var="rowTotalColumnJ" rendered="{!RenderColumnJ}"/>
<apex:variable value="{!0}" var="rowTotalColumnK" rendered="{!RenderColumnK}"/>
<apex:variable value="{!0}" var="rowTotalColumnL" rendered="{!RenderColumnL}"/>
<apex:variable value="{!0}" var="rowTotalColumnM" rendered="{!RenderColumnM}"/>
<apex:variable value="{!0}" var="rowTotalColumnN" rendered="{!RenderColumnN}"/>
<apex:variable value="{!0}" var="rowTotalColumnO" rendered="{!RenderColumnO}"/>
<apex:variable value="{!0}" var="rowTotalColumnP" rendered="{!RenderColumnP}"/>
<apex:variable value="{!0}" var="rowTotalColumnQ" rendered="{!RenderColumnQ}"/>
<apex:variable value="{!0}" var="rowTotalColumnR" rendered="{!RenderColumnR}"/>
<apex:variable value="{!0}" var="rowTotalColumnS" rendered="{!RenderColumnS}"/>
<apex:variable value="{!0}" var="rowTotalColumnT" rendered="{!RenderColumnT}"/>
<apex:variable value="{!0}" var="rowTotalColumnU" rendered="{!RenderColumnU}"/>
<apex:variable value="{!0}" var="rowTotalColumnV" rendered="{!RenderColumnV}"/>
<apex:variable value="{!0}" var="rowTotalColumnW" rendered="{!RenderColumnW}"/>
<apex:variable value="{!0}" var="rowTotalColumnX" rendered="{!RenderColumnX}"/>
<apex:variable value="{!0}" var="rowTotalColumnY" rendered="{!RenderColumnY}"/>
<apex:variable value="{!0}" var="rowTotalColumnZ" rendered="{!RenderColumnZ}"/>
<apex:variable value="{!0}" var="rowSubtotalGroup02ColumnA" rendered="{!RenderColumnA}"/>
<apex:variable value="{!0}" var="rowSubtotalGroup02ColumnB" rendered="{!RenderColumnB}"/>
<apex:variable value="{!0}" var="rowSubtotalGroup02ColumnC" rendered="{!RenderColumnC}"/>
<apex:variable value="{!0}" var="rowSubtotalGroup02ColumnD" rendered="{!RenderColumnD}"/>
<apex:variable value="{!0}" var="rowSubtotalGroup02ColumnE" rendered="{!RenderColumnE}"/>
<apex:variable value="{!0}" var="rowSubtotalGroup02ColumnF" rendered="{!RenderColumnF}"/>
<apex:variable value="{!0}" var="rowSubtotalGroup02ColumnG" rendered="{!RenderColumnG}"/>
<apex:variable value="{!0}" var="rowSubtotalGroup02ColumnH" rendered="{!RenderColumnH}"/>
<apex:variable value="{!0}" var="rowSubtotalGroup02ColumnI" rendered="{!RenderColumnI}"/>
<apex:variable value="{!0}" var="rowSubtotalGroup02ColumnJ" rendered="{!RenderColumnJ}"/>
<apex:variable value="{!0}" var="rowSubtotalGroup02ColumnK" rendered="{!RenderColumnK}"/>
<apex:variable value="{!0}" var="rowSubtotalGroup02ColumnL" rendered="{!RenderColumnL}"/>
<apex:variable value="{!0}" var="rowSubtotalGroup02ColumnM" rendered="{!RenderColumnM}"/>
<apex:variable value="{!0}" var="rowSubtotalGroup02ColumnN" rendered="{!RenderColumnN}"/>
<apex:variable value="{!0}" var="rowSubtotalGroup02ColumnO" rendered="{!RenderColumnO}"/>
<apex:variable value="{!0}" var="rowSubtotalGroup02ColumnP" rendered="{!RenderColumnP}"/>
<apex:variable value="{!0}" var="rowSubtotalGroup02ColumnQ" rendered="{!RenderColumnQ}"/>
<apex:variable value="{!0}" var="rowSubtotalGroup02ColumnR" rendered="{!RenderColumnR}"/>
<apex:variable value="{!0}" var="rowSubtotalGroup02ColumnS" rendered="{!RenderColumnS}"/>
<apex:variable value="{!0}" var="rowSubtotalGroup02ColumnT" rendered="{!RenderColumnT}"/>
<apex:variable value="{!0}" var="rowSubtotalGroup02ColumnU" rendered="{!RenderColumnU}"/>
<apex:variable value="{!0}" var="rowSubtotalGroup02ColumnV" rendered="{!RenderColumnV}"/>
<apex:variable value="{!0}" var="rowSubtotalGroup02ColumnW" rendered="{!RenderColumnW}"/>
<apex:variable value="{!0}" var="rowSubtotalGroup02ColumnX" rendered="{!RenderColumnX}"/>
<apex:variable value="{!0}" var="rowSubtotalGroup02ColumnY" rendered="{!RenderColumnY}"/>
<apex:variable value="{!0}" var="rowSubtotalGroup02ColumnZ" rendered="{!RenderColumnZ}"/>
<apex:variable value="{!0}" var="rowSubtotalGroup03ColumnA" rendered="{!RenderColumnA}"/>
<apex:variable value="{!0}" var="rowSubtotalGroup03ColumnB" rendered="{!RenderColumnB}"/>
<apex:variable value="{!0}" var="rowSubtotalGroup03ColumnC" rendered="{!RenderColumnC}"/>
<apex:variable value="{!0}" var="rowSubtotalGroup03ColumnD" rendered="{!RenderColumnD}"/>
<apex:variable value="{!0}" var="rowSubtotalGroup03ColumnE" rendered="{!RenderColumnE}"/>
<apex:variable value="{!0}" var="rowSubtotalGroup03ColumnF" rendered="{!RenderColumnF}"/>
<apex:variable value="{!0}" var="rowSubtotalGroup03ColumnG" rendered="{!RenderColumnG}"/>
<apex:variable value="{!0}" var="rowSubtotalGroup03ColumnH" rendered="{!RenderColumnH}"/>
<apex:variable value="{!0}" var="rowSubtotalGroup03ColumnI" rendered="{!RenderColumnI}"/>
<apex:variable value="{!0}" var="rowSubtotalGroup03ColumnJ" rendered="{!RenderColumnJ}"/>
<apex:variable value="{!0}" var="rowSubtotalGroup03ColumnK" rendered="{!RenderColumnK}"/>
<apex:variable value="{!0}" var="rowSubtotalGroup03ColumnL" rendered="{!RenderColumnL}"/>
<apex:variable value="{!0}" var="rowSubtotalGroup03ColumnM" rendered="{!RenderColumnM}"/>
<apex:variable value="{!0}" var="rowSubtotalGroup03ColumnN" rendered="{!RenderColumnN}"/>
<apex:variable value="{!0}" var="rowSubtotalGroup03ColumnO" rendered="{!RenderColumnO}"/>
<apex:variable value="{!0}" var="rowSubtotalGroup03ColumnP" rendered="{!RenderColumnP}"/>
<apex:variable value="{!0}" var="rowSubtotalGroup03ColumnQ" rendered="{!RenderColumnQ}"/>
<apex:variable value="{!0}" var="rowSubtotalGroup03ColumnR" rendered="{!RenderColumnR}"/>
<apex:variable value="{!0}" var="rowSubtotalGroup03ColumnS" rendered="{!RenderColumnS}"/>
<apex:variable value="{!0}" var="rowSubtotalGroup03ColumnT" rendered="{!RenderColumnT}"/>
<apex:variable value="{!0}" var="rowSubtotalGroup03ColumnU" rendered="{!RenderColumnU}"/>
<apex:variable value="{!0}" var="rowSubtotalGroup03ColumnV" rendered="{!RenderColumnV}"/>
<apex:variable value="{!0}" var="rowSubtotalGroup03ColumnW" rendered="{!RenderColumnW}"/>
<apex:variable value="{!0}" var="rowSubtotalGroup03ColumnX" rendered="{!RenderColumnX}"/>
<apex:variable value="{!0}" var="rowSubtotalGroup03ColumnY" rendered="{!RenderColumnY}"/>
<apex:variable value="{!0}" var="rowSubtotalGroup03ColumnZ" rendered="{!RenderColumnZ}"/>
<apex:variable value="{!0}" var="rowSubtotalGroup04ColumnA" rendered="{!RenderColumnA}"/>
<apex:variable value="{!0}" var="rowSubtotalGroup04ColumnB" rendered="{!RenderColumnB}"/>
<apex:variable value="{!0}" var="rowSubtotalGroup04ColumnC" rendered="{!RenderColumnC}"/>
<apex:variable value="{!0}" var="rowSubtotalGroup04ColumnD" rendered="{!RenderColumnD}"/>
<apex:variable value="{!0}" var="rowSubtotalGroup04ColumnE" rendered="{!RenderColumnE}"/>
<apex:variable value="{!0}" var="rowSubtotalGroup04ColumnF" rendered="{!RenderColumnF}"/>
<apex:variable value="{!0}" var="rowSubtotalGroup04ColumnG" rendered="{!RenderColumnG}"/>
<apex:variable value="{!0}" var="rowSubtotalGroup04ColumnH" rendered="{!RenderColumnH}"/>
<apex:variable value="{!0}" var="rowSubtotalGroup04ColumnI" rendered="{!RenderColumnI}"/>
<apex:variable value="{!0}" var="rowSubtotalGroup04ColumnJ" rendered="{!RenderColumnJ}"/>
<apex:variable value="{!0}" var="rowSubtotalGroup04ColumnK" rendered="{!RenderColumnK}"/>
<apex:variable value="{!0}" var="rowSubtotalGroup04ColumnL" rendered="{!RenderColumnL}"/>
<apex:variable value="{!0}" var="rowSubtotalGroup04ColumnM" rendered="{!RenderColumnM}"/>
<apex:variable value="{!0}" var="rowSubtotalGroup04ColumnN" rendered="{!RenderColumnN}"/>
<apex:variable value="{!0}" var="rowSubtotalGroup04ColumnO" rendered="{!RenderColumnO}"/>
<apex:variable value="{!0}" var="rowSubtotalGroup04ColumnP" rendered="{!RenderColumnP}"/>
<apex:variable value="{!0}" var="rowSubtotalGroup04ColumnQ" rendered="{!RenderColumnQ}"/>
<apex:variable value="{!0}" var="rowSubtotalGroup04ColumnR" rendered="{!RenderColumnR}"/>
<apex:variable value="{!0}" var="rowSubtotalGroup04ColumnS" rendered="{!RenderColumnS}"/>
<apex:variable value="{!0}" var="rowSubtotalGroup04ColumnT" rendered="{!RenderColumnT}"/>
<apex:variable value="{!0}" var="rowSubtotalGroup04ColumnU" rendered="{!RenderColumnU}"/>
<apex:variable value="{!0}" var="rowSubtotalGroup04ColumnV" rendered="{!RenderColumnV}"/>
<apex:variable value="{!0}" var="rowSubtotalGroup04ColumnW" rendered="{!RenderColumnW}"/>
<apex:variable value="{!0}" var="rowSubtotalGroup04ColumnX" rendered="{!RenderColumnX}"/>
<apex:variable value="{!0}" var="rowSubtotalGroup04ColumnY" rendered="{!RenderColumnY}"/>
<apex:variable value="{!0}" var="rowSubtotalGroup04ColumnZ" rendered="{!RenderColumnZ}"/>
<apex:variable value="{!0}" var="rowSubtotalGroup05ColumnA" rendered="{!RenderColumnA}"/>
<apex:variable value="{!0}" var="rowSubtotalGroup05ColumnB" rendered="{!RenderColumnB}"/>
<apex:variable value="{!0}" var="rowSubtotalGroup05ColumnC" rendered="{!RenderColumnC}"/>
<apex:variable value="{!0}" var="rowSubtotalGroup05ColumnD" rendered="{!RenderColumnD}"/>
<apex:variable value="{!0}" var="rowSubtotalGroup05ColumnE" rendered="{!RenderColumnE}"/>
<apex:variable value="{!0}" var="rowSubtotalGroup05ColumnF" rendered="{!RenderColumnF}"/>
<apex:variable value="{!0}" var="rowSubtotalGroup05ColumnG" rendered="{!RenderColumnG}"/>
<apex:variable value="{!0}" var="rowSubtotalGroup05ColumnH" rendered="{!RenderColumnH}"/>
<apex:variable value="{!0}" var="rowSubtotalGroup05ColumnI" rendered="{!RenderColumnI}"/>
<apex:variable value="{!0}" var="rowSubtotalGroup05ColumnJ" rendered="{!RenderColumnJ}"/>
<apex:variable value="{!0}" var="rowSubtotalGroup05ColumnK" rendered="{!RenderColumnK}"/>
<apex:variable value="{!0}" var="rowSubtotalGroup05ColumnL" rendered="{!RenderColumnL}"/>
<apex:variable value="{!0}" var="rowSubtotalGroup05ColumnM" rendered="{!RenderColumnM}"/>
<apex:variable value="{!0}" var="rowSubtotalGroup05ColumnN" rendered="{!RenderColumnN}"/>
<apex:variable value="{!0}" var="rowSubtotalGroup05ColumnO" rendered="{!RenderColumnO}"/>
<apex:variable value="{!0}" var="rowSubtotalGroup05ColumnP" rendered="{!RenderColumnP}"/>
<apex:variable value="{!0}" var="rowSubtotalGroup05ColumnQ" rendered="{!RenderColumnQ}"/>
<apex:variable value="{!0}" var="rowSubtotalGroup05ColumnR" rendered="{!RenderColumnR}"/>
<apex:variable value="{!0}" var="rowSubtotalGroup05ColumnS" rendered="{!RenderColumnS}"/>
<apex:variable value="{!0}" var="rowSubtotalGroup05ColumnT" rendered="{!RenderColumnT}"/>
<apex:variable value="{!0}" var="rowSubtotalGroup05ColumnU" rendered="{!RenderColumnU}"/>
<apex:variable value="{!0}" var="rowSubtotalGroup05ColumnV" rendered="{!RenderColumnV}"/>
<apex:variable value="{!0}" var="rowSubtotalGroup05ColumnW" rendered="{!RenderColumnW}"/>
<apex:variable value="{!0}" var="rowSubtotalGroup05ColumnX" rendered="{!RenderColumnX}"/>
<apex:variable value="{!0}" var="rowSubtotalGroup05ColumnY" rendered="{!RenderColumnY}"/>
<apex:variable value="{!0}" var="rowSubtotalGroup05ColumnZ" rendered="{!RenderColumnZ}"/>
</td></tr>
<!-- These variables are used to determine when to print a subtotal -->
<apex:variable var="previousLineGroup02" value=""/>
<apex:variable var="previousLineGroup03" value=""/>
<apex:variable var="previousLineGroup04" value=""/>
<apex:variable var="previousLineGroup05" value=""/>
<apex:variable var="currentLineGroup02" value=""/>
<apex:variable var="currentLineGroup03" value=""/>
<apex:variable var="currentLineGroup04" value=""/>
<apex:variable var="currentLineGroup05" value=""/>
<!-- This variable is used to determine whether the line is the first line in the row - to prevent a subtotal being printed before the first line -->
<apex:variable var="firstLine" value="{!true}"/>
<!-- Iterate over the Lines -->
<apex:repeat value="{!row.lineList}" var="line" >
    <!-- Display the line and process subtotals - for rows up to 90 -->
    <apex:outputPanel layout="none" rendered="{!rowKeyNum<91}">
<!-- Set the variables representing the groups for the current line for comparison with the previous line -->
<tr><td class = "ffrhidden">
<apex:variable value="{!line.groups['02']}" var="currentLineGroup02" rendered="{!RenderGroup02}"/>
<apex:variable value="{!line.groups['03']}" var="currentLineGroup03" rendered="{!RenderGroup03}"/>
<apex:variable value="{!line.groups['04']}" var="currentLineGroup04" rendered="{!RenderGroup04}"/>
<apex:variable value="{!line.groups['05']}" var="currentLineGroup05" rendered="{!RenderGroup05}"/>
</td></tr>
<!-- Mid-row subtotal line -->
<!-- Do we want to process a (mid-row) subtotal line for Group05? -->
<apex:variable var="doSubtotal05" value="{!RenderGroupSubtotals && !firstLine && (currentLineGroup02!=previousLineGroup02 || currentLineGroup03!=previousLineGroup03|| currentLineGroup04!=previousLineGroup04|| currentLineGroup05!=previousLineGroup05)}"/>
<!-- Display Subtotals if Group05 is rendered -->
<!-- Set calculated values as variables (for ease of use) -->
<apex:variable value="{!(rowSubtotalGroup05ColumnA-rowSubtotalGroup05ColumnB)}" var="rowSubtotalGroup05VarianceAB"/>
<apex:variable value="{!(rowSubtotalGroup05ColumnC-rowSubtotalGroup05ColumnD)}" var="rowSubtotalGroup05VarianceCD"/>
<apex:variable value="{!if(rowSubtotalGroup05ColumnB=0,(if(rowSubtotalGroup05ColumnA=0,0,(rowSubtotalGroup05VarianceAB/rowSubtotalGroup05ColumnA))),(rowSubtotalGroup05VarianceAB/rowSubtotalGroup05ColumnB))}" var="rowSubtotalGroup05VariancePercAB"/>
<apex:variable value="{!if(rowSubtotalGroup05ColumnD=0,(if(rowSubtotalGroup05ColumnC=0,0,(rowSubtotalGroup05VarianceCD/rowSubtotalGroup05ColumnC))),(rowSubtotalGroup05VarianceCD/rowSubtotalGroup05ColumnD))}" var="rowSubtotalGroup05VariancePercCD"/>
<tr>
<!-- Display the group-group values but not the group-line values -->
<td class="{!if(doSubtotal05 && RenderGroup05,'ffrsubtotallabeld','ffrsubtotalhidden')}" colspan="11">
<apex:outputPanel layout="none" rendered="{!doSubtotal05 && RenderGroup05}">{!previousLineGroup05}</apex:outputPanel></td>
<td class="{!if(doSubtotal05 && RenderGroup05,'ffrgridspacerd','ffrsubtotalhidden')}"></td>
<td class="{!if(doSubtotal05 && RenderGroup05 && RenderColumnA,'ffrsubtotald','ffrsubtotalhidden')}"><apex:outputText value="{!if(rowSubtotalGroup05ColumnA==0,VZ,RowNumberPattern)}" rendered="{!doSubtotal05 && RenderGroup05 && RenderColumnA}"><apex:param value="{!rowSubtotalGroup05ColumnA}"/></apex:outputText></td>
<td class="{!if(doSubtotal05 && RenderGroup05 && RenderColumnB,'ffrsubtotald','ffrsubtotalhidden')}"><apex:outputText value="{!if(rowSubtotalGroup05ColumnB==0,VZ,RowNumberPattern)}" rendered="{!doSubtotal05 && RenderGroup05 && RenderColumnB}"><apex:param value="{!rowSubtotalGroup05ColumnB}"/></apex:outputText></td>
<!--<td class="{!if(doSubtotal05 && RenderGroup05 && RenderColumnA && RenderColumnB,'ffrsubtotald','ffrsubtotalhidden')}"><apex:outputText value="{!if(rowSubtotalGroup05VarianceAB==0,VZ,RowNumberPattern)}" rendered="{!doSubtotal05 && RenderGroup05 && RenderColumnA && RenderColumnB}"><apex:param value="{!rowSubtotalGroup05VarianceAB}"/></apex:outputText></td>
<td class="{!if(doSubtotal05 && RenderGroup05 && RenderColumnA && RenderColumnB,'ffrsubtotald','ffrsubtotalhidden')}"><apex:outputText value="{!if(rowSubtotalGroup05VariancePercAB==0,PZ,RowPercentagePattern)}" rendered="{!doSubtotal05 && RenderGroup05 && RenderColumnA && RenderColumnB}"><apex:param value="{!rowSubtotalGroup05VariancePercAB}"/></apex:outputText></td>-->
<td class="{!if(doSubtotal05 && RenderGroup05 && RenderColumnC,'ffrsubtotald','ffrsubtotalhidden')}"><apex:outputText value="{!if(rowSubtotalGroup05ColumnC==0,VZ,RowNumberPattern)}" rendered="{!doSubtotal05 && RenderGroup05 && RenderColumnC}"><apex:param value="{!rowSubtotalGroup05ColumnC}"/></apex:outputText></td>
<td class="{!if(doSubtotal05 && RenderGroup05 && RenderColumnD,'ffrsubtotald','ffrsubtotalhidden')}"><apex:outputText value="{!if(rowSubtotalGroup05ColumnD==0,VZ,RowNumberPattern)}" rendered="{!doSubtotal05 && RenderGroup05 && RenderColumnD}"><apex:param value="{!rowSubtotalGroup05ColumnD}"/></apex:outputText></td>
<!--<td class="{!if(doSubtotal05 && RenderGroup05 && RenderColumnC && RenderColumnD,'ffrsubtotald','ffrsubtotalhidden')}"><apex:outputText value="{!if(rowSubtotalGroup05VarianceCD==0,VZ,RowNumberPattern)}" rendered="{!doSubtotal05 && RenderGroup05 && RenderColumnC && RenderColumnD}"><apex:param value="{!rowSubtotalGroup05VarianceCD}"/></apex:outputText></td>
<td class="{!if(doSubtotal05 && RenderGroup05 && RenderColumnC && RenderColumnD,'ffrsubtotald','ffrsubtotalhidden')}"><apex:outputText value="{!if(rowSubtotalGroup05VariancePercCD==0,PZ,RowPercentagePattern)}" rendered="{!doSubtotal05 && RenderGroup05 && RenderColumnC && RenderColumnD}"><apex:param value="{!rowSubtotalGroup05VariancePercCD}"/></apex:outputText></td> -->
<!--Standard lines from this area of the template-->
<td class="{!if(doSubtotal05 && RenderGroup05 && RenderColumnE,'ffrsubtotald','ffrsubtotalhidden')}"><apex:outputText value="{!if(rowSubtotalGroup05ColumnE==0,VZ,RowNumberPattern)}" rendered="{!doSubtotal05 && RenderGroup05 && RenderColumnE}"><apex:param value="{!rowSubtotalGroup05ColumnE}"/></apex:outputText></td>
<td class="{!if(doSubtotal05 && RenderGroup05 && RenderColumnF,'ffrsubtotald','ffrsubtotalhidden')}"><apex:outputText value="{!if(rowSubtotalGroup05ColumnF==0,VZ,RowNumberPattern)}" rendered="{!doSubtotal05 && RenderGroup05 && RenderColumnF}"><apex:param value="{!rowSubtotalGroup05ColumnF}"/></apex:outputText></td>
<td class="{!if(doSubtotal05 && RenderGroup05 && RenderColumnG,'ffrsubtotald','ffrsubtotalhidden')}"><apex:outputText value="{!if(rowSubtotalGroup05ColumnG==0,VZ,RowNumberPattern)}" rendered="{!doSubtotal05 && RenderGroup05 && RenderColumnG}"><apex:param value="{!rowSubtotalGroup05ColumnG}"/></apex:outputText></td>
<td class="{!if(doSubtotal05 && RenderGroup05 && RenderColumnH,'ffrsubtotald','ffrsubtotalhidden')}"><apex:outputText value="{!if(rowSubtotalGroup05ColumnH==0,VZ,RowNumberPattern)}" rendered="{!doSubtotal05 && RenderGroup05 && RenderColumnH}"><apex:param value="{!rowSubtotalGroup05ColumnH}"/></apex:outputText></td>
<td class="{!if(doSubtotal05 && RenderGroup05 && RenderColumnI,'ffrsubtotald','ffrsubtotalhidden')}"><apex:outputText value="{!if(rowSubtotalGroup05ColumnI==0,VZ,RowNumberPattern)}" rendered="{!doSubtotal05 && RenderGroup05 && RenderColumnI}"><apex:param value="{!rowSubtotalGroup05ColumnI}"/></apex:outputText></td>
<td class="{!if(doSubtotal05 && RenderGroup05 && RenderColumnJ,'ffrsubtotald','ffrsubtotalhidden')}"><apex:outputText value="{!if(rowSubtotalGroup05ColumnJ==0,VZ,RowNumberPattern)}" rendered="{!doSubtotal05 && RenderGroup05 && RenderColumnJ}"><apex:param value="{!rowSubtotalGroup05ColumnJ}"/></apex:outputText></td>
<td class="{!if(doSubtotal05 && RenderGroup05 && RenderColumnK,'ffrsubtotald','ffrsubtotalhidden')}"><apex:outputText value="{!if(rowSubtotalGroup05ColumnK==0,VZ,RowNumberPattern)}" rendered="{!doSubtotal05 && RenderGroup05 && RenderColumnK}"><apex:param value="{!rowSubtotalGroup05ColumnK}"/></apex:outputText></td>
<td class="{!if(doSubtotal05 && RenderGroup05 && RenderColumnL,'ffrsubtotald','ffrsubtotalhidden')}"><apex:outputText value="{!if(rowSubtotalGroup05ColumnL==0,VZ,RowNumberPattern)}" rendered="{!doSubtotal05 && RenderGroup05 && RenderColumnL}"><apex:param value="{!rowSubtotalGroup05ColumnL}"/></apex:outputText></td>
<td class="{!if(doSubtotal05 && RenderGroup05 && RenderColumnM,'ffrsubtotald','ffrsubtotalhidden')}"><apex:outputText value="{!if(rowSubtotalGroup05ColumnM==0,VZ,RowNumberPattern)}" rendered="{!doSubtotal05 && RenderGroup05 && RenderColumnM}"><apex:param value="{!rowSubtotalGroup05ColumnM}"/></apex:outputText></td>
<td class="{!if(doSubtotal05 && RenderGroup05 && RenderColumnN,'ffrsubtotald','ffrsubtotalhidden')}"><apex:outputText value="{!if(rowSubtotalGroup05ColumnN==0,VZ,RowNumberPattern)}" rendered="{!doSubtotal05 && RenderGroup05 && RenderColumnN}"><apex:param value="{!rowSubtotalGroup05ColumnN}"/></apex:outputText></td>
<td class="{!if(doSubtotal05 && RenderGroup05 && RenderColumnO,'ffrsubtotald','ffrsubtotalhidden')}"><apex:outputText value="{!if(rowSubtotalGroup05ColumnO==0,VZ,RowNumberPattern)}" rendered="{!doSubtotal05 && RenderGroup05 && RenderColumnO}"><apex:param value="{!rowSubtotalGroup05ColumnO}"/></apex:outputText></td>
<td class="{!if(doSubtotal05 && RenderGroup05 && RenderColumnP,'ffrsubtotald','ffrsubtotalhidden')}"><apex:outputText value="{!if(rowSubtotalGroup05ColumnP==0,VZ,RowNumberPattern)}" rendered="{!doSubtotal05 && RenderGroup05 && RenderColumnP}"><apex:param value="{!rowSubtotalGroup05ColumnP}"/></apex:outputText></td>
<td class="{!if(doSubtotal05 && RenderGroup05 && RenderColumnQ,'ffrsubtotald','ffrsubtotalhidden')}"><apex:outputText value="{!if(rowSubtotalGroup05ColumnQ==0,VZ,RowNumberPattern)}" rendered="{!doSubtotal05 && RenderGroup05 && RenderColumnQ}"><apex:param value="{!rowSubtotalGroup05ColumnQ}"/></apex:outputText></td>
<td class="{!if(doSubtotal05 && RenderGroup05 && RenderColumnR,'ffrsubtotald','ffrsubtotalhidden')}"><apex:outputText value="{!if(rowSubtotalGroup05ColumnR==0,VZ,RowNumberPattern)}" rendered="{!doSubtotal05 && RenderGroup05 && RenderColumnR}"><apex:param value="{!rowSubtotalGroup05ColumnR}"/></apex:outputText></td>
<td class="{!if(doSubtotal05 && RenderGroup05 && RenderColumnS,'ffrsubtotald','ffrsubtotalhidden')}"><apex:outputText value="{!if(rowSubtotalGroup05ColumnS==0,VZ,RowNumberPattern)}" rendered="{!doSubtotal05 && RenderGroup05 && RenderColumnS}"><apex:param value="{!rowSubtotalGroup05ColumnS}"/></apex:outputText></td>
<td class="{!if(doSubtotal05 && RenderGroup05 && RenderColumnT,'ffrsubtotald','ffrsubtotalhidden')}"><apex:outputText value="{!if(rowSubtotalGroup05ColumnT==0,VZ,RowNumberPattern)}" rendered="{!doSubtotal05 && RenderGroup05 && RenderColumnT}"><apex:param value="{!rowSubtotalGroup05ColumnT}"/></apex:outputText></td>
<td class="{!if(doSubtotal05 && RenderGroup05 && RenderColumnU,'ffrsubtotald','ffrsubtotalhidden')}"><apex:outputText value="{!if(rowSubtotalGroup05ColumnU==0,VZ,RowNumberPattern)}" rendered="{!doSubtotal05 && RenderGroup05 && RenderColumnU}"><apex:param value="{!rowSubtotalGroup05ColumnU}"/></apex:outputText></td>
<td class="{!if(doSubtotal05 && RenderGroup05 && RenderColumnV,'ffrsubtotald','ffrsubtotalhidden')}"><apex:outputText value="{!if(rowSubtotalGroup05ColumnV==0,VZ,RowNumberPattern)}" rendered="{!doSubtotal05 && RenderGroup05 && RenderColumnV}"><apex:param value="{!rowSubtotalGroup05ColumnV}"/></apex:outputText></td>
<td class="{!if(doSubtotal05 && RenderGroup05 && RenderColumnW,'ffrsubtotald','ffrsubtotalhidden')}"><apex:outputText value="{!if(rowSubtotalGroup05ColumnW==0,VZ,RowNumberPattern)}" rendered="{!doSubtotal05 && RenderGroup05 && RenderColumnW}"><apex:param value="{!rowSubtotalGroup05ColumnW}"/></apex:outputText></td>
<td class="{!if(doSubtotal05 && RenderGroup05 && RenderColumnX,'ffrsubtotald','ffrsubtotalhidden')}"><apex:outputText value="{!if(rowSubtotalGroup05ColumnX==0,VZ,RowNumberPattern)}" rendered="{!doSubtotal05 && RenderGroup05 && RenderColumnX}"><apex:param value="{!rowSubtotalGroup05ColumnX}"/></apex:outputText></td>
<td class="{!if(doSubtotal05 && RenderGroup05 && RenderColumnY,'ffrsubtotald','ffrsubtotalhidden')}"><apex:outputText value="{!if(rowSubtotalGroup05ColumnY==0,VZ,RowNumberPattern)}" rendered="{!doSubtotal05 && RenderGroup05 && RenderColumnY}"><apex:param value="{!rowSubtotalGroup05ColumnY}"/></apex:outputText></td>
<td class="{!if(doSubtotal05 && RenderGroup05 && RenderColumnZ,'ffrsubtotald','ffrsubtotalhidden')}"><apex:outputText value="{!if(rowSubtotalGroup05ColumnZ==0,VZ,RowNumberPattern)}" rendered="{!doSubtotal05 && RenderGroup05 && RenderColumnZ}"><apex:param value="{!rowSubtotalGroup05ColumnZ}"/></apex:outputText></td>
</tr>
<!-- Reset the subtotals for Group05 -->
<tr><td class="ffrhidden">
<apex:variable value="{!0}" var="rowSubtotalGroup05ColumnA" rendered="{!doSubtotal05 && RenderGroup05 && RenderColumnA}"/>
<apex:variable value="{!0}" var="rowSubtotalGroup05ColumnB" rendered="{!doSubtotal05 && RenderGroup05 && RenderColumnB}"/>
<apex:variable value="{!0}" var="rowSubtotalGroup05ColumnC" rendered="{!doSubtotal05 && RenderGroup05 && RenderColumnC}"/>
<apex:variable value="{!0}" var="rowSubtotalGroup05ColumnD" rendered="{!doSubtotal05 && RenderGroup05 && RenderColumnD}"/>
<apex:variable value="{!0}" var="rowSubtotalGroup05ColumnE" rendered="{!doSubtotal05 && RenderGroup05 && RenderColumnE}"/>
<apex:variable value="{!0}" var="rowSubtotalGroup05ColumnF" rendered="{!doSubtotal05 && RenderGroup05 && RenderColumnF}"/>
<apex:variable value="{!0}" var="rowSubtotalGroup05ColumnG" rendered="{!doSubtotal05 && RenderGroup05 && RenderColumnG}"/>
<apex:variable value="{!0}" var="rowSubtotalGroup05ColumnH" rendered="{!doSubtotal05 && RenderGroup05 && RenderColumnH}"/>
<apex:variable value="{!0}" var="rowSubtotalGroup05ColumnI" rendered="{!doSubtotal05 && RenderGroup05 && RenderColumnI}"/>
<apex:variable value="{!0}" var="rowSubtotalGroup05ColumnJ" rendered="{!doSubtotal05 && RenderGroup05 && RenderColumnJ}"/>
<apex:variable value="{!0}" var="rowSubtotalGroup05ColumnK" rendered="{!doSubtotal05 && RenderGroup05 && RenderColumnK}"/>
<apex:variable value="{!0}" var="rowSubtotalGroup05ColumnL" rendered="{!doSubtotal05 && RenderGroup05 && RenderColumnL}"/>
<apex:variable value="{!0}" var="rowSubtotalGroup05ColumnM" rendered="{!doSubtotal05 && RenderGroup05 && RenderColumnM}"/>
<apex:variable value="{!0}" var="rowSubtotalGroup05ColumnN" rendered="{!doSubtotal05 && RenderGroup05 && RenderColumnN}"/>
<apex:variable value="{!0}" var="rowSubtotalGroup05ColumnO" rendered="{!doSubtotal05 && RenderGroup05 && RenderColumnO}"/>
<apex:variable value="{!0}" var="rowSubtotalGroup05ColumnP" rendered="{!doSubtotal05 && RenderGroup05 && RenderColumnP}"/>
<apex:variable value="{!0}" var="rowSubtotalGroup05ColumnQ" rendered="{!doSubtotal05 && RenderGroup05 && RenderColumnQ}"/>
<apex:variable value="{!0}" var="rowSubtotalGroup05ColumnR" rendered="{!doSubtotal05 && RenderGroup05 && RenderColumnR}"/>
<apex:variable value="{!0}" var="rowSubtotalGroup05ColumnS" rendered="{!doSubtotal05 && RenderGroup05 && RenderColumnS}"/>
<apex:variable value="{!0}" var="rowSubtotalGroup05ColumnT" rendered="{!doSubtotal05 && RenderGroup05 && RenderColumnT}"/>
<apex:variable value="{!0}" var="rowSubtotalGroup05ColumnU" rendered="{!doSubtotal05 && RenderGroup05 && RenderColumnU}"/>
<apex:variable value="{!0}" var="rowSubtotalGroup05ColumnV" rendered="{!doSubtotal05 && RenderGroup05 && RenderColumnV}"/>
<apex:variable value="{!0}" var="rowSubtotalGroup05ColumnW" rendered="{!doSubtotal05 && RenderGroup05 && RenderColumnW}"/>
<apex:variable value="{!0}" var="rowSubtotalGroup05ColumnX" rendered="{!doSubtotal05 && RenderGroup05 && RenderColumnX}"/>
<apex:variable value="{!0}" var="rowSubtotalGroup05ColumnY" rendered="{!doSubtotal05 && RenderGroup05 && RenderColumnY}"/>
<apex:variable value="{!0}" var="rowSubtotalGroup05ColumnZ" rendered="{!doSubtotal05 && RenderGroup05 && RenderColumnZ}"/>
</td></tr>
<!-- Do we want to process a (mid-row) subtotal line for Group04? -->
<apex:variable var="doSubtotal04" value="{!RenderGroupSubtotals && !firstLine && (currentLineGroup02!=previousLineGroup02 || currentLineGroup03!=previousLineGroup03|| currentLineGroup04!=previousLineGroup04)}"/>
<!-- Display Subtotals if Group04 is rendered -->
<!-- Set calculated values as variables (for ease of use) -->
<apex:variable value="{!(rowSubtotalGroup04ColumnA-rowSubtotalGroup04ColumnB)}" var="rowSubtotalGroup04VarianceAB"/>
<apex:variable value="{!(rowSubtotalGroup04ColumnC-rowSubtotalGroup04ColumnD)}" var="rowSubtotalGroup04VarianceCD"/>
<apex:variable value="{!if(rowSubtotalGroup04ColumnB=0,(if(rowSubtotalGroup04ColumnA=0,0,(rowSubtotalGroup04VarianceAB/rowSubtotalGroup04ColumnA))),(rowSubtotalGroup04VarianceAB/rowSubtotalGroup04ColumnB))}" var="rowSubtotalGroup04VariancePercAB"/>
<apex:variable value="{!if(rowSubtotalGroup04ColumnD=0,(if(rowSubtotalGroup04ColumnC=0,0,(rowSubtotalGroup04VarianceCD/rowSubtotalGroup04ColumnC))),(rowSubtotalGroup04VarianceCD/rowSubtotalGroup04ColumnD))}" var="rowSubtotalGroup04VariancePercCD"/>
<tr>
<!-- Display the group-group values but not the group-line values -->
<td class="{!if(doSubtotal04 && RenderGroup04,'ffrsubtotallabeld','ffrsubtotalhidden')}" colspan="11">
<apex:outputPanel layout="none" rendered="{!doSubtotal04 && RenderGroup04}">{!previousLineGroup04}</apex:outputPanel></td>
<td class="{!if(doSubtotal04 && RenderGroup04,'ffrgridspacerd','ffrsubtotalhidden')}"></td>
<td class="{!if(doSubtotal04 && RenderGroup04 && RenderColumnA,'ffrsubtotald','ffrsubtotalhidden')}"><apex:outputText value="{!if(rowSubtotalGroup04ColumnA==0,VZ,RowNumberPattern)}" rendered="{!doSubtotal04 && RenderGroup04 && RenderColumnA}"><apex:param value="{!rowSubtotalGroup04ColumnA}"/></apex:outputText></td>
<td class="{!if(doSubtotal04 && RenderGroup04 && RenderColumnB,'ffrsubtotald','ffrsubtotalhidden')}"><apex:outputText value="{!if(rowSubtotalGroup04ColumnB==0,VZ,RowNumberPattern)}" rendered="{!doSubtotal04 && RenderGroup04 && RenderColumnB}"><apex:param value="{!rowSubtotalGroup04ColumnB}"/></apex:outputText></td>
<!--<td class="{!if(doSubtotal04 && RenderGroup04 && RenderColumnA && RenderColumnB,'ffrsubtotald','ffrsubtotalhidden')}"><apex:outputText value="{!if(rowSubtotalGroup04VarianceAB==0,VZ,RowNumberPattern)}" rendered="{!doSubtotal04 && RenderGroup04 && RenderColumnA && RenderColumnB}"><apex:param value="{!rowSubtotalGroup04VarianceAB}"/></apex:outputText></td>
<td class="{!if(doSubtotal04 && RenderGroup04 && RenderColumnA && RenderColumnB,'ffrsubtotald','ffrsubtotalhidden')}"><apex:outputText value="{!if(rowSubtotalGroup04VariancePercAB==0,PZ,RowPercentagePattern)}" rendered="{!doSubtotal04 && RenderGroup04 && RenderColumnA && RenderColumnB}"><apex:param value="{!rowSubtotalGroup04VariancePercAB}"/></apex:outputText></td> -->
<td class="{!if(doSubtotal04 && RenderGroup04 && RenderColumnC,'ffrsubtotald','ffrsubtotalhidden')}"><apex:outputText value="{!if(rowSubtotalGroup04ColumnC==0,VZ,RowNumberPattern)}" rendered="{!doSubtotal04 && RenderGroup04 && RenderColumnC}"><apex:param value="{!rowSubtotalGroup04ColumnC}"/></apex:outputText></td>
<td class="{!if(doSubtotal04 && RenderGroup04 && RenderColumnD,'ffrsubtotald','ffrsubtotalhidden')}"><apex:outputText value="{!if(rowSubtotalGroup04ColumnD==0,VZ,RowNumberPattern)}" rendered="{!doSubtotal04 && RenderGroup04 && RenderColumnD}"><apex:param value="{!rowSubtotalGroup04ColumnD}"/></apex:outputText></td>
<!--<td class="{!if(doSubtotal04 && RenderGroup04 && RenderColumnC && RenderColumnD,'ffrsubtotald','ffrsubtotalhidden')}"><apex:outputText value="{!if(rowSubtotalGroup04VarianceCD==0,VZ,RowNumberPattern)}" rendered="{!doSubtotal04 && RenderGroup04 && RenderColumnC && RenderColumnD}"><apex:param value="{!rowSubtotalGroup04VarianceCD}"/></apex:outputText></td>
<td class="{!if(doSubtotal04 && RenderGroup04 && RenderColumnC && RenderColumnD,'ffrsubtotald','ffrsubtotalhidden')}"><apex:outputText value="{!if(rowSubtotalGroup04VariancePercCD==0,PZ,RowPercentagePattern)}" rendered="{!doSubtotal04 && RenderGroup04 && RenderColumnC && RenderColumnD}"><apex:param value="{!rowSubtotalGroup04VariancePercCD}"/></apex:outputText></td>-->
<!--Standard lines from this area of the template-->
<td class="{!if(doSubtotal04 && RenderGroup04 && RenderColumnE,'ffrsubtotald','ffrsubtotalhidden')}"><apex:outputText value="{!if(rowSubtotalGroup04ColumnE==0,VZ,RowNumberPattern)}" rendered="{!doSubtotal04 && RenderGroup04 && RenderColumnE}"><apex:param value="{!rowSubtotalGroup04ColumnE}"/></apex:outputText></td>
<td class="{!if(doSubtotal04 && RenderGroup04 && RenderColumnF,'ffrsubtotald','ffrsubtotalhidden')}"><apex:outputText value="{!if(rowSubtotalGroup04ColumnF==0,VZ,RowNumberPattern)}" rendered="{!doSubtotal04 && RenderGroup04 && RenderColumnF}"><apex:param value="{!rowSubtotalGroup04ColumnF}"/></apex:outputText></td>
<td class="{!if(doSubtotal04 && RenderGroup04 && RenderColumnG,'ffrsubtotald','ffrsubtotalhidden')}"><apex:outputText value="{!if(rowSubtotalGroup04ColumnG==0,VZ,RowNumberPattern)}" rendered="{!doSubtotal04 && RenderGroup04 && RenderColumnG}"><apex:param value="{!rowSubtotalGroup04ColumnG}"/></apex:outputText></td>
<td class="{!if(doSubtotal04 && RenderGroup04 && RenderColumnH,'ffrsubtotald','ffrsubtotalhidden')}"><apex:outputText value="{!if(rowSubtotalGroup04ColumnH==0,VZ,RowNumberPattern)}" rendered="{!doSubtotal04 && RenderGroup04 && RenderColumnH}"><apex:param value="{!rowSubtotalGroup04ColumnH}"/></apex:outputText></td>
<td class="{!if(doSubtotal04 && RenderGroup04 && RenderColumnI,'ffrsubtotald','ffrsubtotalhidden')}"><apex:outputText value="{!if(rowSubtotalGroup04ColumnI==0,VZ,RowNumberPattern)}" rendered="{!doSubtotal04 && RenderGroup04 && RenderColumnI}"><apex:param value="{!rowSubtotalGroup04ColumnI}"/></apex:outputText></td>
<td class="{!if(doSubtotal04 && RenderGroup04 && RenderColumnJ,'ffrsubtotald','ffrsubtotalhidden')}"><apex:outputText value="{!if(rowSubtotalGroup04ColumnJ==0,VZ,RowNumberPattern)}" rendered="{!doSubtotal04 && RenderGroup04 && RenderColumnJ}"><apex:param value="{!rowSubtotalGroup04ColumnJ}"/></apex:outputText></td>
<td class="{!if(doSubtotal04 && RenderGroup04 && RenderColumnK,'ffrsubtotald','ffrsubtotalhidden')}"><apex:outputText value="{!if(rowSubtotalGroup04ColumnK==0,VZ,RowNumberPattern)}" rendered="{!doSubtotal04 && RenderGroup04 && RenderColumnK}"><apex:param value="{!rowSubtotalGroup04ColumnK}"/></apex:outputText></td>
<td class="{!if(doSubtotal04 && RenderGroup04 && RenderColumnL,'ffrsubtotald','ffrsubtotalhidden')}"><apex:outputText value="{!if(rowSubtotalGroup04ColumnL==0,VZ,RowNumberPattern)}" rendered="{!doSubtotal04 && RenderGroup04 && RenderColumnL}"><apex:param value="{!rowSubtotalGroup04ColumnL}"/></apex:outputText></td>
<td class="{!if(doSubtotal04 && RenderGroup04 && RenderColumnM,'ffrsubtotald','ffrsubtotalhidden')}"><apex:outputText value="{!if(rowSubtotalGroup04ColumnM==0,VZ,RowNumberPattern)}" rendered="{!doSubtotal04 && RenderGroup04 && RenderColumnM}"><apex:param value="{!rowSubtotalGroup04ColumnM}"/></apex:outputText></td>
<td class="{!if(doSubtotal04 && RenderGroup04 && RenderColumnN,'ffrsubtotald','ffrsubtotalhidden')}"><apex:outputText value="{!if(rowSubtotalGroup04ColumnN==0,VZ,RowNumberPattern)}" rendered="{!doSubtotal04 && RenderGroup04 && RenderColumnN}"><apex:param value="{!rowSubtotalGroup04ColumnN}"/></apex:outputText></td>
<td class="{!if(doSubtotal04 && RenderGroup04 && RenderColumnO,'ffrsubtotald','ffrsubtotalhidden')}"><apex:outputText value="{!if(rowSubtotalGroup04ColumnO==0,VZ,RowNumberPattern)}" rendered="{!doSubtotal04 && RenderGroup04 && RenderColumnO}"><apex:param value="{!rowSubtotalGroup04ColumnO}"/></apex:outputText></td>
<td class="{!if(doSubtotal04 && RenderGroup04 && RenderColumnP,'ffrsubtotald','ffrsubtotalhidden')}"><apex:outputText value="{!if(rowSubtotalGroup04ColumnP==0,VZ,RowNumberPattern)}" rendered="{!doSubtotal04 && RenderGroup04 && RenderColumnP}"><apex:param value="{!rowSubtotalGroup04ColumnP}"/></apex:outputText></td>
<td class="{!if(doSubtotal04 && RenderGroup04 && RenderColumnQ,'ffrsubtotald','ffrsubtotalhidden')}"><apex:outputText value="{!if(rowSubtotalGroup04ColumnQ==0,VZ,RowNumberPattern)}" rendered="{!doSubtotal04 && RenderGroup04 && RenderColumnQ}"><apex:param value="{!rowSubtotalGroup04ColumnQ}"/></apex:outputText></td>
<td class="{!if(doSubtotal04 && RenderGroup04 && RenderColumnR,'ffrsubtotald','ffrsubtotalhidden')}"><apex:outputText value="{!if(rowSubtotalGroup04ColumnR==0,VZ,RowNumberPattern)}" rendered="{!doSubtotal04 && RenderGroup04 && RenderColumnR}"><apex:param value="{!rowSubtotalGroup04ColumnR}"/></apex:outputText></td>
<td class="{!if(doSubtotal04 && RenderGroup04 && RenderColumnS,'ffrsubtotald','ffrsubtotalhidden')}"><apex:outputText value="{!if(rowSubtotalGroup04ColumnS==0,VZ,RowNumberPattern)}" rendered="{!doSubtotal04 && RenderGroup04 && RenderColumnS}"><apex:param value="{!rowSubtotalGroup04ColumnS}"/></apex:outputText></td>
<td class="{!if(doSubtotal04 && RenderGroup04 && RenderColumnT,'ffrsubtotald','ffrsubtotalhidden')}"><apex:outputText value="{!if(rowSubtotalGroup04ColumnT==0,VZ,RowNumberPattern)}" rendered="{!doSubtotal04 && RenderGroup04 && RenderColumnT}"><apex:param value="{!rowSubtotalGroup04ColumnT}"/></apex:outputText></td>
<td class="{!if(doSubtotal04 && RenderGroup04 && RenderColumnU,'ffrsubtotald','ffrsubtotalhidden')}"><apex:outputText value="{!if(rowSubtotalGroup04ColumnU==0,VZ,RowNumberPattern)}" rendered="{!doSubtotal04 && RenderGroup04 && RenderColumnU}"><apex:param value="{!rowSubtotalGroup04ColumnU}"/></apex:outputText></td>
<td class="{!if(doSubtotal04 && RenderGroup04 && RenderColumnV,'ffrsubtotald','ffrsubtotalhidden')}"><apex:outputText value="{!if(rowSubtotalGroup04ColumnV==0,VZ,RowNumberPattern)}" rendered="{!doSubtotal04 && RenderGroup04 && RenderColumnV}"><apex:param value="{!rowSubtotalGroup04ColumnV}"/></apex:outputText></td>
<td class="{!if(doSubtotal04 && RenderGroup04 && RenderColumnW,'ffrsubtotald','ffrsubtotalhidden')}"><apex:outputText value="{!if(rowSubtotalGroup04ColumnW==0,VZ,RowNumberPattern)}" rendered="{!doSubtotal04 && RenderGroup04 && RenderColumnW}"><apex:param value="{!rowSubtotalGroup04ColumnW}"/></apex:outputText></td>
<td class="{!if(doSubtotal04 && RenderGroup04 && RenderColumnX,'ffrsubtotald','ffrsubtotalhidden')}"><apex:outputText value="{!if(rowSubtotalGroup04ColumnX==0,VZ,RowNumberPattern)}" rendered="{!doSubtotal04 && RenderGroup04 && RenderColumnX}"><apex:param value="{!rowSubtotalGroup04ColumnX}"/></apex:outputText></td>
<td class="{!if(doSubtotal04 && RenderGroup04 && RenderColumnY,'ffrsubtotald','ffrsubtotalhidden')}"><apex:outputText value="{!if(rowSubtotalGroup04ColumnY==0,VZ,RowNumberPattern)}" rendered="{!doSubtotal04 && RenderGroup04 && RenderColumnY}"><apex:param value="{!rowSubtotalGroup04ColumnY}"/></apex:outputText></td>
<td class="{!if(doSubtotal04 && RenderGroup04 && RenderColumnZ,'ffrsubtotald','ffrsubtotalhidden')}"><apex:outputText value="{!if(rowSubtotalGroup04ColumnZ==0,VZ,RowNumberPattern)}" rendered="{!doSubtotal04 && RenderGroup04 && RenderColumnZ}"><apex:param value="{!rowSubtotalGroup04ColumnZ}"/></apex:outputText></td>
</tr>
<!-- Reset the subtotals for Group04 -->
<tr><td class="ffrhidden">
<apex:variable value="{!0}" var="rowSubtotalGroup04ColumnA" rendered="{!doSubtotal04 && RenderGroup04 && RenderColumnA}"/>
<apex:variable value="{!0}" var="rowSubtotalGroup04ColumnB" rendered="{!doSubtotal04 && RenderGroup04 && RenderColumnB}"/>
<apex:variable value="{!0}" var="rowSubtotalGroup04ColumnC" rendered="{!doSubtotal04 && RenderGroup04 && RenderColumnC}"/>
<apex:variable value="{!0}" var="rowSubtotalGroup04ColumnD" rendered="{!doSubtotal04 && RenderGroup04 && RenderColumnD}"/>
<apex:variable value="{!0}" var="rowSubtotalGroup04ColumnE" rendered="{!doSubtotal04 && RenderGroup04 && RenderColumnE}"/>
<apex:variable value="{!0}" var="rowSubtotalGroup04ColumnF" rendered="{!doSubtotal04 && RenderGroup04 && RenderColumnF}"/>
<apex:variable value="{!0}" var="rowSubtotalGroup04ColumnG" rendered="{!doSubtotal04 && RenderGroup04 && RenderColumnG}"/>
<apex:variable value="{!0}" var="rowSubtotalGroup04ColumnH" rendered="{!doSubtotal04 && RenderGroup04 && RenderColumnH}"/>
<apex:variable value="{!0}" var="rowSubtotalGroup04ColumnI" rendered="{!doSubtotal04 && RenderGroup04 && RenderColumnI}"/>
<apex:variable value="{!0}" var="rowSubtotalGroup04ColumnJ" rendered="{!doSubtotal04 && RenderGroup04 && RenderColumnJ}"/>
<apex:variable value="{!0}" var="rowSubtotalGroup04ColumnK" rendered="{!doSubtotal04 && RenderGroup04 && RenderColumnK}"/>
<apex:variable value="{!0}" var="rowSubtotalGroup04ColumnL" rendered="{!doSubtotal04 && RenderGroup04 && RenderColumnL}"/>
<apex:variable value="{!0}" var="rowSubtotalGroup04ColumnM" rendered="{!doSubtotal04 && RenderGroup04 && RenderColumnM}"/>
<apex:variable value="{!0}" var="rowSubtotalGroup04ColumnN" rendered="{!doSubtotal04 && RenderGroup04 && RenderColumnN}"/>
<apex:variable value="{!0}" var="rowSubtotalGroup04ColumnO" rendered="{!doSubtotal04 && RenderGroup04 && RenderColumnO}"/>
<apex:variable value="{!0}" var="rowSubtotalGroup04ColumnP" rendered="{!doSubtotal04 && RenderGroup04 && RenderColumnP}"/>
<apex:variable value="{!0}" var="rowSubtotalGroup04ColumnQ" rendered="{!doSubtotal04 && RenderGroup04 && RenderColumnQ}"/>
<apex:variable value="{!0}" var="rowSubtotalGroup04ColumnR" rendered="{!doSubtotal04 && RenderGroup04 && RenderColumnR}"/>
<apex:variable value="{!0}" var="rowSubtotalGroup04ColumnS" rendered="{!doSubtotal04 && RenderGroup04 && RenderColumnS}"/>
<apex:variable value="{!0}" var="rowSubtotalGroup04ColumnT" rendered="{!doSubtotal04 && RenderGroup04 && RenderColumnT}"/>
<apex:variable value="{!0}" var="rowSubtotalGroup04ColumnU" rendered="{!doSubtotal04 && RenderGroup04 && RenderColumnU}"/>
<apex:variable value="{!0}" var="rowSubtotalGroup04ColumnV" rendered="{!doSubtotal04 && RenderGroup04 && RenderColumnV}"/>
<apex:variable value="{!0}" var="rowSubtotalGroup04ColumnW" rendered="{!doSubtotal04 && RenderGroup04 && RenderColumnW}"/>
<apex:variable value="{!0}" var="rowSubtotalGroup04ColumnX" rendered="{!doSubtotal04 && RenderGroup04 && RenderColumnX}"/>
<apex:variable value="{!0}" var="rowSubtotalGroup04ColumnY" rendered="{!doSubtotal04 && RenderGroup04 && RenderColumnY}"/>
<apex:variable value="{!0}" var="rowSubtotalGroup04ColumnZ" rendered="{!doSubtotal04 && RenderGroup04 && RenderColumnZ}"/>
</td></tr>
<!-- Do we want to process a (mid-row) subtotal line for Group03? -->
<apex:variable var="doSubtotal03" value="{!RenderGroupSubtotals && !firstLine && (currentLineGroup02!=previousLineGroup02 || currentLineGroup03!=previousLineGroup03)}"/>
<!-- Display Subtotals if Group03 is rendered -->
<!-- Set calculated values as variables (for ease of use) -->
<apex:variable value="{!(rowSubtotalGroup03ColumnA-rowSubtotalGroup03ColumnB)}" var="rowSubtotalGroup03VarianceAB"/>
<apex:variable value="{!(rowSubtotalGroup03ColumnC-rowSubtotalGroup03ColumnD)}" var="rowSubtotalGroup03VarianceCD"/>
<apex:variable value="{!if(rowSubtotalGroup03ColumnB=0,(if(rowSubtotalGroup03ColumnA=0,0,(rowSubtotalGroup03VarianceAB/rowSubtotalGroup03ColumnA))),(rowSubtotalGroup03VarianceAB/rowSubtotalGroup03ColumnB))}" var="rowSubtotalGroup03VariancePercAB"/>
<apex:variable value="{!if(rowSubtotalGroup03ColumnD=0,(if(rowSubtotalGroup03ColumnC=0,0,(rowSubtotalGroup03VarianceCD/rowSubtotalGroup03ColumnC))),(rowSubtotalGroup03VarianceCD/rowSubtotalGroup03ColumnD))}" var="rowSubtotalGroup03VariancePercCD"/>
<tr>
<!-- Display the group-group values but not the group-line values -->
<td class="{!if(doSubtotal03 && RenderGroup03,'ffrsubtotallabeld','ffrsubtotalhidden')}" colspan="11">
<apex:outputPanel layout="none" rendered="{!doSubtotal03 && RenderGroup03}">{!previousLineGroup03}</apex:outputPanel></td>
<td class="{!if(doSubtotal03 && RenderGroup03,'ffrgridspacerd','ffrsubtotalhidden')}"></td>
<td class="{!if(doSubtotal03 && RenderGroup03 && RenderColumnA,'ffrsubtotald','ffrsubtotalhidden')}"><apex:outputText value="{!if(rowSubtotalGroup03ColumnA==0,VZ,RowNumberPattern)}" rendered="{!doSubtotal03 && RenderGroup03 && RenderColumnA}"><apex:param value="{!rowSubtotalGroup03ColumnA}"/></apex:outputText></td>
<td class="{!if(doSubtotal03 && RenderGroup03 && RenderColumnB,'ffrsubtotald','ffrsubtotalhidden')}"><apex:outputText value="{!if(rowSubtotalGroup03ColumnB==0,VZ,RowNumberPattern)}" rendered="{!doSubtotal03 && RenderGroup03 && RenderColumnB}"><apex:param value="{!rowSubtotalGroup03ColumnB}"/></apex:outputText></td>
<!--<td class="{!if(doSubtotal03 && RenderGroup03 && RenderColumnA && RenderColumnB,'ffrsubtotald','ffrsubtotalhidden')}"><apex:outputText value="{!if(rowSubtotalGroup03VarianceAB==0,VZ,RowNumberPattern)}" rendered="{!doSubtotal03 && RenderGroup03 && RenderColumnA && RenderColumnB}"><apex:param value="{!rowSubtotalGroup03VarianceAB}"/></apex:outputText></td>
<td class="{!if(doSubtotal03 && RenderGroup03 && RenderColumnA && RenderColumnB,'ffrsubtotald','ffrsubtotalhidden')}"><apex:outputText value="{!if(rowSubtotalGroup03VariancePercAB==0,PZ,RowPercentagePattern)}" rendered="{!doSubtotal03 && RenderGroup03 && RenderColumnA && RenderColumnB}"><apex:param value="{!rowSubtotalGroup03VariancePercAB}"/></apex:outputText></td> -->
<td class="{!if(doSubtotal03 && RenderGroup03 && RenderColumnC,'ffrsubtotald','ffrsubtotalhidden')}"><apex:outputText value="{!if(rowSubtotalGroup03ColumnC==0,VZ,RowNumberPattern)}" rendered="{!doSubtotal03 && RenderGroup03 && RenderColumnC}"><apex:param value="{!rowSubtotalGroup03ColumnC}"/></apex:outputText></td>
<td class="{!if(doSubtotal03 && RenderGroup03 && RenderColumnD,'ffrsubtotald','ffrsubtotalhidden')}"><apex:outputText value="{!if(rowSubtotalGroup03ColumnD==0,VZ,RowNumberPattern)}" rendered="{!doSubtotal03 && RenderGroup03 && RenderColumnD}"><apex:param value="{!rowSubtotalGroup03ColumnD}"/></apex:outputText></td>
<!--<td class="{!if(doSubtotal03 && RenderGroup03 && RenderColumnC && RenderColumnD,'ffrsubtotald','ffrsubtotalhidden')}"><apex:outputText value="{!if(rowSubtotalGroup03VarianceCD==0,VZ,RowNumberPattern)}" rendered="{!doSubtotal03 && RenderGroup03 && RenderColumnC && RenderColumnD}"><apex:param value="{!rowSubtotalGroup03VarianceCD}"/></apex:outputText></td>
<td class="{!if(doSubtotal03 && RenderGroup03 && RenderColumnC && RenderColumnD,'ffrsubtotald','ffrsubtotalhidden')}"><apex:outputText value="{!if(rowSubtotalGroup03VariancePercCD==0,PZ,RowPercentagePattern)}" rendered="{!doSubtotal03 && RenderGroup03 && RenderColumnC && RenderColumnD}"><apex:param value="{!rowSubtotalGroup03VariancePercCD}"/></apex:outputText></td> -->
<!--Standard lines from this area of the template-->
<td class="{!if(doSubtotal03 && RenderGroup03 && RenderColumnE,'ffrsubtotald','ffrsubtotalhidden')}"><apex:outputText value="{!if(rowSubtotalGroup03ColumnE==0,VZ,RowNumberPattern)}" rendered="{!doSubtotal03 && RenderGroup03 && RenderColumnE}"><apex:param value="{!rowSubtotalGroup03ColumnE}"/></apex:outputText></td>
<td class="{!if(doSubtotal03 && RenderGroup03 && RenderColumnF,'ffrsubtotald','ffrsubtotalhidden')}"><apex:outputText value="{!if(rowSubtotalGroup03ColumnF==0,VZ,RowNumberPattern)}" rendered="{!doSubtotal03 && RenderGroup03 && RenderColumnF}"><apex:param value="{!rowSubtotalGroup03ColumnF}"/></apex:outputText></td>
<td class="{!if(doSubtotal03 && RenderGroup03 && RenderColumnG,'ffrsubtotald','ffrsubtotalhidden')}"><apex:outputText value="{!if(rowSubtotalGroup03ColumnG==0,VZ,RowNumberPattern)}" rendered="{!doSubtotal03 && RenderGroup03 && RenderColumnG}"><apex:param value="{!rowSubtotalGroup03ColumnG}"/></apex:outputText></td>
<td class="{!if(doSubtotal03 && RenderGroup03 && RenderColumnH,'ffrsubtotald','ffrsubtotalhidden')}"><apex:outputText value="{!if(rowSubtotalGroup03ColumnH==0,VZ,RowNumberPattern)}" rendered="{!doSubtotal03 && RenderGroup03 && RenderColumnH}"><apex:param value="{!rowSubtotalGroup03ColumnH}"/></apex:outputText></td>
<td class="{!if(doSubtotal03 && RenderGroup03 && RenderColumnI,'ffrsubtotald','ffrsubtotalhidden')}"><apex:outputText value="{!if(rowSubtotalGroup03ColumnI==0,VZ,RowNumberPattern)}" rendered="{!doSubtotal03 && RenderGroup03 && RenderColumnI}"><apex:param value="{!rowSubtotalGroup03ColumnI}"/></apex:outputText></td>
<td class="{!if(doSubtotal03 && RenderGroup03 && RenderColumnJ,'ffrsubtotald','ffrsubtotalhidden')}"><apex:outputText value="{!if(rowSubtotalGroup03ColumnJ==0,VZ,RowNumberPattern)}" rendered="{!doSubtotal03 && RenderGroup03 && RenderColumnJ}"><apex:param value="{!rowSubtotalGroup03ColumnJ}"/></apex:outputText></td>
<td class="{!if(doSubtotal03 && RenderGroup03 && RenderColumnK,'ffrsubtotald','ffrsubtotalhidden')}"><apex:outputText value="{!if(rowSubtotalGroup03ColumnK==0,VZ,RowNumberPattern)}" rendered="{!doSubtotal03 && RenderGroup03 && RenderColumnK}"><apex:param value="{!rowSubtotalGroup03ColumnK}"/></apex:outputText></td>
<td class="{!if(doSubtotal03 && RenderGroup03 && RenderColumnL,'ffrsubtotald','ffrsubtotalhidden')}"><apex:outputText value="{!if(rowSubtotalGroup03ColumnL==0,VZ,RowNumberPattern)}" rendered="{!doSubtotal03 && RenderGroup03 && RenderColumnL}"><apex:param value="{!rowSubtotalGroup03ColumnL}"/></apex:outputText></td>
<td class="{!if(doSubtotal03 && RenderGroup03 && RenderColumnM,'ffrsubtotald','ffrsubtotalhidden')}"><apex:outputText value="{!if(rowSubtotalGroup03ColumnM==0,VZ,RowNumberPattern)}" rendered="{!doSubtotal03 && RenderGroup03 && RenderColumnM}"><apex:param value="{!rowSubtotalGroup03ColumnM}"/></apex:outputText></td>
<td class="{!if(doSubtotal03 && RenderGroup03 && RenderColumnN,'ffrsubtotald','ffrsubtotalhidden')}"><apex:outputText value="{!if(rowSubtotalGroup03ColumnN==0,VZ,RowNumberPattern)}" rendered="{!doSubtotal03 && RenderGroup03 && RenderColumnN}"><apex:param value="{!rowSubtotalGroup03ColumnN}"/></apex:outputText></td>
<td class="{!if(doSubtotal03 && RenderGroup03 && RenderColumnO,'ffrsubtotald','ffrsubtotalhidden')}"><apex:outputText value="{!if(rowSubtotalGroup03ColumnO==0,VZ,RowNumberPattern)}" rendered="{!doSubtotal03 && RenderGroup03 && RenderColumnO}"><apex:param value="{!rowSubtotalGroup03ColumnO}"/></apex:outputText></td>
<td class="{!if(doSubtotal03 && RenderGroup03 && RenderColumnP,'ffrsubtotald','ffrsubtotalhidden')}"><apex:outputText value="{!if(rowSubtotalGroup03ColumnP==0,VZ,RowNumberPattern)}" rendered="{!doSubtotal03 && RenderGroup03 && RenderColumnP}"><apex:param value="{!rowSubtotalGroup03ColumnP}"/></apex:outputText></td>
<td class="{!if(doSubtotal03 && RenderGroup03 && RenderColumnQ,'ffrsubtotald','ffrsubtotalhidden')}"><apex:outputText value="{!if(rowSubtotalGroup03ColumnQ==0,VZ,RowNumberPattern)}" rendered="{!doSubtotal03 && RenderGroup03 && RenderColumnQ}"><apex:param value="{!rowSubtotalGroup03ColumnQ}"/></apex:outputText></td>
<td class="{!if(doSubtotal03 && RenderGroup03 && RenderColumnR,'ffrsubtotald','ffrsubtotalhidden')}"><apex:outputText value="{!if(rowSubtotalGroup03ColumnR==0,VZ,RowNumberPattern)}" rendered="{!doSubtotal03 && RenderGroup03 && RenderColumnR}"><apex:param value="{!rowSubtotalGroup03ColumnR}"/></apex:outputText></td>
<td class="{!if(doSubtotal03 && RenderGroup03 && RenderColumnS,'ffrsubtotald','ffrsubtotalhidden')}"><apex:outputText value="{!if(rowSubtotalGroup03ColumnS==0,VZ,RowNumberPattern)}" rendered="{!doSubtotal03 && RenderGroup03 && RenderColumnS}"><apex:param value="{!rowSubtotalGroup03ColumnS}"/></apex:outputText></td>
<td class="{!if(doSubtotal03 && RenderGroup03 && RenderColumnT,'ffrsubtotald','ffrsubtotalhidden')}"><apex:outputText value="{!if(rowSubtotalGroup03ColumnT==0,VZ,RowNumberPattern)}" rendered="{!doSubtotal03 && RenderGroup03 && RenderColumnT}"><apex:param value="{!rowSubtotalGroup03ColumnT}"/></apex:outputText></td>
<td class="{!if(doSubtotal03 && RenderGroup03 && RenderColumnU,'ffrsubtotald','ffrsubtotalhidden')}"><apex:outputText value="{!if(rowSubtotalGroup03ColumnU==0,VZ,RowNumberPattern)}" rendered="{!doSubtotal03 && RenderGroup03 && RenderColumnU}"><apex:param value="{!rowSubtotalGroup03ColumnU}"/></apex:outputText></td>
<td class="{!if(doSubtotal03 && RenderGroup03 && RenderColumnV,'ffrsubtotald','ffrsubtotalhidden')}"><apex:outputText value="{!if(rowSubtotalGroup03ColumnV==0,VZ,RowNumberPattern)}" rendered="{!doSubtotal03 && RenderGroup03 && RenderColumnV}"><apex:param value="{!rowSubtotalGroup03ColumnV}"/></apex:outputText></td>
<td class="{!if(doSubtotal03 && RenderGroup03 && RenderColumnW,'ffrsubtotald','ffrsubtotalhidden')}"><apex:outputText value="{!if(rowSubtotalGroup03ColumnW==0,VZ,RowNumberPattern)}" rendered="{!doSubtotal03 && RenderGroup03 && RenderColumnW}"><apex:param value="{!rowSubtotalGroup03ColumnW}"/></apex:outputText></td>
<td class="{!if(doSubtotal03 && RenderGroup03 && RenderColumnX,'ffrsubtotald','ffrsubtotalhidden')}"><apex:outputText value="{!if(rowSubtotalGroup03ColumnX==0,VZ,RowNumberPattern)}" rendered="{!doSubtotal03 && RenderGroup03 && RenderColumnX}"><apex:param value="{!rowSubtotalGroup03ColumnX}"/></apex:outputText></td>
<td class="{!if(doSubtotal03 && RenderGroup03 && RenderColumnY,'ffrsubtotald','ffrsubtotalhidden')}"><apex:outputText value="{!if(rowSubtotalGroup03ColumnY==0,VZ,RowNumberPattern)}" rendered="{!doSubtotal03 && RenderGroup03 && RenderColumnY}"><apex:param value="{!rowSubtotalGroup03ColumnY}"/></apex:outputText></td>
<td class="{!if(doSubtotal03 && RenderGroup03 && RenderColumnZ,'ffrsubtotald','ffrsubtotalhidden')}"><apex:outputText value="{!if(rowSubtotalGroup03ColumnZ==0,VZ,RowNumberPattern)}" rendered="{!doSubtotal03 && RenderGroup03 && RenderColumnZ}"><apex:param value="{!rowSubtotalGroup03ColumnZ}"/></apex:outputText></td>
</tr>
<!-- Reset the subtotals for Group03 -->
<tr><td class="ffrhidden">
<apex:variable value="{!0}" var="rowSubtotalGroup03ColumnA" rendered="{!doSubtotal03 && RenderGroup03 && RenderColumnA}"/>
<apex:variable value="{!0}" var="rowSubtotalGroup03ColumnB" rendered="{!doSubtotal03 && RenderGroup03 && RenderColumnB}"/>
<apex:variable value="{!0}" var="rowSubtotalGroup03ColumnC" rendered="{!doSubtotal03 && RenderGroup03 && RenderColumnC}"/>
<apex:variable value="{!0}" var="rowSubtotalGroup03ColumnD" rendered="{!doSubtotal03 && RenderGroup03 && RenderColumnD}"/>
<apex:variable value="{!0}" var="rowSubtotalGroup03ColumnE" rendered="{!doSubtotal03 && RenderGroup03 && RenderColumnE}"/>
<apex:variable value="{!0}" var="rowSubtotalGroup03ColumnF" rendered="{!doSubtotal03 && RenderGroup03 && RenderColumnF}"/>
<apex:variable value="{!0}" var="rowSubtotalGroup03ColumnG" rendered="{!doSubtotal03 && RenderGroup03 && RenderColumnG}"/>
<apex:variable value="{!0}" var="rowSubtotalGroup03ColumnH" rendered="{!doSubtotal03 && RenderGroup03 && RenderColumnH}"/>
<apex:variable value="{!0}" var="rowSubtotalGroup03ColumnI" rendered="{!doSubtotal03 && RenderGroup03 && RenderColumnI}"/>
<apex:variable value="{!0}" var="rowSubtotalGroup03ColumnJ" rendered="{!doSubtotal03 && RenderGroup03 && RenderColumnJ}"/>
<apex:variable value="{!0}" var="rowSubtotalGroup03ColumnK" rendered="{!doSubtotal03 && RenderGroup03 && RenderColumnK}"/>
<apex:variable value="{!0}" var="rowSubtotalGroup03ColumnL" rendered="{!doSubtotal03 && RenderGroup03 && RenderColumnL}"/>
<apex:variable value="{!0}" var="rowSubtotalGroup03ColumnM" rendered="{!doSubtotal03 && RenderGroup03 && RenderColumnM}"/>
<apex:variable value="{!0}" var="rowSubtotalGroup03ColumnN" rendered="{!doSubtotal03 && RenderGroup03 && RenderColumnN}"/>
<apex:variable value="{!0}" var="rowSubtotalGroup03ColumnO" rendered="{!doSubtotal03 && RenderGroup03 && RenderColumnO}"/>
<apex:variable value="{!0}" var="rowSubtotalGroup03ColumnP" rendered="{!doSubtotal03 && RenderGroup03 && RenderColumnP}"/>
<apex:variable value="{!0}" var="rowSubtotalGroup03ColumnQ" rendered="{!doSubtotal03 && RenderGroup03 && RenderColumnQ}"/>
<apex:variable value="{!0}" var="rowSubtotalGroup03ColumnR" rendered="{!doSubtotal03 && RenderGroup03 && RenderColumnR}"/>
<apex:variable value="{!0}" var="rowSubtotalGroup03ColumnS" rendered="{!doSubtotal03 && RenderGroup03 && RenderColumnS}"/>
<apex:variable value="{!0}" var="rowSubtotalGroup03ColumnT" rendered="{!doSubtotal03 && RenderGroup03 && RenderColumnT}"/>
<apex:variable value="{!0}" var="rowSubtotalGroup03ColumnU" rendered="{!doSubtotal03 && RenderGroup03 && RenderColumnU}"/>
<apex:variable value="{!0}" var="rowSubtotalGroup03ColumnV" rendered="{!doSubtotal03 && RenderGroup03 && RenderColumnV}"/>
<apex:variable value="{!0}" var="rowSubtotalGroup03ColumnW" rendered="{!doSubtotal03 && RenderGroup03 && RenderColumnW}"/>
<apex:variable value="{!0}" var="rowSubtotalGroup03ColumnX" rendered="{!doSubtotal03 && RenderGroup03 && RenderColumnX}"/>
<apex:variable value="{!0}" var="rowSubtotalGroup03ColumnY" rendered="{!doSubtotal03 && RenderGroup03 && RenderColumnY}"/>
<apex:variable value="{!0}" var="rowSubtotalGroup03ColumnZ" rendered="{!doSubtotal03 && RenderGroup03 && RenderColumnZ}"/>
</td></tr>

<!-- Do we want to process a (mid-row) subtotal line for Group02? -->
<apex:variable var="doSubtotal02" value="{!RenderGroupSubtotals && !firstLine && (currentLineGroup02!=previousLineGroup02)}"/>
<!-- Display Subtotals if Group02 is rendered -->
<!-- Set calculated values as variables (for ease of use) -->
<apex:variable value="{!(rowSubtotalGroup02ColumnA-rowSubtotalGroup02ColumnB)}" var="rowSubtotalGroup02VarianceAB"/>
<apex:variable value="{!(rowSubtotalGroup02ColumnC-rowSubtotalGroup02ColumnD)}" var="rowSubtotalGroup02VarianceCD"/>
<apex:variable value="{!if(rowSubtotalGroup02ColumnB=0,(if(rowSubtotalGroup02ColumnA=0,0,(rowSubtotalGroup02VarianceAB/rowSubtotalGroup02ColumnA))),(rowSubtotalGroup02VarianceAB/rowSubtotalGroup02ColumnB))}" var="rowSubtotalGroup02VariancePercAB"/>
<apex:variable value="{!if(rowSubtotalGroup02ColumnD=0,(if(rowSubtotalGroup02ColumnC=0,0,(rowSubtotalGroup02VarianceCD/rowSubtotalGroup02ColumnC))),(rowSubtotalGroup02VarianceCD/rowSubtotalGroup02ColumnD))}" var="rowSubtotalGroup02VariancePercCD"/>
<tr>
<!-- Display the group-group values but not the group-line values -->
<td class="{!if(doSubtotal02 && RenderGroup02,'ffrsubtotallabeld','ffrsubtotalhidden')}" colspan="11" style="text-indent: 20px;">
<apex:outputPanel layout="none" rendered="{!doSubtotal02 && RenderGroup02}">Total {!previousLineGroup02}
</apex:outputPanel>
</td>
<td class="{!if(doSubtotal02 && RenderGroup02,'ffrgridspacerd','ffrsubtotalhidden')}"></td>
<td class="{!if(doSubtotal02 && RenderGroup02 && RenderColumnA,'ffrsubtotald','ffrsubtotalhidden')}"><apex:outputText value="{!if(rowSubtotalGroup02ColumnA==0,VZ,RowNumberPattern)}" rendered="{!doSubtotal02 && RenderGroup02 && RenderColumnA}"><apex:param value="{!rowSubtotalGroup02ColumnA}"/></apex:outputText></td>
<td class="{!if(doSubtotal02 && RenderGroup02 && RenderColumnB,'ffrsubtotald','ffrsubtotalhidden')}"><apex:outputText value="{!if(rowSubtotalGroup02ColumnB==0,VZ,RowNumberPattern)}" rendered="{!doSubtotal02 && RenderGroup02 && RenderColumnB}"><apex:param value="{!rowSubtotalGroup02ColumnB}"/></apex:outputText></td>
<!--<td class="{!if(doSubtotal02 && RenderGroup02 && RenderColumnA && RenderColumnB,'ffrsubtotald','ffrsubtotalhidden')}"><apex:outputText value="{!if(rowSubtotalGroup02VarianceAB==0,VZ,RowNumberPattern)}" rendered="{!doSubtotal02 && RenderGroup02 && RenderColumnA && RenderColumnB}"><apex:param value="{!rowSubtotalGroup02VarianceAB}"/></apex:outputText></td>
<td class="{!if(doSubtotal02 && RenderGroup02 && RenderColumnA && RenderColumnB,'ffrsubtotald','ffrsubtotalhidden')}"><apex:outputText value="{!if(rowSubtotalGroup02VariancePercAB==0,PZ,RowPercentagePattern)}" rendered="{!doSubtotal02 && RenderGroup02 && RenderColumnA && RenderColumnB}"><apex:param value="{!rowSubtotalGroup02VariancePercAB}"/></apex:outputText></td> -->
<td class="{!if(doSubtotal02 && RenderGroup02 && RenderColumnC,'ffrsubtotald','ffrsubtotalhidden')}"><apex:outputText value="{!if(rowSubtotalGroup02ColumnC==0,VZ,RowNumberPattern)}" rendered="{!doSubtotal02 && RenderGroup02 && RenderColumnC}"><apex:param value="{!rowSubtotalGroup02ColumnC}"/></apex:outputText></td>
<td class="{!if(doSubtotal02 && RenderGroup02 && RenderColumnD,'ffrsubtotald','ffrsubtotalhidden')}"><apex:outputText value="{!if(rowSubtotalGroup02ColumnD==0,VZ,RowNumberPattern)}" rendered="{!doSubtotal02 && RenderGroup02 && RenderColumnD}"><apex:param value="{!rowSubtotalGroup02ColumnD}"/></apex:outputText></td>
<!--<td class="{!if(doSubtotal02 && RenderGroup02 && RenderColumnC && RenderColumnD,'ffrsubtotald','ffrsubtotalhidden')}"><apex:outputText value="{!if(rowSubtotalGroup02VarianceCD==0,VZ,RowNumberPattern)}" rendered="{!doSubtotal02 && RenderGroup02 && RenderColumnC && RenderColumnD}"><apex:param value="{!rowSubtotalGroup02VarianceCD}"/></apex:outputText></td>
<td class="{!if(doSubtotal02 && RenderGroup02 && RenderColumnC && RenderColumnD,'ffrsubtotald','ffrsubtotalhidden')}"><apex:outputText value="{!if(rowSubtotalGroup02VariancePercCD==0,PZ,RowPercentagePattern)}" rendered="{!doSubtotal02 && RenderGroup02 && RenderColumnC && RenderColumnD}"><apex:param value="{!rowSubtotalGroup02VariancePercCD}"/></apex:outputText></td> -->
<!--Standard lines from this area of the template-->
<td class="{!if(doSubtotal02 && RenderGroup02 && RenderColumnE,'ffrsubtotald','ffrsubtotalhidden')}"><apex:outputText value="{!if(rowSubtotalGroup02ColumnE==0,VZ,RowNumberPattern)}" rendered="{!doSubtotal02 && RenderGroup02 && RenderColumnE}"><apex:param value="{!rowSubtotalGroup02ColumnE}"/></apex:outputText></td>
<td class="{!if(doSubtotal02 && RenderGroup02 && RenderColumnF,'ffrsubtotald','ffrsubtotalhidden')}"><apex:outputText value="{!if(rowSubtotalGroup02ColumnF==0,VZ,RowNumberPattern)}" rendered="{!doSubtotal02 && RenderGroup02 && RenderColumnF}"><apex:param value="{!rowSubtotalGroup02ColumnF}"/></apex:outputText></td>
<td class="{!if(doSubtotal02 && RenderGroup02 && RenderColumnG,'ffrsubtotald','ffrsubtotalhidden')}"><apex:outputText value="{!if(rowSubtotalGroup02ColumnG==0,VZ,RowNumberPattern)}" rendered="{!doSubtotal02 && RenderGroup02 && RenderColumnG}"><apex:param value="{!rowSubtotalGroup02ColumnG}"/></apex:outputText></td>
<td class="{!if(doSubtotal02 && RenderGroup02 && RenderColumnH,'ffrsubtotald','ffrsubtotalhidden')}"><apex:outputText value="{!if(rowSubtotalGroup02ColumnH==0,VZ,RowNumberPattern)}" rendered="{!doSubtotal02 && RenderGroup02 && RenderColumnH}"><apex:param value="{!rowSubtotalGroup02ColumnH}"/></apex:outputText></td>
<td class="{!if(doSubtotal02 && RenderGroup02 && RenderColumnI,'ffrsubtotald','ffrsubtotalhidden')}"><apex:outputText value="{!if(rowSubtotalGroup02ColumnI==0,VZ,RowNumberPattern)}" rendered="{!doSubtotal02 && RenderGroup02 && RenderColumnI}"><apex:param value="{!rowSubtotalGroup02ColumnI}"/></apex:outputText></td>
<td class="{!if(doSubtotal02 && RenderGroup02 && RenderColumnJ,'ffrsubtotald','ffrsubtotalhidden')}"><apex:outputText value="{!if(rowSubtotalGroup02ColumnJ==0,VZ,RowNumberPattern)}" rendered="{!doSubtotal02 && RenderGroup02 && RenderColumnJ}"><apex:param value="{!rowSubtotalGroup02ColumnJ}"/></apex:outputText></td>
<td class="{!if(doSubtotal02 && RenderGroup02 && RenderColumnK,'ffrsubtotald','ffrsubtotalhidden')}"><apex:outputText value="{!if(rowSubtotalGroup02ColumnK==0,VZ,RowNumberPattern)}" rendered="{!doSubtotal02 && RenderGroup02 && RenderColumnK}"><apex:param value="{!rowSubtotalGroup02ColumnK}"/></apex:outputText></td>
<td class="{!if(doSubtotal02 && RenderGroup02 && RenderColumnL,'ffrsubtotald','ffrsubtotalhidden')}"><apex:outputText value="{!if(rowSubtotalGroup02ColumnL==0,VZ,RowNumberPattern)}" rendered="{!doSubtotal02 && RenderGroup02 && RenderColumnL}"><apex:param value="{!rowSubtotalGroup02ColumnL}"/></apex:outputText></td>
<td class="{!if(doSubtotal02 && RenderGroup02 && RenderColumnM,'ffrsubtotald','ffrsubtotalhidden')}"><apex:outputText value="{!if(rowSubtotalGroup02ColumnM==0,VZ,RowNumberPattern)}" rendered="{!doSubtotal02 && RenderGroup02 && RenderColumnM}"><apex:param value="{!rowSubtotalGroup02ColumnM}"/></apex:outputText></td>
<td class="{!if(doSubtotal02 && RenderGroup02 && RenderColumnN,'ffrsubtotald','ffrsubtotalhidden')}"><apex:outputText value="{!if(rowSubtotalGroup02ColumnN==0,VZ,RowNumberPattern)}" rendered="{!doSubtotal02 && RenderGroup02 && RenderColumnN}"><apex:param value="{!rowSubtotalGroup02ColumnN}"/></apex:outputText></td>
<td class="{!if(doSubtotal02 && RenderGroup02 && RenderColumnO,'ffrsubtotald','ffrsubtotalhidden')}"><apex:outputText value="{!if(rowSubtotalGroup02ColumnO==0,VZ,RowNumberPattern)}" rendered="{!doSubtotal02 && RenderGroup02 && RenderColumnO}"><apex:param value="{!rowSubtotalGroup02ColumnO}"/></apex:outputText></td>
<td class="{!if(doSubtotal02 && RenderGroup02 && RenderColumnP,'ffrsubtotald','ffrsubtotalhidden')}"><apex:outputText value="{!if(rowSubtotalGroup02ColumnP==0,VZ,RowNumberPattern)}" rendered="{!doSubtotal02 && RenderGroup02 && RenderColumnP}"><apex:param value="{!rowSubtotalGroup02ColumnP}"/></apex:outputText></td>
<td class="{!if(doSubtotal02 && RenderGroup02 && RenderColumnQ,'ffrsubtotald','ffrsubtotalhidden')}"><apex:outputText value="{!if(rowSubtotalGroup02ColumnQ==0,VZ,RowNumberPattern)}" rendered="{!doSubtotal02 && RenderGroup02 && RenderColumnQ}"><apex:param value="{!rowSubtotalGroup02ColumnQ}"/></apex:outputText></td>
<td class="{!if(doSubtotal02 && RenderGroup02 && RenderColumnR,'ffrsubtotald','ffrsubtotalhidden')}"><apex:outputText value="{!if(rowSubtotalGroup02ColumnR==0,VZ,RowNumberPattern)}" rendered="{!doSubtotal02 && RenderGroup02 && RenderColumnR}"><apex:param value="{!rowSubtotalGroup02ColumnR}"/></apex:outputText></td>
<td class="{!if(doSubtotal02 && RenderGroup02 && RenderColumnS,'ffrsubtotald','ffrsubtotalhidden')}"><apex:outputText value="{!if(rowSubtotalGroup02ColumnS==0,VZ,RowNumberPattern)}" rendered="{!doSubtotal02 && RenderGroup02 && RenderColumnS}"><apex:param value="{!rowSubtotalGroup02ColumnS}"/></apex:outputText></td>
<td class="{!if(doSubtotal02 && RenderGroup02 && RenderColumnT,'ffrsubtotald','ffrsubtotalhidden')}"><apex:outputText value="{!if(rowSubtotalGroup02ColumnT==0,VZ,RowNumberPattern)}" rendered="{!doSubtotal02 && RenderGroup02 && RenderColumnT}"><apex:param value="{!rowSubtotalGroup02ColumnT}"/></apex:outputText></td>
<td class="{!if(doSubtotal02 && RenderGroup02 && RenderColumnU,'ffrsubtotald','ffrsubtotalhidden')}"><apex:outputText value="{!if(rowSubtotalGroup02ColumnU==0,VZ,RowNumberPattern)}" rendered="{!doSubtotal02 && RenderGroup02 && RenderColumnU}"><apex:param value="{!rowSubtotalGroup02ColumnU}"/></apex:outputText></td>
<td class="{!if(doSubtotal02 && RenderGroup02 && RenderColumnV,'ffrsubtotald','ffrsubtotalhidden')}"><apex:outputText value="{!if(rowSubtotalGroup02ColumnV==0,VZ,RowNumberPattern)}" rendered="{!doSubtotal02 && RenderGroup02 && RenderColumnV}"><apex:param value="{!rowSubtotalGroup02ColumnV}"/></apex:outputText></td>
<td class="{!if(doSubtotal02 && RenderGroup02 && RenderColumnW,'ffrsubtotald','ffrsubtotalhidden')}"><apex:outputText value="{!if(rowSubtotalGroup02ColumnW==0,VZ,RowNumberPattern)}" rendered="{!doSubtotal02 && RenderGroup02 && RenderColumnW}"><apex:param value="{!rowSubtotalGroup02ColumnW}"/></apex:outputText></td>
<td class="{!if(doSubtotal02 && RenderGroup02 && RenderColumnX,'ffrsubtotald','ffrsubtotalhidden')}"><apex:outputText value="{!if(rowSubtotalGroup02ColumnX==0,VZ,RowNumberPattern)}" rendered="{!doSubtotal02 && RenderGroup02 && RenderColumnX}"><apex:param value="{!rowSubtotalGroup02ColumnX}"/></apex:outputText></td>
<td class="{!if(doSubtotal02 && RenderGroup02 && RenderColumnY,'ffrsubtotald','ffrsubtotalhidden')}"><apex:outputText value="{!if(rowSubtotalGroup02ColumnY==0,VZ,RowNumberPattern)}" rendered="{!doSubtotal02 && RenderGroup02 && RenderColumnY}"><apex:param value="{!rowSubtotalGroup02ColumnY}"/></apex:outputText></td>
<td class="{!if(doSubtotal02 && RenderGroup02 && RenderColumnZ,'ffrsubtotald','ffrsubtotalhidden')}"><apex:outputText value="{!if(rowSubtotalGroup02ColumnZ==0,VZ,RowNumberPattern)}" rendered="{!doSubtotal02 && RenderGroup02 && RenderColumnZ}"><apex:param value="{!rowSubtotalGroup02ColumnZ}"/></apex:outputText></td>
</tr>
<tr>
    <td class="{!if(doSubtotal02 && RenderGroup02,'ffrcalcsumlabeld','ffrsubtotalhidden')}" colspan="11" style="text-indent: 20px;">
<apex:outputPanel layout="none" rendered="{!doSubtotal02 && RenderGroup02}">{!currentLineGroup02}</apex:outputPanel></td>
    </tr>
<!-- Display the group-group values but not the group-line values -->
<!-- Reset the subtotals for Group02 -->
<tr><td class="ffrhidden">
<apex:variable value="{!0}" var="rowSubtotalGroup02ColumnA" rendered="{!doSubtotal02 && RenderGroup02 && RenderColumnA}"/>
<apex:variable value="{!0}" var="rowSubtotalGroup02ColumnB" rendered="{!doSubtotal02 && RenderGroup02 && RenderColumnB}"/>
<apex:variable value="{!0}" var="rowSubtotalGroup02ColumnC" rendered="{!doSubtotal02 && RenderGroup02 && RenderColumnC}"/>
<apex:variable value="{!0}" var="rowSubtotalGroup02ColumnD" rendered="{!doSubtotal02 && RenderGroup02 && RenderColumnD}"/>
<apex:variable value="{!0}" var="rowSubtotalGroup02ColumnE" rendered="{!doSubtotal02 && RenderGroup02 && RenderColumnE}"/>
<apex:variable value="{!0}" var="rowSubtotalGroup02ColumnF" rendered="{!doSubtotal02 && RenderGroup02 && RenderColumnF}"/>
<apex:variable value="{!0}" var="rowSubtotalGroup02ColumnG" rendered="{!doSubtotal02 && RenderGroup02 && RenderColumnG}"/>
<apex:variable value="{!0}" var="rowSubtotalGroup02ColumnH" rendered="{!doSubtotal02 && RenderGroup02 && RenderColumnH}"/>
<apex:variable value="{!0}" var="rowSubtotalGroup02ColumnI" rendered="{!doSubtotal02 && RenderGroup02 && RenderColumnI}"/>
<apex:variable value="{!0}" var="rowSubtotalGroup02ColumnJ" rendered="{!doSubtotal02 && RenderGroup02 && RenderColumnJ}"/>
<apex:variable value="{!0}" var="rowSubtotalGroup02ColumnK" rendered="{!doSubtotal02 && RenderGroup02 && RenderColumnK}"/>
<apex:variable value="{!0}" var="rowSubtotalGroup02ColumnL" rendered="{!doSubtotal02 && RenderGroup02 && RenderColumnL}"/>
<apex:variable value="{!0}" var="rowSubtotalGroup02ColumnM" rendered="{!doSubtotal02 && RenderGroup02 && RenderColumnM}"/>
<apex:variable value="{!0}" var="rowSubtotalGroup02ColumnN" rendered="{!doSubtotal02 && RenderGroup02 && RenderColumnN}"/>
<apex:variable value="{!0}" var="rowSubtotalGroup02ColumnO" rendered="{!doSubtotal02 && RenderGroup02 && RenderColumnO}"/>
<apex:variable value="{!0}" var="rowSubtotalGroup02ColumnP" rendered="{!doSubtotal02 && RenderGroup02 && RenderColumnP}"/>
<apex:variable value="{!0}" var="rowSubtotalGroup02ColumnQ" rendered="{!doSubtotal02 && RenderGroup02 && RenderColumnQ}"/>
<apex:variable value="{!0}" var="rowSubtotalGroup02ColumnR" rendered="{!doSubtotal02 && RenderGroup02 && RenderColumnR}"/>
<apex:variable value="{!0}" var="rowSubtotalGroup02ColumnS" rendered="{!doSubtotal02 && RenderGroup02 && RenderColumnS}"/>
<apex:variable value="{!0}" var="rowSubtotalGroup02ColumnT" rendered="{!doSubtotal02 && RenderGroup02 && RenderColumnT}"/>
<apex:variable value="{!0}" var="rowSubtotalGroup02ColumnU" rendered="{!doSubtotal02 && RenderGroup02 && RenderColumnU}"/>
<apex:variable value="{!0}" var="rowSubtotalGroup02ColumnV" rendered="{!doSubtotal02 && RenderGroup02 && RenderColumnV}"/>
<apex:variable value="{!0}" var="rowSubtotalGroup02ColumnW" rendered="{!doSubtotal02 && RenderGroup02 && RenderColumnW}"/>
<apex:variable value="{!0}" var="rowSubtotalGroup02ColumnX" rendered="{!doSubtotal02 && RenderGroup02 && RenderColumnX}"/>
<apex:variable value="{!0}" var="rowSubtotalGroup02ColumnY" rendered="{!doSubtotal02 && RenderGroup02 && RenderColumnY}"/>
<apex:variable value="{!0}" var="rowSubtotalGroup02ColumnZ" rendered="{!doSubtotal02 && RenderGroup02 && RenderColumnZ}"/>
</td></tr>
<!-- Line setup -->
<!-- Each column is configured independently within an outputPanel the outputpanel rendered property determines whether the column is configured -->
<!-- This uses the column render state variable (e.g. "renderColumnA" determines whether the panel for column A is configured and rendered) -->
<apex:variable value="{!0}" var="lineTotal"/>
<!-- For each column, add the column value to the line total and sub-total - column-row totals are updated separately -->
<!-- Subtotals for Group02 -->
<tr><td class="ffrhidden">
<apex:outputPanel layout="none" rendered="{!RenderColumnA}">
<apex:variable value="{!lineTotal+line.columns['A'].values['A']}" var="lineTotal"/>
<apex:variable value="{!rowSubtotalGroup02ColumnA+line.columns['A'].values['A']}" var="rowSubtotalGroup02ColumnA"/>
</apex:outputPanel>
<apex:outputPanel layout="none" rendered="{!RenderColumnB}">
<apex:variable value="{!lineTotal+line.columns['B'].values['A']}" var="lineTotal"/>
<apex:variable value="{!rowSubtotalGroup02ColumnB+line.columns['B'].values['A']}" var="rowSubtotalGroup02ColumnB"/>
</apex:outputPanel>
<apex:outputPanel layout="none" rendered="{!RenderColumnC}">
<apex:variable value="{!lineTotal+line.columns['C'].values['A']}" var="lineTotal"/>
<apex:variable value="{!rowSubtotalGroup02ColumnC+line.columns['C'].values['A']}" var="rowSubtotalGroup02ColumnC"/>
</apex:outputPanel>
<apex:outputPanel layout="none" rendered="{!RenderColumnD}">
<apex:variable value="{!lineTotal+line.columns['D'].values['A']}" var="lineTotal"/>
<apex:variable value="{!rowSubtotalGroup02ColumnD+line.columns['D'].values['A']}" var="rowSubtotalGroup02ColumnD"/>
</apex:outputPanel>
<apex:outputPanel layout="none" rendered="{!RenderColumnE}">
<apex:variable value="{!lineTotal+line.columns['E'].values['A']}" var="lineTotal"/>
<apex:variable value="{!rowSubtotalGroup02ColumnE+line.columns['E'].values['A']}" var="rowSubtotalGroup02ColumnE"/>
</apex:outputPanel>
<apex:outputPanel layout="none" rendered="{!RenderColumnF}">
<apex:variable value="{!lineTotal+line.columns['F'].values['A']}" var="lineTotal"/>
<apex:variable value="{!rowSubtotalGroup02ColumnF+line.columns['F'].values['A']}" var="rowSubtotalGroup02ColumnF"/>
</apex:outputPanel>
<apex:outputPanel layout="none" rendered="{!RenderColumnG}">
<apex:variable value="{!lineTotal+line.columns['G'].values['A']}" var="lineTotal"/>
<apex:variable value="{!rowSubtotalGroup02ColumnG+line.columns['G'].values['A']}" var="rowSubtotalGroup02ColumnG"/>
</apex:outputPanel>
<apex:outputPanel layout="none" rendered="{!RenderColumnH}">
<apex:variable value="{!lineTotal+line.columns['H'].values['A']}" var="lineTotal"/>
<apex:variable value="{!rowSubtotalGroup02ColumnH+line.columns['H'].values['A']}" var="rowSubtotalGroup02ColumnH"/>
</apex:outputPanel>
<apex:outputPanel layout="none" rendered="{!RenderColumnI}">
<apex:variable value="{!lineTotal+line.columns['I'].values['A']}" var="lineTotal"/>
<apex:variable value="{!rowSubtotalGroup02ColumnI+line.columns['I'].values['A']}" var="rowSubtotalGroup02ColumnI"/>
</apex:outputPanel>
<apex:outputPanel layout="none" rendered="{!RenderColumnJ}">
<apex:variable value="{!lineTotal+line.columns['J'].values['A']}" var="lineTotal"/>
<apex:variable value="{!rowSubtotalGroup02ColumnJ+line.columns['J'].values['A']}" var="rowSubtotalGroup02ColumnJ"/>
</apex:outputPanel>
<apex:outputPanel layout="none" rendered="{!RenderColumnK}">
<apex:variable value="{!lineTotal+line.columns['K'].values['A']}" var="lineTotal"/>
<apex:variable value="{!rowSubtotalGroup02ColumnK+line.columns['K'].values['A']}" var="rowSubtotalGroup02ColumnK"/>
</apex:outputPanel>
<apex:outputPanel layout="none" rendered="{!RenderColumnL}">
<apex:variable value="{!lineTotal+line.columns['L'].values['A']}" var="lineTotal"/>
<apex:variable value="{!rowSubtotalGroup02ColumnL+line.columns['L'].values['A']}" var="rowSubtotalGroup02ColumnL"/>
</apex:outputPanel>
<apex:outputPanel layout="none" rendered="{!RenderColumnM}">
<apex:variable value="{!lineTotal+line.columns['M'].values['A']}" var="lineTotal"/>
<apex:variable value="{!rowSubtotalGroup02ColumnM+line.columns['M'].values['A']}" var="rowSubtotalGroup02ColumnM"/>
</apex:outputPanel>
<apex:outputPanel layout="none" rendered="{!RenderColumnN}">
<apex:variable value="{!lineTotal+line.columns['N'].values['A']}" var="lineTotal"/>
<apex:variable value="{!rowSubtotalGroup02ColumnN+line.columns['N'].values['A']}" var="rowSubtotalGroup02ColumnN"/>
</apex:outputPanel>
<apex:outputPanel layout="none" rendered="{!RenderColumnO}">
<apex:variable value="{!lineTotal+line.columns['O'].values['A']}" var="lineTotal"/>
<apex:variable value="{!rowSubtotalGroup02ColumnO+line.columns['O'].values['A']}" var="rowSubtotalGroup02ColumnO"/>
</apex:outputPanel>
<apex:outputPanel layout="none" rendered="{!RenderColumnP}">
<apex:variable value="{!lineTotal+line.columns['P'].values['A']}" var="lineTotal"/>
<apex:variable value="{!rowSubtotalGroup02ColumnP+line.columns['P'].values['A']}" var="rowSubtotalGroup02ColumnP"/>
</apex:outputPanel>
<apex:outputPanel layout="none" rendered="{!RenderColumnQ}">
<apex:variable value="{!lineTotal+line.columns['Q'].values['A']}" var="lineTotal"/>
<apex:variable value="{!rowSubtotalGroup02ColumnQ+line.columns['Q'].values['A']}" var="rowSubtotalGroup02ColumnQ"/>
</apex:outputPanel>
<apex:outputPanel layout="none" rendered="{!RenderColumnR}">
<apex:variable value="{!lineTotal+line.columns['R'].values['A']}" var="lineTotal"/>
<apex:variable value="{!rowSubtotalGroup02ColumnR+line.columns['R'].values['A']}" var="rowSubtotalGroup02ColumnR"/>
</apex:outputPanel>
<apex:outputPanel layout="none" rendered="{!RenderColumnS}">
<apex:variable value="{!lineTotal+line.columns['S'].values['A']}" var="lineTotal"/>
<apex:variable value="{!rowSubtotalGroup02ColumnS+line.columns['S'].values['A']}" var="rowSubtotalGroup02ColumnS"/>
</apex:outputPanel>
<apex:outputPanel layout="none" rendered="{!RenderColumnT}">
<apex:variable value="{!lineTotal+line.columns['T'].values['A']}" var="lineTotal"/>
<apex:variable value="{!rowSubtotalGroup02ColumnT+line.columns['T'].values['A']}" var="rowSubtotalGroup02ColumnT"/>
</apex:outputPanel>
<apex:outputPanel layout="none" rendered="{!RenderColumnU}">
<apex:variable value="{!lineTotal+line.columns['U'].values['A']}" var="lineTotal"/>
<apex:variable value="{!rowSubtotalGroup02ColumnU+line.columns['U'].values['A']}" var="rowSubtotalGroup02ColumnU"/>
</apex:outputPanel>
<apex:outputPanel layout="none" rendered="{!RenderColumnV}">
<apex:variable value="{!lineTotal+line.columns['V'].values['A']}" var="lineTotal"/>
<apex:variable value="{!rowSubtotalGroup02ColumnV+line.columns['V'].values['A']}" var="rowSubtotalGroup02ColumnV"/>
</apex:outputPanel>
<apex:outputPanel layout="none" rendered="{!RenderColumnW}">
<apex:variable value="{!lineTotal+line.columns['W'].values['A']}" var="lineTotal"/>
<apex:variable value="{!rowSubtotalGroup02ColumnW+line.columns['W'].values['A']}" var="rowSubtotalGroup02ColumnW"/>
</apex:outputPanel>
<apex:outputPanel layout="none" rendered="{!RenderColumnX}">
<apex:variable value="{!lineTotal+line.columns['X'].values['A']}" var="lineTotal"/>
<apex:variable value="{!rowSubtotalGroup02ColumnX+line.columns['X'].values['A']}" var="rowSubtotalGroup02ColumnX"/>
</apex:outputPanel>
<apex:outputPanel layout="none" rendered="{!RenderColumnY}">
<apex:variable value="{!lineTotal+line.columns['Y'].values['A']}" var="lineTotal"/>
<apex:variable value="{!rowSubtotalGroup02ColumnY+line.columns['Y'].values['A']}" var="rowSubtotalGroup02ColumnY"/>
</apex:outputPanel>
<apex:outputPanel layout="none" rendered="{!RenderColumnZ}">
<apex:variable value="{!lineTotal+line.columns['Z'].values['A']}" var="lineTotal"/>
<apex:variable value="{!rowSubtotalGroup02ColumnZ+line.columns['Z'].values['A']}" var="rowSubtotalGroup02ColumnZ"/>
</apex:outputPanel>
</td></tr>
<!-- Subtotals for Group03 -->
<tr><td class="ffrhidden">
<apex:outputPanel layout="none" rendered="{!RenderColumnA}">
<apex:variable value="{!lineTotal+line.columns['A'].values['A']}" var="lineTotal"/>
<apex:variable value="{!rowSubtotalGroup03ColumnA+line.columns['A'].values['A']}" var="rowSubtotalGroup03ColumnA"/>
</apex:outputPanel>
<apex:outputPanel layout="none" rendered="{!RenderColumnB}">
<apex:variable value="{!lineTotal+line.columns['B'].values['A']}" var="lineTotal"/>
<apex:variable value="{!rowSubtotalGroup03ColumnB+line.columns['B'].values['A']}" var="rowSubtotalGroup03ColumnB"/>
</apex:outputPanel>
<apex:outputPanel layout="none" rendered="{!RenderColumnC}">
<apex:variable value="{!lineTotal+line.columns['C'].values['A']}" var="lineTotal"/>
<apex:variable value="{!rowSubtotalGroup03ColumnC+line.columns['C'].values['A']}" var="rowSubtotalGroup03ColumnC"/>
</apex:outputPanel>
<apex:outputPanel layout="none" rendered="{!RenderColumnD}">
<apex:variable value="{!lineTotal+line.columns['D'].values['A']}" var="lineTotal"/>
<apex:variable value="{!rowSubtotalGroup03ColumnD+line.columns['D'].values['A']}" var="rowSubtotalGroup03ColumnD"/>
</apex:outputPanel>
<apex:outputPanel layout="none" rendered="{!RenderColumnE}">
<apex:variable value="{!lineTotal+line.columns['E'].values['A']}" var="lineTotal"/>
<apex:variable value="{!rowSubtotalGroup03ColumnE+line.columns['E'].values['A']}" var="rowSubtotalGroup03ColumnE"/>
</apex:outputPanel>
<apex:outputPanel layout="none" rendered="{!RenderColumnF}">
<apex:variable value="{!lineTotal+line.columns['F'].values['A']}" var="lineTotal"/>
<apex:variable value="{!rowSubtotalGroup03ColumnF+line.columns['F'].values['A']}" var="rowSubtotalGroup03ColumnF"/>
</apex:outputPanel>
<apex:outputPanel layout="none" rendered="{!RenderColumnG}">
<apex:variable value="{!lineTotal+line.columns['G'].values['A']}" var="lineTotal"/>
<apex:variable value="{!rowSubtotalGroup03ColumnG+line.columns['G'].values['A']}" var="rowSubtotalGroup03ColumnG"/>
</apex:outputPanel>
<apex:outputPanel layout="none" rendered="{!RenderColumnH}">
<apex:variable value="{!lineTotal+line.columns['H'].values['A']}" var="lineTotal"/>
<apex:variable value="{!rowSubtotalGroup03ColumnH+line.columns['H'].values['A']}" var="rowSubtotalGroup03ColumnH"/>
</apex:outputPanel>
<apex:outputPanel layout="none" rendered="{!RenderColumnI}">
<apex:variable value="{!lineTotal+line.columns['I'].values['A']}" var="lineTotal"/>
<apex:variable value="{!rowSubtotalGroup03ColumnI+line.columns['I'].values['A']}" var="rowSubtotalGroup03ColumnI"/>
</apex:outputPanel>
<apex:outputPanel layout="none" rendered="{!RenderColumnJ}">
<apex:variable value="{!lineTotal+line.columns['J'].values['A']}" var="lineTotal"/>
<apex:variable value="{!rowSubtotalGroup03ColumnJ+line.columns['J'].values['A']}" var="rowSubtotalGroup03ColumnJ"/>
</apex:outputPanel>
<apex:outputPanel layout="none" rendered="{!RenderColumnK}">
<apex:variable value="{!lineTotal+line.columns['K'].values['A']}" var="lineTotal"/>
<apex:variable value="{!rowSubtotalGroup03ColumnK+line.columns['K'].values['A']}" var="rowSubtotalGroup03ColumnK"/>
</apex:outputPanel>
<apex:outputPanel layout="none" rendered="{!RenderColumnL}">
<apex:variable value="{!lineTotal+line.columns['L'].values['A']}" var="lineTotal"/>
<apex:variable value="{!rowSubtotalGroup03ColumnL+line.columns['L'].values['A']}" var="rowSubtotalGroup03ColumnL"/>
</apex:outputPanel>
<apex:outputPanel layout="none" rendered="{!RenderColumnM}">
<apex:variable value="{!lineTotal+line.columns['M'].values['A']}" var="lineTotal"/>
<apex:variable value="{!rowSubtotalGroup03ColumnM+line.columns['M'].values['A']}" var="rowSubtotalGroup03ColumnM"/>
</apex:outputPanel>
<apex:outputPanel layout="none" rendered="{!RenderColumnN}">
<apex:variable value="{!lineTotal+line.columns['N'].values['A']}" var="lineTotal"/>
<apex:variable value="{!rowSubtotalGroup03ColumnN+line.columns['N'].values['A']}" var="rowSubtotalGroup03ColumnN"/>
</apex:outputPanel>
<apex:outputPanel layout="none" rendered="{!RenderColumnO}">
<apex:variable value="{!lineTotal+line.columns['O'].values['A']}" var="lineTotal"/>
<apex:variable value="{!rowSubtotalGroup03ColumnO+line.columns['O'].values['A']}" var="rowSubtotalGroup03ColumnO"/>
</apex:outputPanel>
<apex:outputPanel layout="none" rendered="{!RenderColumnP}">
<apex:variable value="{!lineTotal+line.columns['P'].values['A']}" var="lineTotal"/>
<apex:variable value="{!rowSubtotalGroup03ColumnP+line.columns['P'].values['A']}" var="rowSubtotalGroup03ColumnP"/>
</apex:outputPanel>
<apex:outputPanel layout="none" rendered="{!RenderColumnQ}">
<apex:variable value="{!lineTotal+line.columns['Q'].values['A']}" var="lineTotal"/>
<apex:variable value="{!rowSubtotalGroup03ColumnQ+line.columns['Q'].values['A']}" var="rowSubtotalGroup03ColumnQ"/>
</apex:outputPanel>
<apex:outputPanel layout="none" rendered="{!RenderColumnR}">
<apex:variable value="{!lineTotal+line.columns['R'].values['A']}" var="lineTotal"/>
<apex:variable value="{!rowSubtotalGroup03ColumnR+line.columns['R'].values['A']}" var="rowSubtotalGroup03ColumnR"/>
</apex:outputPanel>
<apex:outputPanel layout="none" rendered="{!RenderColumnS}">
<apex:variable value="{!lineTotal+line.columns['S'].values['A']}" var="lineTotal"/>
<apex:variable value="{!rowSubtotalGroup03ColumnS+line.columns['S'].values['A']}" var="rowSubtotalGroup03ColumnS"/>
</apex:outputPanel>
<apex:outputPanel layout="none" rendered="{!RenderColumnT}">
<apex:variable value="{!lineTotal+line.columns['T'].values['A']}" var="lineTotal"/>
<apex:variable value="{!rowSubtotalGroup03ColumnT+line.columns['T'].values['A']}" var="rowSubtotalGroup03ColumnT"/>
</apex:outputPanel>
<apex:outputPanel layout="none" rendered="{!RenderColumnU}">
<apex:variable value="{!lineTotal+line.columns['U'].values['A']}" var="lineTotal"/>
<apex:variable value="{!rowSubtotalGroup03ColumnU+line.columns['U'].values['A']}" var="rowSubtotalGroup03ColumnU"/>
</apex:outputPanel>
<apex:outputPanel layout="none" rendered="{!RenderColumnV}">
<apex:variable value="{!lineTotal+line.columns['V'].values['A']}" var="lineTotal"/>
<apex:variable value="{!rowSubtotalGroup03ColumnV+line.columns['V'].values['A']}" var="rowSubtotalGroup03ColumnV"/>
</apex:outputPanel>
<apex:outputPanel layout="none" rendered="{!RenderColumnW}">
<apex:variable value="{!lineTotal+line.columns['W'].values['A']}" var="lineTotal"/>
<apex:variable value="{!rowSubtotalGroup03ColumnW+line.columns['W'].values['A']}" var="rowSubtotalGroup03ColumnW"/>
</apex:outputPanel>
<apex:outputPanel layout="none" rendered="{!RenderColumnX}">
<apex:variable value="{!lineTotal+line.columns['X'].values['A']}" var="lineTotal"/>
<apex:variable value="{!rowSubtotalGroup03ColumnX+line.columns['X'].values['A']}" var="rowSubtotalGroup03ColumnX"/>
</apex:outputPanel>
<apex:outputPanel layout="none" rendered="{!RenderColumnY}">
<apex:variable value="{!lineTotal+line.columns['Y'].values['A']}" var="lineTotal"/>
<apex:variable value="{!rowSubtotalGroup03ColumnY+line.columns['Y'].values['A']}" var="rowSubtotalGroup03ColumnY"/>
</apex:outputPanel>
<apex:outputPanel layout="none" rendered="{!RenderColumnZ}">
<apex:variable value="{!lineTotal+line.columns['Z'].values['A']}" var="lineTotal"/>
<apex:variable value="{!rowSubtotalGroup03ColumnZ+line.columns['Z'].values['A']}" var="rowSubtotalGroup03ColumnZ"/>
</apex:outputPanel>
</td></tr>
<!-- Subtotals for Group04 -->
<tr><td class="ffrhidden">
<apex:outputPanel layout="none" rendered="{!RenderColumnA}">
<apex:variable value="{!lineTotal+line.columns['A'].values['A']}" var="lineTotal"/>
<apex:variable value="{!rowSubtotalGroup04ColumnA+line.columns['A'].values['A']}" var="rowSubtotalGroup04ColumnA"/>
</apex:outputPanel>
<apex:outputPanel layout="none" rendered="{!RenderColumnB}">
<apex:variable value="{!lineTotal+line.columns['B'].values['A']}" var="lineTotal"/>
<apex:variable value="{!rowSubtotalGroup04ColumnB+line.columns['B'].values['A']}" var="rowSubtotalGroup04ColumnB"/>
</apex:outputPanel>
<apex:outputPanel layout="none" rendered="{!RenderColumnC}">
<apex:variable value="{!lineTotal+line.columns['C'].values['A']}" var="lineTotal"/>
<apex:variable value="{!rowSubtotalGroup04ColumnC+line.columns['C'].values['A']}" var="rowSubtotalGroup04ColumnC"/>
</apex:outputPanel>
<apex:outputPanel layout="none" rendered="{!RenderColumnD}">
<apex:variable value="{!lineTotal+line.columns['D'].values['A']}" var="lineTotal"/>
<apex:variable value="{!rowSubtotalGroup04ColumnD+line.columns['D'].values['A']}" var="rowSubtotalGroup04ColumnD"/>
</apex:outputPanel>
<apex:outputPanel layout="none" rendered="{!RenderColumnE}">
<apex:variable value="{!lineTotal+line.columns['E'].values['A']}" var="lineTotal"/>
<apex:variable value="{!rowSubtotalGroup04ColumnE+line.columns['E'].values['A']}" var="rowSubtotalGroup04ColumnE"/>
</apex:outputPanel>
<apex:outputPanel layout="none" rendered="{!RenderColumnF}">
<apex:variable value="{!lineTotal+line.columns['F'].values['A']}" var="lineTotal"/>
<apex:variable value="{!rowSubtotalGroup04ColumnF+line.columns['F'].values['A']}" var="rowSubtotalGroup04ColumnF"/>
</apex:outputPanel>
<apex:outputPanel layout="none" rendered="{!RenderColumnG}">
<apex:variable value="{!lineTotal+line.columns['G'].values['A']}" var="lineTotal"/>
<apex:variable value="{!rowSubtotalGroup04ColumnG+line.columns['G'].values['A']}" var="rowSubtotalGroup04ColumnG"/>
</apex:outputPanel>
<apex:outputPanel layout="none" rendered="{!RenderColumnH}">
<apex:variable value="{!lineTotal+line.columns['H'].values['A']}" var="lineTotal"/>
<apex:variable value="{!rowSubtotalGroup04ColumnH+line.columns['H'].values['A']}" var="rowSubtotalGroup04ColumnH"/>
</apex:outputPanel>
<apex:outputPanel layout="none" rendered="{!RenderColumnI}">
<apex:variable value="{!lineTotal+line.columns['I'].values['A']}" var="lineTotal"/>
<apex:variable value="{!rowSubtotalGroup04ColumnI+line.columns['I'].values['A']}" var="rowSubtotalGroup04ColumnI"/>
</apex:outputPanel>
<apex:outputPanel layout="none" rendered="{!RenderColumnJ}">
<apex:variable value="{!lineTotal+line.columns['J'].values['A']}" var="lineTotal"/>
<apex:variable value="{!rowSubtotalGroup04ColumnJ+line.columns['J'].values['A']}" var="rowSubtotalGroup04ColumnJ"/>
</apex:outputPanel>
<apex:outputPanel layout="none" rendered="{!RenderColumnK}">
<apex:variable value="{!lineTotal+line.columns['K'].values['A']}" var="lineTotal"/>
<apex:variable value="{!rowSubtotalGroup04ColumnK+line.columns['K'].values['A']}" var="rowSubtotalGroup04ColumnK"/>
</apex:outputPanel>
<apex:outputPanel layout="none" rendered="{!RenderColumnL}">
<apex:variable value="{!lineTotal+line.columns['L'].values['A']}" var="lineTotal"/>
<apex:variable value="{!rowSubtotalGroup04ColumnL+line.columns['L'].values['A']}" var="rowSubtotalGroup04ColumnL"/>
</apex:outputPanel>
<apex:outputPanel layout="none" rendered="{!RenderColumnM}">
<apex:variable value="{!lineTotal+line.columns['M'].values['A']}" var="lineTotal"/>
<apex:variable value="{!rowSubtotalGroup04ColumnM+line.columns['M'].values['A']}" var="rowSubtotalGroup04ColumnM"/>
</apex:outputPanel>
<apex:outputPanel layout="none" rendered="{!RenderColumnN}">
<apex:variable value="{!lineTotal+line.columns['N'].values['A']}" var="lineTotal"/>
<apex:variable value="{!rowSubtotalGroup04ColumnN+line.columns['N'].values['A']}" var="rowSubtotalGroup04ColumnN"/>
</apex:outputPanel>
<apex:outputPanel layout="none" rendered="{!RenderColumnO}">
<apex:variable value="{!lineTotal+line.columns['O'].values['A']}" var="lineTotal"/>
<apex:variable value="{!rowSubtotalGroup04ColumnO+line.columns['O'].values['A']}" var="rowSubtotalGroup04ColumnO"/>
</apex:outputPanel>
<apex:outputPanel layout="none" rendered="{!RenderColumnP}">
<apex:variable value="{!lineTotal+line.columns['P'].values['A']}" var="lineTotal"/>
<apex:variable value="{!rowSubtotalGroup04ColumnP+line.columns['P'].values['A']}" var="rowSubtotalGroup04ColumnP"/>
</apex:outputPanel>
<apex:outputPanel layout="none" rendered="{!RenderColumnQ}">
<apex:variable value="{!lineTotal+line.columns['Q'].values['A']}" var="lineTotal"/>
<apex:variable value="{!rowSubtotalGroup04ColumnQ+line.columns['Q'].values['A']}" var="rowSubtotalGroup04ColumnQ"/>
</apex:outputPanel>
<apex:outputPanel layout="none" rendered="{!RenderColumnR}">
<apex:variable value="{!lineTotal+line.columns['R'].values['A']}" var="lineTotal"/>
<apex:variable value="{!rowSubtotalGroup04ColumnR+line.columns['R'].values['A']}" var="rowSubtotalGroup04ColumnR"/>
</apex:outputPanel>
<apex:outputPanel layout="none" rendered="{!RenderColumnS}">
<apex:variable value="{!lineTotal+line.columns['S'].values['A']}" var="lineTotal"/>
<apex:variable value="{!rowSubtotalGroup04ColumnS+line.columns['S'].values['A']}" var="rowSubtotalGroup04ColumnS"/>
</apex:outputPanel>
<apex:outputPanel layout="none" rendered="{!RenderColumnT}">
<apex:variable value="{!lineTotal+line.columns['T'].values['A']}" var="lineTotal"/>
<apex:variable value="{!rowSubtotalGroup04ColumnT+line.columns['T'].values['A']}" var="rowSubtotalGroup04ColumnT"/>
</apex:outputPanel>
<apex:outputPanel layout="none" rendered="{!RenderColumnU}">
<apex:variable value="{!lineTotal+line.columns['U'].values['A']}" var="lineTotal"/>
<apex:variable value="{!rowSubtotalGroup04ColumnU+line.columns['U'].values['A']}" var="rowSubtotalGroup04ColumnU"/>
</apex:outputPanel>
<apex:outputPanel layout="none" rendered="{!RenderColumnV}">
<apex:variable value="{!lineTotal+line.columns['V'].values['A']}" var="lineTotal"/>
<apex:variable value="{!rowSubtotalGroup04ColumnV+line.columns['V'].values['A']}" var="rowSubtotalGroup04ColumnV"/>
</apex:outputPanel>
<apex:outputPanel layout="none" rendered="{!RenderColumnW}">
<apex:variable value="{!lineTotal+line.columns['W'].values['A']}" var="lineTotal"/>
<apex:variable value="{!rowSubtotalGroup04ColumnW+line.columns['W'].values['A']}" var="rowSubtotalGroup04ColumnW"/>
</apex:outputPanel>
<apex:outputPanel layout="none" rendered="{!RenderColumnX}">
<apex:variable value="{!lineTotal+line.columns['X'].values['A']}" var="lineTotal"/>
<apex:variable value="{!rowSubtotalGroup04ColumnX+line.columns['X'].values['A']}" var="rowSubtotalGroup04ColumnX"/>
</apex:outputPanel>
<apex:outputPanel layout="none" rendered="{!RenderColumnY}">
<apex:variable value="{!lineTotal+line.columns['Y'].values['A']}" var="lineTotal"/>
<apex:variable value="{!rowSubtotalGroup04ColumnY+line.columns['Y'].values['A']}" var="rowSubtotalGroup04ColumnY"/>
</apex:outputPanel>
<apex:outputPanel layout="none" rendered="{!RenderColumnZ}">
<apex:variable value="{!lineTotal+line.columns['Z'].values['A']}" var="lineTotal"/>
<apex:variable value="{!rowSubtotalGroup04ColumnZ+line.columns['Z'].values['A']}" var="rowSubtotalGroup04ColumnZ"/>
</apex:outputPanel>
</td></tr>
<!-- Subtotals for Group05 -->
<tr><td class="ffrhidden">
<apex:outputPanel layout="none" rendered="{!RenderColumnA}">
<apex:variable value="{!lineTotal+line.columns['A'].values['A']}" var="lineTotal"/>
<apex:variable value="{!rowSubtotalGroup05ColumnA+line.columns['A'].values['A']}" var="rowSubtotalGroup05ColumnA"/>
</apex:outputPanel>
<apex:outputPanel layout="none" rendered="{!RenderColumnB}">
<apex:variable value="{!lineTotal+line.columns['B'].values['A']}" var="lineTotal"/>
<apex:variable value="{!rowSubtotalGroup05ColumnB+line.columns['B'].values['A']}" var="rowSubtotalGroup05ColumnB"/>
</apex:outputPanel>
<apex:outputPanel layout="none" rendered="{!RenderColumnC}">
<apex:variable value="{!lineTotal+line.columns['C'].values['A']}" var="lineTotal"/>
<apex:variable value="{!rowSubtotalGroup05ColumnC+line.columns['C'].values['A']}" var="rowSubtotalGroup05ColumnC"/>
</apex:outputPanel>
<apex:outputPanel layout="none" rendered="{!RenderColumnD}">
<apex:variable value="{!lineTotal+line.columns['D'].values['A']}" var="lineTotal"/>
<apex:variable value="{!rowSubtotalGroup05ColumnD+line.columns['D'].values['A']}" var="rowSubtotalGroup05ColumnD"/>
</apex:outputPanel>
<apex:outputPanel layout="none" rendered="{!RenderColumnE}">
<apex:variable value="{!lineTotal+line.columns['E'].values['A']}" var="lineTotal"/>
<apex:variable value="{!rowSubtotalGroup05ColumnE+line.columns['E'].values['A']}" var="rowSubtotalGroup05ColumnE"/>
</apex:outputPanel>
<apex:outputPanel layout="none" rendered="{!RenderColumnF}">
<apex:variable value="{!lineTotal+line.columns['F'].values['A']}" var="lineTotal"/>
<apex:variable value="{!rowSubtotalGroup05ColumnF+line.columns['F'].values['A']}" var="rowSubtotalGroup05ColumnF"/>
</apex:outputPanel>
<apex:outputPanel layout="none" rendered="{!RenderColumnG}">
<apex:variable value="{!lineTotal+line.columns['G'].values['A']}" var="lineTotal"/>
<apex:variable value="{!rowSubtotalGroup05ColumnG+line.columns['G'].values['A']}" var="rowSubtotalGroup05ColumnG"/>
</apex:outputPanel>
<apex:outputPanel layout="none" rendered="{!RenderColumnH}">
<apex:variable value="{!lineTotal+line.columns['H'].values['A']}" var="lineTotal"/>
<apex:variable value="{!rowSubtotalGroup05ColumnH+line.columns['H'].values['A']}" var="rowSubtotalGroup05ColumnH"/>
</apex:outputPanel>
<apex:outputPanel layout="none" rendered="{!RenderColumnI}">
<apex:variable value="{!lineTotal+line.columns['I'].values['A']}" var="lineTotal"/>
<apex:variable value="{!rowSubtotalGroup05ColumnI+line.columns['I'].values['A']}" var="rowSubtotalGroup05ColumnI"/>
</apex:outputPanel>
<apex:outputPanel layout="none" rendered="{!RenderColumnJ}">
<apex:variable value="{!lineTotal+line.columns['J'].values['A']}" var="lineTotal"/>
<apex:variable value="{!rowSubtotalGroup05ColumnJ+line.columns['J'].values['A']}" var="rowSubtotalGroup05ColumnJ"/>
</apex:outputPanel>
<apex:outputPanel layout="none" rendered="{!RenderColumnK}">
<apex:variable value="{!lineTotal+line.columns['K'].values['A']}" var="lineTotal"/>
<apex:variable value="{!rowSubtotalGroup05ColumnK+line.columns['K'].values['A']}" var="rowSubtotalGroup05ColumnK"/>
</apex:outputPanel>
<apex:outputPanel layout="none" rendered="{!RenderColumnL}">
<apex:variable value="{!lineTotal+line.columns['L'].values['A']}" var="lineTotal"/>
<apex:variable value="{!rowSubtotalGroup05ColumnL+line.columns['L'].values['A']}" var="rowSubtotalGroup05ColumnL"/>
</apex:outputPanel>
<apex:outputPanel layout="none" rendered="{!RenderColumnM}">
<apex:variable value="{!lineTotal+line.columns['M'].values['A']}" var="lineTotal"/>
<apex:variable value="{!rowSubtotalGroup05ColumnM+line.columns['M'].values['A']}" var="rowSubtotalGroup05ColumnM"/>
</apex:outputPanel>
<apex:outputPanel layout="none" rendered="{!RenderColumnN}">
<apex:variable value="{!lineTotal+line.columns['N'].values['A']}" var="lineTotal"/>
<apex:variable value="{!rowSubtotalGroup05ColumnN+line.columns['N'].values['A']}" var="rowSubtotalGroup05ColumnN"/>
</apex:outputPanel>
<apex:outputPanel layout="none" rendered="{!RenderColumnO}">
<apex:variable value="{!lineTotal+line.columns['O'].values['A']}" var="lineTotal"/>
<apex:variable value="{!rowSubtotalGroup05ColumnO+line.columns['O'].values['A']}" var="rowSubtotalGroup05ColumnO"/>
</apex:outputPanel>
<apex:outputPanel layout="none" rendered="{!RenderColumnP}">
<apex:variable value="{!lineTotal+line.columns['P'].values['A']}" var="lineTotal"/>
<apex:variable value="{!rowSubtotalGroup05ColumnP+line.columns['P'].values['A']}" var="rowSubtotalGroup05ColumnP"/>
</apex:outputPanel>
<apex:outputPanel layout="none" rendered="{!RenderColumnQ}">
<apex:variable value="{!lineTotal+line.columns['Q'].values['A']}" var="lineTotal"/>
<apex:variable value="{!rowSubtotalGroup05ColumnQ+line.columns['Q'].values['A']}" var="rowSubtotalGroup05ColumnQ"/>
</apex:outputPanel>
<apex:outputPanel layout="none" rendered="{!RenderColumnR}">
<apex:variable value="{!lineTotal+line.columns['R'].values['A']}" var="lineTotal"/>
<apex:variable value="{!rowSubtotalGroup05ColumnR+line.columns['R'].values['A']}" var="rowSubtotalGroup05ColumnR"/>
</apex:outputPanel>
<apex:outputPanel layout="none" rendered="{!RenderColumnS}">
<apex:variable value="{!lineTotal+line.columns['S'].values['A']}" var="lineTotal"/>
<apex:variable value="{!rowSubtotalGroup05ColumnS+line.columns['S'].values['A']}" var="rowSubtotalGroup05ColumnS"/>
</apex:outputPanel>
<apex:outputPanel layout="none" rendered="{!RenderColumnT}">
<apex:variable value="{!lineTotal+line.columns['T'].values['A']}" var="lineTotal"/>
<apex:variable value="{!rowSubtotalGroup05ColumnT+line.columns['T'].values['A']}" var="rowSubtotalGroup05ColumnT"/>
</apex:outputPanel>
<apex:outputPanel layout="none" rendered="{!RenderColumnU}">
<apex:variable value="{!lineTotal+line.columns['U'].values['A']}" var="lineTotal"/>
<apex:variable value="{!rowSubtotalGroup05ColumnU+line.columns['U'].values['A']}" var="rowSubtotalGroup05ColumnU"/>
</apex:outputPanel>
<apex:outputPanel layout="none" rendered="{!RenderColumnV}">
<apex:variable value="{!lineTotal+line.columns['V'].values['A']}" var="lineTotal"/>
<apex:variable value="{!rowSubtotalGroup05ColumnV+line.columns['V'].values['A']}" var="rowSubtotalGroup05ColumnV"/>
</apex:outputPanel>
<apex:outputPanel layout="none" rendered="{!RenderColumnW}">
<apex:variable value="{!lineTotal+line.columns['W'].values['A']}" var="lineTotal"/>
<apex:variable value="{!rowSubtotalGroup05ColumnW+line.columns['W'].values['A']}" var="rowSubtotalGroup05ColumnW"/>
</apex:outputPanel>
<apex:outputPanel layout="none" rendered="{!RenderColumnX}">
<apex:variable value="{!lineTotal+line.columns['X'].values['A']}" var="lineTotal"/>
<apex:variable value="{!rowSubtotalGroup05ColumnX+line.columns['X'].values['A']}" var="rowSubtotalGroup05ColumnX"/>
</apex:outputPanel>
<apex:outputPanel layout="none" rendered="{!RenderColumnY}">
<apex:variable value="{!lineTotal+line.columns['Y'].values['A']}" var="lineTotal"/>
<apex:variable value="{!rowSubtotalGroup05ColumnY+line.columns['Y'].values['A']}" var="rowSubtotalGroup05ColumnY"/>
</apex:outputPanel>
<apex:outputPanel layout="none" rendered="{!RenderColumnZ}">
<apex:variable value="{!lineTotal+line.columns['Z'].values['A']}" var="lineTotal"/>
<apex:variable value="{!rowSubtotalGroup05ColumnZ+line.columns['Z'].values['A']}" var="rowSubtotalGroup05ColumnZ"/>
</apex:outputPanel>
</td></tr>
<tr>
    <td class="{!if(RenderGroup02 && displayheader,'ffrcalcsumlabeld','ffrsubtotalhidden')}" colspan="11" style="text-indent: 20px;">
        <apex:outputPanel layout="none" rendered="{!RenderGroup02 && displayheader}">{!currentLineGroup02}</apex:outputPanel>
        <apex:variable var="displayheader" value="{!false}"/>

    </td>
    </tr>

<!-- Display the line -->
<tr>
<!-- Display the grouping values based on render settings -->
<!-- Group Lines for groups 1-5 (with sub-totals) are hidden - only the Subtotal Line will be displayed -->
<td class="{!if(RenderGroup10,'ffrgridrowlabeld','ffrhidden')}"><apex:outputPanel layout="none" rendered="{!RenderGroup10}">{!line.groups['10']}</apex:outputPanel></td>
<td class="{!if(RenderGroup11,'ffrgridrowlabeld','ffrhidden')}" style="text-indent: 40px;"><apex:outputPanel layout="none" rendered="{!RenderGroup11}">{!line.groups['11']}</apex:outputPanel></td>
<td class="{!if(RenderGroup12,'ffrgridrowlabeld','ffrhidden')}"><apex:outputPanel layout="none" rendered="{!RenderGroup12}">{!line.groups['12']}</apex:outputPanel></td>
<td class="{!if(RenderGroup13,'ffrgridrowlabeld','ffrhidden')}"><apex:outputPanel layout="none" rendered="{!RenderGroup13}">{!line.groups['13']}</apex:outputPanel></td>
<td class="{!if(RenderGroup14,'ffrgridrowlabeld','ffrhidden')}"><apex:outputPanel layout="none" rendered="{!RenderGroup14}">{!line.groups['14']}</apex:outputPanel></td>
<td class="{!if(RenderGroup15,'ffrgridrowlabeld','ffrhidden')}"><apex:outputPanel layout="none" rendered="{!RenderGroup15}">{!line.groups['15']}</apex:outputPanel></td>
<td class="{!if(RenderGroup16,'ffrgridrowlabeld','ffrhidden')}"><apex:outputPanel layout="none" rendered="{!RenderGroup16}">{!line.groups['16']}</apex:outputPanel></td>
<td class="{!if(RenderGroup17,'ffrgridrowlabeld','ffrhidden')}"><apex:outputPanel layout="none" rendered="{!RenderGroup17}">{!line.groups['17']}</apex:outputPanel></td>
<td class="{!if(RenderGroup18,'ffrgridrowlabeld','ffrhidden')}"><apex:outputPanel layout="none" rendered="{!RenderGroup18}">{!line.groups['18']}</apex:outputPanel></td>
<td class="{!if(RenderGroup19,'ffrgridrowlabeld','ffrhidden')}"><apex:outputPanel layout="none" rendered="{!RenderGroup19}">{!line.groups['19']}</apex:outputPanel></td>
<td class="{!if(RenderGroup20,'ffrgridrowlabeld','ffrhidden')}"><apex:outputPanel layout="none" rendered="{!RenderGroup20}">{!line.groups['20']}</apex:outputPanel></td>
<td class="ffrgridspacerd"/>
<!-- Each column is contained within an outputPanel which simply controls whether it is rendered: -->
<!-- Display the line value, formatted using a NumberFormatter component with the pattern defined above -->

<!-- This is the drill to the Transactiton List for Column A
{!label['L40']} is Which Period From = promplist value
{!label['L41']} is Which Period to = promptlist value
{!label['L43']} is General Ledger Account Name
{!label['L44']} is Transaction List Definition
{!label['L45']} is Transaction List Report
{!label['L46']} is Which Company
{!label['L47']} is Start Period
{!label['L48']} is End Period
{!line.groups['11']} is the general ledger account
{!dataRange.columnLabels['A']} is the year
-->

<td class="{!if(RenderColumnA,'ffrgridrowd','ffrsubtotalhidden')}">
    <apex:outputLink value="/apex/{!label['L49']}?DisplayCompanyLogo=false&ReportingLog={!label['L45']}&{!label['L40']}={!promptList[1].value}&{!label['L41']}={!promptList[1].value}&{!label['L46']}={!promptList[0].value}&{!label['L43']}={!line.groups['11']}&id={!label['L44']}" style="text-decoration: none;" target="_blank" rendered="{!RenderColumnA}">
        <apex:outputText value="{!if(line.columns['A'].values['A']==0,VZ,RowNumberPattern)}" rendered="{!RenderColumnA}">
            <apex:param value="{!line.columns['A'].values['A']}"/>
        </apex:outputText>
    </apex:outputLink>
</td>

<!-- This is the drill to the Transactiton List for Column B
{!label['L40']} is Which Period From = promptlist value
{!label['L41']} is Which Period to = left 4 of proptlist value and lable 47 
{!label['L43']} is General Ledger Account Name
{!label['L44']} is Transaction List Definition
{!label['L45']} is Transaction List Report
{!label['L46']} is Which Company
{!label['L47']} is Start Period
{!label['L48']} is End Period
{!line.groups['11']} is the general ledger account
{!dataRange.columnLabels['B']} is the year
-->
<td class="{!if(RenderColumnB,'ffrgridrowd','ffrsubtotalhidden')}">
    <apex:outputLink value="/apex/{!label['L49']}?DisplayCompanyLogo=false&ReportingLog={!label['L45']}&{!label['L40']}={!LEFT(promptList[1].value,4)}{!label['L47']}&{!label['L41']}={!promptList[1].value}&{!label['L46']}={!promptList[0].value}&{!label['L43']}={!line.groups['11']}&id={!label['L44']}" style="text-decoration: none;" target="_blank" rendered="{!RenderColumnB}">
        <apex:outputText value="{!if(line.columns['B'].values['A']==0,VZ,RowNumberPattern)}" rendered="{!RenderColumnB}">
            <apex:param value="{!line.columns['B'].values['A']}"/>
        </apex:outputText>
    </apex:outputLink>
</td>

<!--<td class="{!if(RenderColumnA && RenderColumnB,'ffrgridrowd','ffrsubtotalhidden')}">
<apex:outputText value="{!if((line.columns['A'].values['A']-line.columns['B'].values['A'])==0,VZ,RowNumberPattern)}" rendered="{!RenderColumnA && RenderColumnB}">
<apex:param value="{!(line.columns['A'].values['A']-line.columns['B'].values['A'])}"/>
</apex:outputText>
</td>
<td class="{!if(RenderColumnA && RenderColumnB,'ffrgridrowd','ffrsubtotalhidden')}">
<apex:outputText value="{!if(if(line.columns['B'].values['A']=0,if(line.columns['A'].values['A']=0,0,(line.columns['A'].values['A']-line.columns['B'].values['A'])/line.columns['A'].values['A']),(line.columns['A'].values['A']-line.columns['B'].values['A'])/line.columns['B'].values['A'])==0,PZ,RowPercentagePattern)}" rendered="{!RenderColumnA && RenderColumnB}">
<apex:param value="{!if(line.columns['B'].values['A']=0,if(line.columns['A'].values['A']=0,0,(line.columns['A'].values['A']-line.columns['B'].values['A'])/line.columns['A'].values['A']),(line.columns['A'].values['A']-line.columns['B'].values['A'])/line.columns['B'].values['A'])}"/>
</apex:outputText>
</td>-->
<td class="{!if(RenderColumnC,'ffrgridrowd','ffrsubtotalhidden')}">
<apex:outputText value="{!if(line.columns['C'].values['A']==0,VZ,RowNumberPattern)}" rendered="{!RenderColumnC}">
<apex:param value="{!line.columns['C'].values['A']}"/>
</apex:outputText>
</td>
<td class="{!if(RenderColumnD,'ffrgridrowd','ffrsubtotalhidden')}">
<apex:outputText value="{!if(line.columns['D'].values['A']==0,VZ,RowNumberPattern)}" rendered="{!RenderColumnD}">
<apex:param value="{!line.columns['D'].values['A']}"/>
</apex:outputText>
</td>
<!--<td class="{!if(RenderColumnC && RenderColumnD,'ffrgridrowd','ffrsubtotalhidden')}">
<apex:outputText value="{!if((line.columns['C'].values['A']-line.columns['D'].values['A'])==0,VZ,RowNumberPattern)}" rendered="{!RenderColumnC && RenderColumnD}">
<apex:param value="{!(line.columns['C'].values['A']-line.columns['D'].values['A'])}"/>
</apex:outputText>
</td>
<td class="{!if(RenderColumnC && RenderColumnD,'ffrgridrowd','ffrsubtotalhidden')}">
<apex:outputText value="{!if(if(line.columns['D'].values['A']=0,if(line.columns['C'].values['A']=0,0,(line.columns['C'].values['A']-line.columns['D'].values['A'])/line.columns['C'].values['A']),(line.columns['C'].values['A']-line.columns['D'].values['A'])/line.columns['D'].values['A'])==0,PZ,RowPercentagePattern)}" rendered="{!RenderColumnC && RenderColumnD}">
<apex:param value="{!if(line.columns['D'].values['A']=0,if(line.columns['C'].values['A']=0,0,(line.columns['C'].values['A']-line.columns['D'].values['A'])/line.columns['C'].values['A']),(line.columns['C'].values['A']-line.columns['D'].values['A'])/line.columns['D'].values['A'])}"/>
</apex:outputText>
</td>-->
<!--Standard lines from this area of the template-->
<td class="{!if(RenderColumnE,'ffrgridrowd','ffrsubtotalhidden')}">
<apex:outputText value="{!if(line.columns['E'].values['A']==0,VZ,RowNumberPattern)}" rendered="{!RenderColumnE}">
<apex:param value="{!line.columns['E'].values['A']}"/>
</apex:outputText>
</td>
<td class="{!if(RenderColumnF,'ffrgridrowd','ffrsubtotalhidden')}">
<apex:outputText value="{!if(line.columns['F'].values['A']==0,VZ,RowNumberPattern)}" rendered="{!RenderColumnF}">
<apex:param value="{!line.columns['F'].values['A']}"/>
</apex:outputText>
</td>
<td class="{!if(RenderColumnG,'ffrgridrowd','ffrsubtotalhidden')}">
<apex:outputText value="{!if(line.columns['G'].values['A']==0,VZ,RowNumberPattern)}" rendered="{!RenderColumnG}">
<apex:param value="{!line.columns['G'].values['A']}"/>
</apex:outputText>
</td>
<td class="{!if(RenderColumnH,'ffrgridrowd','ffrsubtotalhidden')}">
<apex:outputText value="{!if(line.columns['H'].values['A']==0,VZ,RowNumberPattern)}" rendered="{!RenderColumnH}">
<apex:param value="{!line.columns['H'].values['A']}"/>
</apex:outputText>
</td>
<td class="{!if(RenderColumnI,'ffrgridrowd','ffrsubtotalhidden')}">
<apex:outputText value="{!if(line.columns['I'].values['A']==0,VZ,RowNumberPattern)}" rendered="{!RenderColumnI}">
<apex:param value="{!line.columns['I'].values['A']}"/>
</apex:outputText>
</td>
<td class="{!if(RenderColumnJ,'ffrgridrowd','ffrsubtotalhidden')}">
<apex:outputText value="{!if(line.columns['J'].values['A']==0,VZ,RowNumberPattern)}" rendered="{!RenderColumnJ}">
<apex:param value="{!line.columns['J'].values['A']}"/>
</apex:outputText>
</td>
<td class="{!if(RenderColumnK,'ffrgridrowd','ffrsubtotalhidden')}">
<apex:outputText value="{!if(line.columns['K'].values['A']==0,VZ,RowNumberPattern)}" rendered="{!RenderColumnK}">
<apex:param value="{!line.columns['K'].values['A']}"/>
</apex:outputText>
</td>
<td class="{!if(RenderColumnL,'ffrgridrowd','ffrsubtotalhidden')}">
<apex:outputText value="{!if(line.columns['L'].values['A']==0,VZ,RowNumberPattern)}" rendered="{!RenderColumnL}">
<apex:param value="{!line.columns['L'].values['A']}"/>
</apex:outputText>
</td>
<td class="{!if(RenderColumnM,'ffrgridrowd','ffrsubtotalhidden')}">
<apex:outputText value="{!if(line.columns['M'].values['A']==0,VZ,RowNumberPattern)}" rendered="{!RenderColumnM}">
<apex:param value="{!line.columns['M'].values['A']}"/>
</apex:outputText>
</td>
<td class="{!if(RenderColumnN,'ffrgridrowd','ffrsubtotalhidden')}">
<apex:outputText value="{!if(line.columns['N'].values['A']==0,VZ,RowNumberPattern)}" rendered="{!RenderColumnN}">
<apex:param value="{!line.columns['N'].values['A']}"/>
</apex:outputText>
</td>
<td class="{!if(RenderColumnO,'ffrgridrowd','ffrsubtotalhidden')}">
<apex:outputText value="{!if(line.columns['O'].values['A']==0,VZ,RowNumberPattern)}" rendered="{!RenderColumnO}">
<apex:param value="{!line.columns['O'].values['A']}"/>
</apex:outputText>
</td>
<td class="{!if(RenderColumnP,'ffrgridrowd','ffrsubtotalhidden')}">
<apex:outputText value="{!if(line.columns['P'].values['A']==0,VZ,RowNumberPattern)}" rendered="{!RenderColumnP}">
<apex:param value="{!line.columns['P'].values['A']}"/>
</apex:outputText>
</td>
<td class="{!if(RenderColumnQ,'ffrgridrowd','ffrsubtotalhidden')}">
<apex:outputText value="{!if(line.columns['Q'].values['A']==0,VZ,RowNumberPattern)}" rendered="{!RenderColumnQ}">
<apex:param value="{!line.columns['Q'].values['A']}"/>
</apex:outputText>
</td>
<td class="{!if(RenderColumnR,'ffrgridrowd','ffrsubtotalhidden')}">
<apex:outputText value="{!if(line.columns['R'].values['A']==0,VZ,RowNumberPattern)}" rendered="{!RenderColumnR}">
<apex:param value="{!line.columns['R'].values['A']}"/>
</apex:outputText>
</td>
<td class="{!if(RenderColumnS,'ffrgridrowd','ffrsubtotalhidden')}">
<apex:outputText value="{!if(line.columns['S'].values['A']==0,VZ,RowNumberPattern)}" rendered="{!RenderColumnS}">
<apex:param value="{!line.columns['S'].values['A']}"/>
</apex:outputText>
</td>
<td class="{!if(RenderColumnT,'ffrgridrowd','ffrsubtotalhidden')}">
<apex:outputText value="{!if(line.columns['T'].values['A']==0,VZ,RowNumberPattern)}" rendered="{!RenderColumnT}">
<apex:param value="{!line.columns['T'].values['A']}"/>
</apex:outputText>
</td>
<td class="{!if(RenderColumnU,'ffrgridrowd','ffrsubtotalhidden')}">
<apex:outputText value="{!if(line.columns['U'].values['A']==0,VZ,RowNumberPattern)}" rendered="{!RenderColumnU}">
<apex:param value="{!line.columns['U'].values['A']}"/>
</apex:outputText>
</td>
<td class="{!if(RenderColumnV,'ffrgridrowd','ffrsubtotalhidden')}">
<apex:outputText value="{!if(line.columns['V'].values['A']==0,VZ,RowNumberPattern)}" rendered="{!RenderColumnV}">
<apex:param value="{!line.columns['V'].values['A']}"/>
</apex:outputText>
</td>
<td class="{!if(RenderColumnW,'ffrgridrowd','ffrsubtotalhidden')}">
<apex:outputText value="{!if(line.columns['W'].values['A']==0,VZ,RowNumberPattern)}" rendered="{!RenderColumnW}">
<apex:param value="{!line.columns['W'].values['A']}"/>
</apex:outputText>
</td>
<td class="{!if(RenderColumnX,'ffrgridrowd','ffrsubtotalhidden')}">
<apex:outputText value="{!if(line.columns['X'].values['A']==0,VZ,RowNumberPattern)}" rendered="{!RenderColumnX}">
<apex:param value="{!line.columns['X'].values['A']}"/>
</apex:outputText>
</td>
<td class="{!if(RenderColumnY,'ffrgridrowd','ffrsubtotalhidden')}">
<apex:outputText value="{!if(line.columns['Y'].values['A']==0,VZ,RowNumberPattern)}" rendered="{!RenderColumnY}">
<apex:param value="{!line.columns['Y'].values['A']}"/>
</apex:outputText>
</td>
<td class="{!if(RenderColumnZ,'ffrgridrowd','ffrsubtotalhidden')}">
<apex:outputText value="{!if(line.columns['Z'].values['A']==0,VZ,RowNumberPattern)}" rendered="{!RenderColumnZ}">
<apex:param value="{!line.columns['Z'].values['A']}"/>
</apex:outputText>
</td>
<!-- Columns Total -->
<!-- Running Total is blank at line level -->
</tr>
<!-- Setup for next line -->
<!-- Record the group values as "previous" for comparison on the next line -->
<tr><td class="ffrhidden">
<apex:variable var="previousLineGroup02" value="{!currentLineGroup02}"/>
<apex:variable var="previousLineGroup03" value="{!currentLineGroup03}"/>
<apex:variable var="previousLineGroup04" value="{!currentLineGroup04}"/>
<apex:variable var="previousLineGroup05" value="{!currentLineGroup05}"/>
<!-- If this was the first line, it was completed, so set first line to false -->
<apex:variable var="firstLine" value="{!false}" rendered="{!firstLine}" />
</td></tr>
<!-- Add the values to the row-column totals -->
</apex:outputPanel>

<apex:outputPanel layout="none" rendered="{!RenderColumnA}">
<apex:variable value="{!rowTotalColumnA+line.columns['A'].values['A']}" var="rowTotalColumnA"/>
</apex:outputPanel>
<apex:outputPanel layout="none" rendered="{!RenderColumnB}">
<apex:variable value="{!rowTotalColumnB+line.columns['B'].values['A']}" var="rowTotalColumnB"/>
</apex:outputPanel>
<apex:outputPanel layout="none" rendered="{!RenderColumnC}">
<apex:variable value="{!rowTotalColumnC+line.columns['C'].values['A']}" var="rowTotalColumnC"/>
</apex:outputPanel>
<apex:outputPanel layout="none" rendered="{!RenderColumnD}">
<apex:variable value="{!rowTotalColumnD+line.columns['D'].values['A']}" var="rowTotalColumnD"/>
</apex:outputPanel>
<apex:outputPanel layout="none" rendered="{!RenderColumnE}">
<apex:variable value="{!rowTotalColumnE+line.columns['E'].values['A']}" var="rowTotalColumnE"/>
</apex:outputPanel>
<apex:outputPanel layout="none" rendered="{!RenderColumnF}">
<apex:variable value="{!rowTotalColumnF+line.columns['F'].values['A']}" var="rowTotalColumnF"/>
</apex:outputPanel>
<apex:outputPanel layout="none" rendered="{!RenderColumnG}">
<apex:variable value="{!rowTotalColumnG+line.columns['G'].values['A']}" var="rowTotalColumnG"/>
</apex:outputPanel>
<apex:outputPanel layout="none" rendered="{!RenderColumnH}">
<apex:variable value="{!rowTotalColumnH+line.columns['H'].values['A']}" var="rowTotalColumnH"/>
</apex:outputPanel>
<apex:outputPanel layout="none" rendered="{!RenderColumnI}">
<apex:variable value="{!rowTotalColumnI+line.columns['I'].values['A']}" var="rowTotalColumnI"/>
</apex:outputPanel>
<apex:outputPanel layout="none" rendered="{!RenderColumnJ}">
<apex:variable value="{!rowTotalColumnJ+line.columns['J'].values['A']}" var="rowTotalColumnJ"/>
</apex:outputPanel>
<apex:outputPanel layout="none" rendered="{!RenderColumnK}">
<apex:variable value="{!rowTotalColumnK+line.columns['K'].values['A']}" var="rowTotalColumnK"/>
</apex:outputPanel>
<apex:outputPanel layout="none" rendered="{!RenderColumnL}">
<apex:variable value="{!rowTotalColumnL+line.columns['L'].values['A']}" var="rowTotalColumnL"/>
</apex:outputPanel>
<apex:outputPanel layout="none" rendered="{!RenderColumnM}">
<apex:variable value="{!rowTotalColumnM+line.columns['M'].values['A']}" var="rowTotalColumnM"/>
</apex:outputPanel>
<apex:outputPanel layout="none" rendered="{!RenderColumnN}">
<apex:variable value="{!rowTotalColumnN+line.columns['N'].values['A']}" var="rowTotalColumnN"/>
</apex:outputPanel>
<apex:outputPanel layout="none" rendered="{!RenderColumnO}">
<apex:variable value="{!rowTotalColumnO+line.columns['O'].values['A']}" var="rowTotalColumnO"/>
</apex:outputPanel>
<apex:outputPanel layout="none" rendered="{!RenderColumnP}">
<apex:variable value="{!rowTotalColumnP+line.columns['P'].values['A']}" var="rowTotalColumnP"/>
</apex:outputPanel>
<apex:outputPanel layout="none" rendered="{!RenderColumnQ}">
<apex:variable value="{!rowTotalColumnQ+line.columns['Q'].values['A']}" var="rowTotalColumnQ"/>
</apex:outputPanel>
<apex:outputPanel layout="none" rendered="{!RenderColumnR}">
<apex:variable value="{!rowTotalColumnR+line.columns['R'].values['A']}" var="rowTotalColumnR"/>
</apex:outputPanel>
<apex:outputPanel layout="none" rendered="{!RenderColumnS}">
<apex:variable value="{!rowTotalColumnS+line.columns['S'].values['A']}" var="rowTotalColumnS"/>
</apex:outputPanel>
<apex:outputPanel layout="none" rendered="{!RenderColumnT}">
<apex:variable value="{!rowTotalColumnT+line.columns['T'].values['A']}" var="rowTotalColumnT"/>
</apex:outputPanel>
<apex:outputPanel layout="none" rendered="{!RenderColumnU}">
<apex:variable value="{!rowTotalColumnU+line.columns['U'].values['A']}" var="rowTotalColumnU"/>
</apex:outputPanel>
<apex:outputPanel layout="none" rendered="{!RenderColumnV}">
<apex:variable value="{!rowTotalColumnV+line.columns['V'].values['A']}" var="rowTotalColumnV"/>
</apex:outputPanel>
<apex:outputPanel layout="none" rendered="{!RenderColumnW}">
<apex:variable value="{!rowTotalColumnW+line.columns['W'].values['A']}" var="rowTotalColumnW"/>
</apex:outputPanel>
<apex:outputPanel layout="none" rendered="{!RenderColumnX}">
<apex:variable value="{!rowTotalColumnX+line.columns['X'].values['A']}" var="rowTotalColumnX"/>
</apex:outputPanel>
<apex:outputPanel layout="none" rendered="{!RenderColumnY}">
<apex:variable value="{!rowTotalColumnY+line.columns['Y'].values['A']}" var="rowTotalColumnY"/>
</apex:outputPanel>
<apex:outputPanel layout="none" rendered="{!RenderColumnZ}">
<apex:variable value="{!rowTotalColumnZ+line.columns['Z'].values['A']}" var="rowTotalColumnZ"/>
</apex:outputPanel>
</apex:repeat>
<!-- Go to next line -->
<!-- Do we want to process an end-of-row subtotal line? (only required for rows 1-99) -->
<apex:outputPanel layout="none" rendered="{!rowKeyNum<=91 && RenderGroupSubtotals}">
<!-- Display the group-group values but not the group-line values if Group05 is rendered -->
<!-- Set calculated values as variables (for ease of use) -->
<apex:variable value="{!(rowSubtotalGroup05ColumnA-rowSubtotalGroup05ColumnB)}" var="rowSubtotalGroup05VarianceAB"/>
<apex:variable value="{!(rowSubtotalGroup05ColumnC-rowSubtotalGroup05ColumnD)}" var="rowSubtotalGroup05VarianceCD"/>
<apex:variable value="{!if(rowSubtotalGroup05ColumnB=0,(if(rowSubtotalGroup05ColumnA=0,0,(rowSubtotalGroup05VarianceAB/rowSubtotalGroup05ColumnA))),(rowSubtotalGroup05VarianceAB/rowSubtotalGroup05ColumnB))}" var="rowSubtotalGroup05VariancePercAB"/>
<apex:variable value="{!if(rowSubtotalGroup05ColumnD=0,(if(rowSubtotalGroup05ColumnC=0,0,(rowSubtotalGroup05VarianceCD/rowSubtotalGroup05ColumnC))),(rowSubtotalGroup05VarianceCD/rowSubtotalGroup05ColumnD))}" var="rowSubtotalGroup05VariancePercCD"/>
<tr>
<td class="{!if(RenderGroup05,'ffrsubtotallabeld','ffrsubtotalhidden')}" colspan="11">
<apex:outputPanel layout="none" rendered="{!RenderGroup05}">{!previousLineGroup05}</apex:outputPanel></td>
<td class="{!if(RenderGroup05,'ffrgridspacerd','ffrsubtotalhidden')}"></td>
<td class="{!if(RenderGroup05 && RenderColumnA,'ffrsubtotald','ffrsubtotalhidden')}"><apex:outputText value="{!if(rowSubtotalGroup05ColumnA==0,VZ,RowNumberPattern)}" rendered="{!RenderGroup05 && RenderColumnA}"><apex:param value="{!rowSubtotalGroup05ColumnA}"/></apex:outputText></td>
<td class="{!if(RenderGroup05 && RenderColumnB,'ffrsubtotald','ffrsubtotalhidden')}"><apex:outputText value="{!if(rowSubtotalGroup05ColumnB==0,VZ,RowNumberPattern)}" rendered="{!RenderGroup05 && RenderColumnB}"><apex:param value="{!rowSubtotalGroup05ColumnB}"/></apex:outputText></td>
<!--<td class="{!if(RenderGroup05 && RenderColumnA && RenderColumnB,'ffrsubtotald','ffrsubtotalhidden')}"><apex:outputText value="{!if(rowSubtotalGroup05VarianceAB==0,VZ,RowNumberPattern)}" rendered="{!RenderGroup05 && RenderColumnA && RenderColumnB}"><apex:param value="{!rowSubtotalGroup05VarianceAB}"/></apex:outputText></td>
<td class="{!if(RenderGroup05 && RenderColumnA && RenderColumnB,'ffrsubtotald','ffrsubtotalhidden')}"><apex:outputText value="{!if(rowSubtotalGroup05VariancePercAB==0,PZ,RowPercentagePattern)}" rendered="{!RenderGroup05 && RenderColumnA && RenderColumnB}"><apex:param value="{!rowSubtotalGroup05VariancePercAB}"/></apex:outputText></td> -->
<td class="{!if(RenderGroup05 && RenderColumnC,'ffrsubtotald','ffrsubtotalhidden')}"><apex:outputText value="{!if(rowSubtotalGroup05ColumnC==0,VZ,RowNumberPattern)}" rendered="{!RenderGroup05 && RenderColumnC}"><apex:param value="{!rowSubtotalGroup05ColumnC}"/></apex:outputText></td>
<td class="{!if(RenderGroup05 && RenderColumnD,'ffrsubtotald','ffrsubtotalhidden')}"><apex:outputText value="{!if(rowSubtotalGroup05ColumnD==0,VZ,RowNumberPattern)}" rendered="{!RenderGroup05 && RenderColumnD}"><apex:param value="{!rowSubtotalGroup05ColumnD}"/></apex:outputText></td>
<!--<td class="{!if(RenderGroup05 && RenderColumnC && RenderColumnD,'ffrsubtotald','ffrsubtotalhidden')}"><apex:outputText value="{!if(rowSubtotalGroup05VarianceCD==0,VZ,RowNumberPattern)}" rendered="{!RenderGroup05 && RenderColumnC && RenderColumnD}"><apex:param value="{!rowSubtotalGroup05VarianceCD}"/></apex:outputText></td>
<td class="{!if(RenderGroup05 && RenderColumnC && RenderColumnD,'ffrsubtotald','ffrsubtotalhidden')}"><apex:outputText value="{!if(rowSubtotalGroup05VariancePercCD==0,PZ,RowPercentagePattern)}" rendered="{!RenderGroup05 && RenderColumnC && RenderColumnD}"><apex:param value="{!rowSubtotalGroup05VariancePercCD}"/></apex:outputText></td>-->
<!--Standard lines from this area of the template-->
<td class="{!if(RenderGroup05 && RenderColumnE,'ffrsubtotald','ffrsubtotalhidden')}"><apex:outputText value="{!if(rowSubtotalGroup05ColumnE==0,VZ,RowNumberPattern)}" rendered="{!RenderGroup05 && RenderColumnE}"><apex:param value="{!rowSubtotalGroup05ColumnE}"/></apex:outputText></td>
<td class="{!if(RenderGroup05 && RenderColumnF,'ffrsubtotald','ffrsubtotalhidden')}"><apex:outputText value="{!if(rowSubtotalGroup05ColumnF==0,VZ,RowNumberPattern)}" rendered="{!RenderGroup05 && RenderColumnF}"><apex:param value="{!rowSubtotalGroup05ColumnF}"/></apex:outputText></td>
<td class="{!if(RenderGroup05 && RenderColumnG,'ffrsubtotald','ffrsubtotalhidden')}"><apex:outputText value="{!if(rowSubtotalGroup05ColumnG==0,VZ,RowNumberPattern)}" rendered="{!RenderGroup05 && RenderColumnG}"><apex:param value="{!rowSubtotalGroup05ColumnG}"/></apex:outputText></td>
<td class="{!if(RenderGroup05 && RenderColumnH,'ffrsubtotald','ffrsubtotalhidden')}"><apex:outputText value="{!if(rowSubtotalGroup05ColumnH==0,VZ,RowNumberPattern)}" rendered="{!RenderGroup05 && RenderColumnH}"><apex:param value="{!rowSubtotalGroup05ColumnH}"/></apex:outputText></td>
<td class="{!if(RenderGroup05 && RenderColumnI,'ffrsubtotald','ffrsubtotalhidden')}"><apex:outputText value="{!if(rowSubtotalGroup05ColumnI==0,VZ,RowNumberPattern)}" rendered="{!RenderGroup05 && RenderColumnI}"><apex:param value="{!rowSubtotalGroup05ColumnI}"/></apex:outputText></td>
<td class="{!if(RenderGroup05 && RenderColumnJ,'ffrsubtotald','ffrsubtotalhidden')}"><apex:outputText value="{!if(rowSubtotalGroup05ColumnJ==0,VZ,RowNumberPattern)}" rendered="{!RenderGroup05 && RenderColumnJ}"><apex:param value="{!rowSubtotalGroup05ColumnJ}"/></apex:outputText></td>
<td class="{!if(RenderGroup05 && RenderColumnK,'ffrsubtotald','ffrsubtotalhidden')}"><apex:outputText value="{!if(rowSubtotalGroup05ColumnK==0,VZ,RowNumberPattern)}" rendered="{!RenderGroup05 && RenderColumnK}"><apex:param value="{!rowSubtotalGroup05ColumnK}"/></apex:outputText></td>
<td class="{!if(RenderGroup05 && RenderColumnL,'ffrsubtotald','ffrsubtotalhidden')}"><apex:outputText value="{!if(rowSubtotalGroup05ColumnL==0,VZ,RowNumberPattern)}" rendered="{!RenderGroup05 && RenderColumnL}"><apex:param value="{!rowSubtotalGroup05ColumnL}"/></apex:outputText></td>
<td class="{!if(RenderGroup05 && RenderColumnM,'ffrsubtotald','ffrsubtotalhidden')}"><apex:outputText value="{!if(rowSubtotalGroup05ColumnM==0,VZ,RowNumberPattern)}" rendered="{!RenderGroup05 && RenderColumnM}"><apex:param value="{!rowSubtotalGroup05ColumnM}"/></apex:outputText></td>
<td class="{!if(RenderGroup05 && RenderColumnN,'ffrsubtotald','ffrsubtotalhidden')}"><apex:outputText value="{!if(rowSubtotalGroup05ColumnN==0,VZ,RowNumberPattern)}" rendered="{!RenderGroup05 && RenderColumnN}"><apex:param value="{!rowSubtotalGroup05ColumnN}"/></apex:outputText></td>
<td class="{!if(RenderGroup05 && RenderColumnO,'ffrsubtotald','ffrsubtotalhidden')}"><apex:outputText value="{!if(rowSubtotalGroup05ColumnO==0,VZ,RowNumberPattern)}" rendered="{!RenderGroup05 && RenderColumnO}"><apex:param value="{!rowSubtotalGroup05ColumnO}"/></apex:outputText></td>
<td class="{!if(RenderGroup05 && RenderColumnP,'ffrsubtotald','ffrsubtotalhidden')}"><apex:outputText value="{!if(rowSubtotalGroup05ColumnP==0,VZ,RowNumberPattern)}" rendered="{!RenderGroup05 && RenderColumnP}"><apex:param value="{!rowSubtotalGroup05ColumnP}"/></apex:outputText></td>
<td class="{!if(RenderGroup05 && RenderColumnQ,'ffrsubtotald','ffrsubtotalhidden')}"><apex:outputText value="{!if(rowSubtotalGroup05ColumnQ==0,VZ,RowNumberPattern)}" rendered="{!RenderGroup05 && RenderColumnQ}"><apex:param value="{!rowSubtotalGroup05ColumnQ}"/></apex:outputText></td>
<td class="{!if(RenderGroup05 && RenderColumnR,'ffrsubtotald','ffrsubtotalhidden')}"><apex:outputText value="{!if(rowSubtotalGroup05ColumnR==0,VZ,RowNumberPattern)}" rendered="{!RenderGroup05 && RenderColumnR}"><apex:param value="{!rowSubtotalGroup05ColumnR}"/></apex:outputText></td>
<td class="{!if(RenderGroup05 && RenderColumnS,'ffrsubtotald','ffrsubtotalhidden')}"><apex:outputText value="{!if(rowSubtotalGroup05ColumnS==0,VZ,RowNumberPattern)}" rendered="{!RenderGroup05 && RenderColumnS}"><apex:param value="{!rowSubtotalGroup05ColumnS}"/></apex:outputText></td>
<td class="{!if(RenderGroup05 && RenderColumnT,'ffrsubtotald','ffrsubtotalhidden')}"><apex:outputText value="{!if(rowSubtotalGroup05ColumnT==0,VZ,RowNumberPattern)}" rendered="{!RenderGroup05 && RenderColumnT}"><apex:param value="{!rowSubtotalGroup05ColumnT}"/></apex:outputText></td>
<td class="{!if(RenderGroup05 && RenderColumnU,'ffrsubtotald','ffrsubtotalhidden')}"><apex:outputText value="{!if(rowSubtotalGroup05ColumnU==0,VZ,RowNumberPattern)}" rendered="{!RenderGroup05 && RenderColumnU}"><apex:param value="{!rowSubtotalGroup05ColumnU}"/></apex:outputText></td>
<td class="{!if(RenderGroup05 && RenderColumnV,'ffrsubtotald','ffrsubtotalhidden')}"><apex:outputText value="{!if(rowSubtotalGroup05ColumnV==0,VZ,RowNumberPattern)}" rendered="{!RenderGroup05 && RenderColumnV}"><apex:param value="{!rowSubtotalGroup05ColumnV}"/></apex:outputText></td>
<td class="{!if(RenderGroup05 && RenderColumnW,'ffrsubtotald','ffrsubtotalhidden')}"><apex:outputText value="{!if(rowSubtotalGroup05ColumnW==0,VZ,RowNumberPattern)}" rendered="{!RenderGroup05 && RenderColumnW}"><apex:param value="{!rowSubtotalGroup05ColumnW}"/></apex:outputText></td>
<td class="{!if(RenderGroup05 && RenderColumnX,'ffrsubtotald','ffrsubtotalhidden')}"><apex:outputText value="{!if(rowSubtotalGroup05ColumnX==0,VZ,RowNumberPattern)}" rendered="{!RenderGroup05 && RenderColumnX}"><apex:param value="{!rowSubtotalGroup05ColumnX}"/></apex:outputText></td>
<td class="{!if(RenderGroup05 && RenderColumnY,'ffrsubtotald','ffrsubtotalhidden')}"><apex:outputText value="{!if(rowSubtotalGroup05ColumnY==0,VZ,RowNumberPattern)}" rendered="{!RenderGroup05 && RenderColumnY}"><apex:param value="{!rowSubtotalGroup05ColumnY}"/></apex:outputText></td>
<td class="{!if(RenderGroup05 && RenderColumnZ,'ffrsubtotald','ffrsubtotalhidden')}"><apex:outputText value="{!if(rowSubtotalGroup05ColumnZ==0,VZ,RowNumberPattern)}" rendered="{!RenderGroup05 && RenderColumnZ}"><apex:param value="{!rowSubtotalGroup05ColumnZ}"/></apex:outputText></td>
</tr>
<!-- Display the group-group values but not the group-line values if Group04 is rendered -->
<!-- Set calculated values as variables (for ease of use) -->
<apex:variable value="{!(rowSubtotalGroup04ColumnA-rowSubtotalGroup04ColumnB)}" var="rowSubtotalGroup04VarianceAB"/>
<apex:variable value="{!(rowSubtotalGroup04ColumnC-rowSubtotalGroup04ColumnD)}" var="rowSubtotalGroup04VarianceCD"/>
<apex:variable value="{!if(rowSubtotalGroup04ColumnB=0,(if(rowSubtotalGroup04ColumnA=0,0,(rowSubtotalGroup04VarianceAB/rowSubtotalGroup04ColumnA))),(rowSubtotalGroup04VarianceAB/rowSubtotalGroup04ColumnB))}" var="rowSubtotalGroup04VariancePercAB"/>
<apex:variable value="{!if(rowSubtotalGroup04ColumnD=0,(if(rowSubtotalGroup04ColumnC=0,0,(rowSubtotalGroup04VarianceCD/rowSubtotalGroup04ColumnC))),(rowSubtotalGroup04VarianceCD/rowSubtotalGroup04ColumnD))}" var="rowSubtotalGroup04VariancePercCD"/>
<tr>
<td class="{!if(RenderGroup04,'ffrsubtotallabeld','ffrsubtotalhidden')}" colspan="11">
<apex:outputPanel layout="none" rendered="{!RenderGroup04}">{!previousLineGroup04}</apex:outputPanel></td>
<td class="{!if(RenderGroup04,'ffrgridspacerd','ffrsubtotalhidden')}"></td>
<td class="{!if(RenderGroup04 && RenderColumnA,'ffrsubtotald','ffrsubtotalhidden')}"><apex:outputText value="{!if(rowSubtotalGroup04ColumnA==0,VZ,RowNumberPattern)}" rendered="{!RenderGroup04 && RenderColumnA}"><apex:param value="{!rowSubtotalGroup04ColumnA}"/></apex:outputText></td>
<td class="{!if(RenderGroup04 && RenderColumnB,'ffrsubtotald','ffrsubtotalhidden')}"><apex:outputText value="{!if(rowSubtotalGroup04ColumnB==0,VZ,RowNumberPattern)}" rendered="{!RenderGroup04 && RenderColumnB}"><apex:param value="{!rowSubtotalGroup04ColumnB}"/></apex:outputText></td>
<!--<td class="{!if(RenderGroup04 && RenderColumnA && RenderColumnB,'ffrsubtotald','ffrsubtotalhidden')}"><apex:outputText value="{!if(rowSubtotalGroup04VarianceAB==0,VZ,RowNumberPattern)}" rendered="{!RenderGroup04 && RenderColumnA && RenderColumnB}"><apex:param value="{!rowSubtotalGroup04VarianceAB}"/></apex:outputText></td>
<td class="{!if(RenderGroup04 && RenderColumnA && RenderColumnB,'ffrsubtotald','ffrsubtotalhidden')}"><apex:outputText value="{!if(rowSubtotalGroup04VariancePercAB==0,PZ,RowPercentagePattern)}" rendered="{!RenderGroup04 && RenderColumnA && RenderColumnB}"><apex:param value="{!rowSubtotalGroup04VariancePercAB}"/></apex:outputText></td>-->
<td class="{!if(RenderGroup04 && RenderColumnC,'ffrsubtotald','ffrsubtotalhidden')}"><apex:outputText value="{!if(rowSubtotalGroup04ColumnC==0,VZ,RowNumberPattern)}" rendered="{!RenderGroup04 && RenderColumnC}"><apex:param value="{!rowSubtotalGroup04ColumnC}"/></apex:outputText></td>
<td class="{!if(RenderGroup04 && RenderColumnD,'ffrsubtotald','ffrsubtotalhidden')}"><apex:outputText value="{!if(rowSubtotalGroup04ColumnD==0,VZ,RowNumberPattern)}" rendered="{!RenderGroup04 && RenderColumnD}"><apex:param value="{!rowSubtotalGroup04ColumnD}"/></apex:outputText></td>
<!--<td class="{!if(RenderGroup04 && RenderColumnC && RenderColumnD,'ffrsubtotald','ffrsubtotalhidden')}"><apex:outputText value="{!if(rowSubtotalGroup04VarianceCD==0,VZ,RowNumberPattern)}" rendered="{!RenderGroup04 && RenderColumnC && RenderColumnD}"><apex:param value="{!rowSubtotalGroup04VarianceCD}"/></apex:outputText></td>
<td class="{!if(RenderGroup04 && RenderColumnC && RenderColumnD,'ffrsubtotald','ffrsubtotalhidden')}"><apex:outputText value="{!if(rowSubtotalGroup04VariancePercCD==0,PZ,RowPercentagePattern)}" rendered="{!RenderGroup04 && RenderColumnC && RenderColumnD}"><apex:param value="{!rowSubtotalGroup04VariancePercCD}"/></apex:outputText></td>-->
<!--Standard lines from this area of the template-->
<td class="{!if(RenderGroup04 && RenderColumnE,'ffrsubtotald','ffrsubtotalhidden')}"><apex:outputText value="{!if(rowSubtotalGroup04ColumnE==0,VZ,RowNumberPattern)}" rendered="{!RenderGroup04 && RenderColumnE}"><apex:param value="{!rowSubtotalGroup04ColumnE}"/></apex:outputText></td>
<td class="{!if(RenderGroup04 && RenderColumnF,'ffrsubtotald','ffrsubtotalhidden')}"><apex:outputText value="{!if(rowSubtotalGroup04ColumnF==0,VZ,RowNumberPattern)}" rendered="{!RenderGroup04 && RenderColumnF}"><apex:param value="{!rowSubtotalGroup04ColumnF}"/></apex:outputText></td>
<td class="{!if(RenderGroup04 && RenderColumnG,'ffrsubtotald','ffrsubtotalhidden')}"><apex:outputText value="{!if(rowSubtotalGroup04ColumnG==0,VZ,RowNumberPattern)}" rendered="{!RenderGroup04 && RenderColumnG}"><apex:param value="{!rowSubtotalGroup04ColumnG}"/></apex:outputText></td>
<td class="{!if(RenderGroup04 && RenderColumnH,'ffrsubtotald','ffrsubtotalhidden')}"><apex:outputText value="{!if(rowSubtotalGroup04ColumnH==0,VZ,RowNumberPattern)}" rendered="{!RenderGroup04 && RenderColumnH}"><apex:param value="{!rowSubtotalGroup04ColumnH}"/></apex:outputText></td>
<td class="{!if(RenderGroup04 && RenderColumnI,'ffrsubtotald','ffrsubtotalhidden')}"><apex:outputText value="{!if(rowSubtotalGroup04ColumnI==0,VZ,RowNumberPattern)}" rendered="{!RenderGroup04 && RenderColumnI}"><apex:param value="{!rowSubtotalGroup04ColumnI}"/></apex:outputText></td>
<td class="{!if(RenderGroup04 && RenderColumnJ,'ffrsubtotald','ffrsubtotalhidden')}"><apex:outputText value="{!if(rowSubtotalGroup04ColumnJ==0,VZ,RowNumberPattern)}" rendered="{!RenderGroup04 && RenderColumnJ}"><apex:param value="{!rowSubtotalGroup04ColumnJ}"/></apex:outputText></td>
<td class="{!if(RenderGroup04 && RenderColumnK,'ffrsubtotald','ffrsubtotalhidden')}"><apex:outputText value="{!if(rowSubtotalGroup04ColumnK==0,VZ,RowNumberPattern)}" rendered="{!RenderGroup04 && RenderColumnK}"><apex:param value="{!rowSubtotalGroup04ColumnK}"/></apex:outputText></td>
<td class="{!if(RenderGroup04 && RenderColumnL,'ffrsubtotald','ffrsubtotalhidden')}"><apex:outputText value="{!if(rowSubtotalGroup04ColumnL==0,VZ,RowNumberPattern)}" rendered="{!RenderGroup04 && RenderColumnL}"><apex:param value="{!rowSubtotalGroup04ColumnL}"/></apex:outputText></td>
<td class="{!if(RenderGroup04 && RenderColumnM,'ffrsubtotald','ffrsubtotalhidden')}"><apex:outputText value="{!if(rowSubtotalGroup04ColumnM==0,VZ,RowNumberPattern)}" rendered="{!RenderGroup04 && RenderColumnM}"><apex:param value="{!rowSubtotalGroup04ColumnM}"/></apex:outputText></td>
<td class="{!if(RenderGroup04 && RenderColumnN,'ffrsubtotald','ffrsubtotalhidden')}"><apex:outputText value="{!if(rowSubtotalGroup04ColumnN==0,VZ,RowNumberPattern)}" rendered="{!RenderGroup04 && RenderColumnN}"><apex:param value="{!rowSubtotalGroup04ColumnN}"/></apex:outputText></td>
<td class="{!if(RenderGroup04 && RenderColumnO,'ffrsubtotald','ffrsubtotalhidden')}"><apex:outputText value="{!if(rowSubtotalGroup04ColumnO==0,VZ,RowNumberPattern)}" rendered="{!RenderGroup04 && RenderColumnO}"><apex:param value="{!rowSubtotalGroup04ColumnO}"/></apex:outputText></td>
<td class="{!if(RenderGroup04 && RenderColumnP,'ffrsubtotald','ffrsubtotalhidden')}"><apex:outputText value="{!if(rowSubtotalGroup04ColumnP==0,VZ,RowNumberPattern)}" rendered="{!RenderGroup04 && RenderColumnP}"><apex:param value="{!rowSubtotalGroup04ColumnP}"/></apex:outputText></td>
<td class="{!if(RenderGroup04 && RenderColumnQ,'ffrsubtotald','ffrsubtotalhidden')}"><apex:outputText value="{!if(rowSubtotalGroup04ColumnQ==0,VZ,RowNumberPattern)}" rendered="{!RenderGroup04 && RenderColumnQ}"><apex:param value="{!rowSubtotalGroup04ColumnQ}"/></apex:outputText></td>
<td class="{!if(RenderGroup04 && RenderColumnR,'ffrsubtotald','ffrsubtotalhidden')}"><apex:outputText value="{!if(rowSubtotalGroup04ColumnR==0,VZ,RowNumberPattern)}" rendered="{!RenderGroup04 && RenderColumnR}"><apex:param value="{!rowSubtotalGroup04ColumnR}"/></apex:outputText></td>
<td class="{!if(RenderGroup04 && RenderColumnS,'ffrsubtotald','ffrsubtotalhidden')}"><apex:outputText value="{!if(rowSubtotalGroup04ColumnS==0,VZ,RowNumberPattern)}" rendered="{!RenderGroup04 && RenderColumnS}"><apex:param value="{!rowSubtotalGroup04ColumnS}"/></apex:outputText></td>
<td class="{!if(RenderGroup04 && RenderColumnT,'ffrsubtotald','ffrsubtotalhidden')}"><apex:outputText value="{!if(rowSubtotalGroup04ColumnT==0,VZ,RowNumberPattern)}" rendered="{!RenderGroup04 && RenderColumnT}"><apex:param value="{!rowSubtotalGroup04ColumnT}"/></apex:outputText></td>
<td class="{!if(RenderGroup04 && RenderColumnU,'ffrsubtotald','ffrsubtotalhidden')}"><apex:outputText value="{!if(rowSubtotalGroup04ColumnU==0,VZ,RowNumberPattern)}" rendered="{!RenderGroup04 && RenderColumnU}"><apex:param value="{!rowSubtotalGroup04ColumnU}"/></apex:outputText></td>
<td class="{!if(RenderGroup04 && RenderColumnV,'ffrsubtotald','ffrsubtotalhidden')}"><apex:outputText value="{!if(rowSubtotalGroup04ColumnV==0,VZ,RowNumberPattern)}" rendered="{!RenderGroup04 && RenderColumnV}"><apex:param value="{!rowSubtotalGroup04ColumnV}"/></apex:outputText></td>
<td class="{!if(RenderGroup04 && RenderColumnW,'ffrsubtotald','ffrsubtotalhidden')}"><apex:outputText value="{!if(rowSubtotalGroup04ColumnW==0,VZ,RowNumberPattern)}" rendered="{!RenderGroup04 && RenderColumnW}"><apex:param value="{!rowSubtotalGroup04ColumnW}"/></apex:outputText></td>
<td class="{!if(RenderGroup04 && RenderColumnX,'ffrsubtotald','ffrsubtotalhidden')}"><apex:outputText value="{!if(rowSubtotalGroup04ColumnX==0,VZ,RowNumberPattern)}" rendered="{!RenderGroup04 && RenderColumnX}"><apex:param value="{!rowSubtotalGroup04ColumnX}"/></apex:outputText></td>
<td class="{!if(RenderGroup04 && RenderColumnY,'ffrsubtotald','ffrsubtotalhidden')}"><apex:outputText value="{!if(rowSubtotalGroup04ColumnY==0,VZ,RowNumberPattern)}" rendered="{!RenderGroup04 && RenderColumnY}"><apex:param value="{!rowSubtotalGroup04ColumnY}"/></apex:outputText></td>
<td class="{!if(RenderGroup04 && RenderColumnZ,'ffrsubtotald','ffrsubtotalhidden')}"><apex:outputText value="{!if(rowSubtotalGroup04ColumnZ==0,VZ,RowNumberPattern)}" rendered="{!RenderGroup04 && RenderColumnZ}"><apex:param value="{!rowSubtotalGroup04ColumnZ}"/></apex:outputText></td>
</tr>
<!-- Display the group-group values but not the group-line values if Group03 is rendered -->
<!-- Set calculated values as variables (for ease of use) -->
<apex:variable value="{!(rowSubtotalGroup03ColumnA-rowSubtotalGroup03ColumnB)}" var="rowSubtotalGroup03VarianceAB"/>
<apex:variable value="{!(rowSubtotalGroup03ColumnC-rowSubtotalGroup03ColumnD)}" var="rowSubtotalGroup03VarianceCD"/>
<apex:variable value="{!if(rowSubtotalGroup03ColumnB=0,(if(rowSubtotalGroup03ColumnA=0,0,(rowSubtotalGroup03VarianceAB/rowSubtotalGroup03ColumnA))),(rowSubtotalGroup03VarianceAB/rowSubtotalGroup03ColumnB))}" var="rowSubtotalGroup03VariancePercAB"/>
<apex:variable value="{!if(rowSubtotalGroup03ColumnD=0,(if(rowSubtotalGroup03ColumnC=0,0,(rowSubtotalGroup03VarianceCD/rowSubtotalGroup03ColumnC))),(rowSubtotalGroup03VarianceCD/rowSubtotalGroup03ColumnD))}" var="rowSubtotalGroup03VariancePercCD"/>
<tr>
<td class="{!if(RenderGroup03,'ffrsubtotallabeld','ffrsubtotalhidden')}" colspan="11">
<apex:outputPanel layout="none" rendered="{!RenderGroup03}">{!previousLineGroup03}</apex:outputPanel></td>
<td class="{!if(RenderGroup03,'ffrgridspacerd','ffrsubtotalhidden')}"></td>
<td class="{!if(RenderGroup03 && RenderColumnA,'ffrsubtotald','ffrsubtotalhidden')}"><apex:outputText value="{!if(rowSubtotalGroup03ColumnA==0,VZ,RowNumberPattern)}" rendered="{!RenderGroup03 && RenderColumnA}"><apex:param value="{!rowSubtotalGroup03ColumnA}"/></apex:outputText></td>
<td class="{!if(RenderGroup03 && RenderColumnB,'ffrsubtotald','ffrsubtotalhidden')}"><apex:outputText value="{!if(rowSubtotalGroup03ColumnB==0,VZ,RowNumberPattern)}" rendered="{!RenderGroup03 && RenderColumnB}"><apex:param value="{!rowSubtotalGroup03ColumnB}"/></apex:outputText></td>
<!--<td class="{!if(RenderGroup03 && RenderColumnA && RenderColumnB,'ffrsubtotald','ffrsubtotalhidden')}"><apex:outputText value="{!if(rowSubtotalGroup03VarianceAB==0,VZ,RowNumberPattern)}" rendered="{!RenderGroup03 && RenderColumnA && RenderColumnB}"><apex:param value="{!rowSubtotalGroup03VarianceAB}"/></apex:outputText></td>
<td class="{!if(RenderGroup03 && RenderColumnA && RenderColumnB,'ffrsubtotald','ffrsubtotalhidden')}"><apex:outputText value="{!if(rowSubtotalGroup03VariancePercAB==0,PZ,RowPercentagePattern)}" rendered="{!RenderGroup03 && RenderColumnA && RenderColumnB}"><apex:param value="{!rowSubtotalGroup03VariancePercAB}"/></apex:outputText></td>-->
<td class="{!if(RenderGroup03 && RenderColumnC,'ffrsubtotald','ffrsubtotalhidden')}"><apex:outputText value="{!if(rowSubtotalGroup03ColumnC==0,VZ,RowNumberPattern)}" rendered="{!RenderGroup03 && RenderColumnC}"><apex:param value="{!rowSubtotalGroup03ColumnC}"/></apex:outputText></td>
<td class="{!if(RenderGroup03 && RenderColumnD,'ffrsubtotald','ffrsubtotalhidden')}"><apex:outputText value="{!if(rowSubtotalGroup03ColumnD==0,VZ,RowNumberPattern)}" rendered="{!RenderGroup03 && RenderColumnD}"><apex:param value="{!rowSubtotalGroup03ColumnD}"/></apex:outputText></td>
<!--<td class="{!if(RenderGroup03 && RenderColumnC && RenderColumnD,'ffrsubtotald','ffrsubtotalhidden')}"><apex:outputText value="{!if(rowSubtotalGroup03VarianceCD==0,VZ,RowNumberPattern)}" rendered="{!RenderGroup03 && RenderColumnC && RenderColumnD}"><apex:param value="{!rowSubtotalGroup03VarianceCD}"/></apex:outputText></td>
<td class="{!if(RenderGroup03 && RenderColumnC && RenderColumnD,'ffrsubtotald','ffrsubtotalhidden')}"><apex:outputText value="{!if(rowSubtotalGroup03VariancePercCD==0,PZ,RowPercentagePattern)}" rendered="{!RenderGroup03 && RenderColumnC && RenderColumnD}"><apex:param value="{!rowSubtotalGroup03VariancePercCD}"/></apex:outputText></td>-->
<!--Standard lines from this area of the template-->
<td class="{!if(RenderGroup03 && RenderColumnE,'ffrsubtotald','ffrsubtotalhidden')}"><apex:outputText value="{!if(rowSubtotalGroup03ColumnE==0,VZ,RowNumberPattern)}" rendered="{!RenderGroup03 && RenderColumnE}"><apex:param value="{!rowSubtotalGroup03ColumnE}"/></apex:outputText></td>
<td class="{!if(RenderGroup03 && RenderColumnF,'ffrsubtotald','ffrsubtotalhidden')}"><apex:outputText value="{!if(rowSubtotalGroup03ColumnF==0,VZ,RowNumberPattern)}" rendered="{!RenderGroup03 && RenderColumnF}"><apex:param value="{!rowSubtotalGroup03ColumnF}"/></apex:outputText></td>
<td class="{!if(RenderGroup03 && RenderColumnG,'ffrsubtotald','ffrsubtotalhidden')}"><apex:outputText value="{!if(rowSubtotalGroup03ColumnG==0,VZ,RowNumberPattern)}" rendered="{!RenderGroup03 && RenderColumnG}"><apex:param value="{!rowSubtotalGroup03ColumnG}"/></apex:outputText></td>
<td class="{!if(RenderGroup03 && RenderColumnH,'ffrsubtotald','ffrsubtotalhidden')}"><apex:outputText value="{!if(rowSubtotalGroup03ColumnH==0,VZ,RowNumberPattern)}" rendered="{!RenderGroup03 && RenderColumnH}"><apex:param value="{!rowSubtotalGroup03ColumnH}"/></apex:outputText></td>
<td class="{!if(RenderGroup03 && RenderColumnI,'ffrsubtotald','ffrsubtotalhidden')}"><apex:outputText value="{!if(rowSubtotalGroup03ColumnI==0,VZ,RowNumberPattern)}" rendered="{!RenderGroup03 && RenderColumnI}"><apex:param value="{!rowSubtotalGroup03ColumnI}"/></apex:outputText></td>
<td class="{!if(RenderGroup03 && RenderColumnJ,'ffrsubtotald','ffrsubtotalhidden')}"><apex:outputText value="{!if(rowSubtotalGroup03ColumnJ==0,VZ,RowNumberPattern)}" rendered="{!RenderGroup03 && RenderColumnJ}"><apex:param value="{!rowSubtotalGroup03ColumnJ}"/></apex:outputText></td>
<td class="{!if(RenderGroup03 && RenderColumnK,'ffrsubtotald','ffrsubtotalhidden')}"><apex:outputText value="{!if(rowSubtotalGroup03ColumnK==0,VZ,RowNumberPattern)}" rendered="{!RenderGroup03 && RenderColumnK}"><apex:param value="{!rowSubtotalGroup03ColumnK}"/></apex:outputText></td>
<td class="{!if(RenderGroup03 && RenderColumnL,'ffrsubtotald','ffrsubtotalhidden')}"><apex:outputText value="{!if(rowSubtotalGroup03ColumnL==0,VZ,RowNumberPattern)}" rendered="{!RenderGroup03 && RenderColumnL}"><apex:param value="{!rowSubtotalGroup03ColumnL}"/></apex:outputText></td>
<td class="{!if(RenderGroup03 && RenderColumnM,'ffrsubtotald','ffrsubtotalhidden')}"><apex:outputText value="{!if(rowSubtotalGroup03ColumnM==0,VZ,RowNumberPattern)}" rendered="{!RenderGroup03 && RenderColumnM}"><apex:param value="{!rowSubtotalGroup03ColumnM}"/></apex:outputText></td>
<td class="{!if(RenderGroup03 && RenderColumnN,'ffrsubtotald','ffrsubtotalhidden')}"><apex:outputText value="{!if(rowSubtotalGroup03ColumnN==0,VZ,RowNumberPattern)}" rendered="{!RenderGroup03 && RenderColumnN}"><apex:param value="{!rowSubtotalGroup03ColumnN}"/></apex:outputText></td>
<td class="{!if(RenderGroup03 && RenderColumnO,'ffrsubtotald','ffrsubtotalhidden')}"><apex:outputText value="{!if(rowSubtotalGroup03ColumnO==0,VZ,RowNumberPattern)}" rendered="{!RenderGroup03 && RenderColumnO}"><apex:param value="{!rowSubtotalGroup03ColumnO}"/></apex:outputText></td>
<td class="{!if(RenderGroup03 && RenderColumnP,'ffrsubtotald','ffrsubtotalhidden')}"><apex:outputText value="{!if(rowSubtotalGroup03ColumnP==0,VZ,RowNumberPattern)}" rendered="{!RenderGroup03 && RenderColumnP}"><apex:param value="{!rowSubtotalGroup03ColumnP}"/></apex:outputText></td>
<td class="{!if(RenderGroup03 && RenderColumnQ,'ffrsubtotald','ffrsubtotalhidden')}"><apex:outputText value="{!if(rowSubtotalGroup03ColumnQ==0,VZ,RowNumberPattern)}" rendered="{!RenderGroup03 && RenderColumnQ}"><apex:param value="{!rowSubtotalGroup03ColumnQ}"/></apex:outputText></td>
<td class="{!if(RenderGroup03 && RenderColumnR,'ffrsubtotald','ffrsubtotalhidden')}"><apex:outputText value="{!if(rowSubtotalGroup03ColumnR==0,VZ,RowNumberPattern)}" rendered="{!RenderGroup03 && RenderColumnR}"><apex:param value="{!rowSubtotalGroup03ColumnR}"/></apex:outputText></td>
<td class="{!if(RenderGroup03 && RenderColumnS,'ffrsubtotald','ffrsubtotalhidden')}"><apex:outputText value="{!if(rowSubtotalGroup03ColumnS==0,VZ,RowNumberPattern)}" rendered="{!RenderGroup03 && RenderColumnS}"><apex:param value="{!rowSubtotalGroup03ColumnS}"/></apex:outputText></td>
<td class="{!if(RenderGroup03 && RenderColumnT,'ffrsubtotald','ffrsubtotalhidden')}"><apex:outputText value="{!if(rowSubtotalGroup03ColumnT==0,VZ,RowNumberPattern)}" rendered="{!RenderGroup03 && RenderColumnT}"><apex:param value="{!rowSubtotalGroup03ColumnT}"/></apex:outputText></td>
<td class="{!if(RenderGroup03 && RenderColumnU,'ffrsubtotald','ffrsubtotalhidden')}"><apex:outputText value="{!if(rowSubtotalGroup03ColumnU==0,VZ,RowNumberPattern)}" rendered="{!RenderGroup03 && RenderColumnU}"><apex:param value="{!rowSubtotalGroup03ColumnU}"/></apex:outputText></td>
<td class="{!if(RenderGroup03 && RenderColumnV,'ffrsubtotald','ffrsubtotalhidden')}"><apex:outputText value="{!if(rowSubtotalGroup03ColumnV==0,VZ,RowNumberPattern)}" rendered="{!RenderGroup03 && RenderColumnV}"><apex:param value="{!rowSubtotalGroup03ColumnV}"/></apex:outputText></td>
<td class="{!if(RenderGroup03 && RenderColumnW,'ffrsubtotald','ffrsubtotalhidden')}"><apex:outputText value="{!if(rowSubtotalGroup03ColumnW==0,VZ,RowNumberPattern)}" rendered="{!RenderGroup03 && RenderColumnW}"><apex:param value="{!rowSubtotalGroup03ColumnW}"/></apex:outputText></td>
<td class="{!if(RenderGroup03 && RenderColumnX,'ffrsubtotald','ffrsubtotalhidden')}"><apex:outputText value="{!if(rowSubtotalGroup03ColumnX==0,VZ,RowNumberPattern)}" rendered="{!RenderGroup03 && RenderColumnX}"><apex:param value="{!rowSubtotalGroup03ColumnX}"/></apex:outputText></td>
<td class="{!if(RenderGroup03 && RenderColumnY,'ffrsubtotald','ffrsubtotalhidden')}"><apex:outputText value="{!if(rowSubtotalGroup03ColumnY==0,VZ,RowNumberPattern)}" rendered="{!RenderGroup03 && RenderColumnY}"><apex:param value="{!rowSubtotalGroup03ColumnY}"/></apex:outputText></td>
<td class="{!if(RenderGroup03 && RenderColumnZ,'ffrsubtotald','ffrsubtotalhidden')}"><apex:outputText value="{!if(rowSubtotalGroup03ColumnZ==0,VZ,RowNumberPattern)}" rendered="{!RenderGroup03 && RenderColumnZ}"><apex:param value="{!rowSubtotalGroup03ColumnZ}"/></apex:outputText></td>
</tr>
<!-- Set calculated values as variables (for ease of use) -->
<!-- Display the group-group values but not the group-line values if Group02 is rendered -->
<!-- Set calculated values as variables (for ease of use) -->
<apex:variable value="{!(rowSubtotalGroup02ColumnA-rowSubtotalGroup02ColumnB)}" var="rowSubtotalGroup02VarianceAB"/>
<apex:variable value="{!(rowSubtotalGroup02ColumnC-rowSubtotalGroup02ColumnD)}" var="rowSubtotalGroup02VarianceCD"/>
<apex:variable value="{!if(rowSubtotalGroup02ColumnB=0,(if(rowSubtotalGroup02ColumnA=0,0,(rowSubtotalGroup02VarianceAB/rowSubtotalGroup02ColumnA))),(rowSubtotalGroup02VarianceAB/rowSubtotalGroup02ColumnB))}" var="rowSubtotalGroup02VariancePercAB"/>
<apex:variable value="{!if(rowSubtotalGroup02ColumnD=0,(if(rowSubtotalGroup02ColumnC=0,0,(rowSubtotalGroup02VarianceCD/rowSubtotalGroup02ColumnC))),(rowSubtotalGroup02VarianceCD/rowSubtotalGroup02ColumnD))}" var="rowSubtotalGroup02VariancePercCD"/>
<tr>
<td class="{!if(RenderGroup02,'ffrsubtotallabeld','ffrsubtotalhidden')}" colspan="11" style="text-indent: 20px;">
<apex:outputPanel layout="none" rendered="{!RenderGroup02}">Total {!previousLineGroup02}
<apex:variable var="displayheader" value="{!true}"/>
</apex:outputPanel>
</td>
<td class="{!if(RenderGroup02,'ffrgridspacerd','ffrsubtotalhidden')}"></td>
<td class="{!if(RenderGroup02 && RenderColumnA,'ffrsubtotald','ffrsubtotalhidden')}"><apex:outputText value="{!if(rowSubtotalGroup02ColumnA==0,VZ,RowNumberPattern)}" rendered="{!RenderGroup02 && RenderColumnA}"><apex:param value="{!rowSubtotalGroup02ColumnA}"/></apex:outputText></td>
<td class="{!if(RenderGroup02 && RenderColumnB,'ffrsubtotald','ffrsubtotalhidden')}"><apex:outputText value="{!if(rowSubtotalGroup02ColumnB==0,VZ,RowNumberPattern)}" rendered="{!RenderGroup02 && RenderColumnB}"><apex:param value="{!rowSubtotalGroup02ColumnB}"/></apex:outputText></td>
<!--<td class="{!if(RenderGroup02 && RenderColumnA && RenderColumnB,'ffrsubtotald','ffrsubtotalhidden')}"><apex:outputText value="{!if(rowSubtotalGroup02VarianceAB==0,VZ,RowNumberPattern)}" rendered="{!RenderGroup02 && RenderColumnA && RenderColumnB}"><apex:param value="{!rowSubtotalGroup02VarianceAB}"/></apex:outputText></td>
<td class="{!if(RenderGroup02 && RenderColumnA && RenderColumnB,'ffrsubtotald','ffrsubtotalhidden')}"><apex:outputText value="{!if(rowSubtotalGroup02VariancePercAB==0,PZ,RowPercentagePattern)}" rendered="{!RenderGroup02 && RenderColumnA && RenderColumnB}"><apex:param value="{!rowSubtotalGroup02VariancePercAB}"/></apex:outputText></td>-->
<td class="{!if(RenderGroup02 && RenderColumnC,'ffrsubtotald','ffrsubtotalhidden')}"><apex:outputText value="{!if(rowSubtotalGroup02ColumnC==0,VZ,RowNumberPattern)}" rendered="{!RenderGroup02 && RenderColumnC}"><apex:param value="{!rowSubtotalGroup02ColumnC}"/></apex:outputText></td>
<td class="{!if(RenderGroup02 && RenderColumnD,'ffrsubtotald','ffrsubtotalhidden')}"><apex:outputText value="{!if(rowSubtotalGroup02ColumnD==0,VZ,RowNumberPattern)}" rendered="{!RenderGroup02 && RenderColumnD}"><apex:param value="{!rowSubtotalGroup02ColumnD}"/></apex:outputText></td>
<!--<td class="{!if(RenderGroup02 && RenderColumnC && RenderColumnD,'ffrsubtotald','ffrsubtotalhidden')}"><apex:outputText value="{!if(rowSubtotalGroup02VarianceCD==0,VZ,RowNumberPattern)}" rendered="{!RenderGroup02 && RenderColumnC && RenderColumnD}"><apex:param value="{!rowSubtotalGroup02VarianceCD}"/></apex:outputText></td>
<td class="{!if(RenderGroup02 && RenderColumnC && RenderColumnD,'ffrsubtotald','ffrsubtotalhidden')}"><apex:outputText value="{!if(rowSubtotalGroup02VariancePercCD==0,PZ,RowPercentagePattern)}" rendered="{!RenderGroup02 && RenderColumnC && RenderColumnD}"><apex:param value="{!rowSubtotalGroup02VariancePercCD}"/></apex:outputText></td>-->
<!--Standard lines from this area of the template-->
<td class="{!if(RenderGroup02 && RenderColumnE,'ffrsubtotald','ffrsubtotalhidden')}"><apex:outputText value="{!if(rowSubtotalGroup02ColumnE==0,VZ,RowNumberPattern)}" rendered="{!RenderGroup02 && RenderColumnE}"><apex:param value="{!rowSubtotalGroup02ColumnE}"/></apex:outputText></td>
<td class="{!if(RenderGroup02 && RenderColumnF,'ffrsubtotald','ffrsubtotalhidden')}"><apex:outputText value="{!if(rowSubtotalGroup02ColumnF==0,VZ,RowNumberPattern)}" rendered="{!RenderGroup02 && RenderColumnF}"><apex:param value="{!rowSubtotalGroup02ColumnF}"/></apex:outputText></td>
<td class="{!if(RenderGroup02 && RenderColumnG,'ffrsubtotald','ffrsubtotalhidden')}"><apex:outputText value="{!if(rowSubtotalGroup02ColumnG==0,VZ,RowNumberPattern)}" rendered="{!RenderGroup02 && RenderColumnG}"><apex:param value="{!rowSubtotalGroup02ColumnG}"/></apex:outputText></td>
<td class="{!if(RenderGroup02 && RenderColumnH,'ffrsubtotald','ffrsubtotalhidden')}"><apex:outputText value="{!if(rowSubtotalGroup02ColumnH==0,VZ,RowNumberPattern)}" rendered="{!RenderGroup02 && RenderColumnH}"><apex:param value="{!rowSubtotalGroup02ColumnH}"/></apex:outputText></td>
<td class="{!if(RenderGroup02 && RenderColumnI,'ffrsubtotald','ffrsubtotalhidden')}"><apex:outputText value="{!if(rowSubtotalGroup02ColumnI==0,VZ,RowNumberPattern)}" rendered="{!RenderGroup02 && RenderColumnI}"><apex:param value="{!rowSubtotalGroup02ColumnI}"/></apex:outputText></td>
<td class="{!if(RenderGroup02 && RenderColumnJ,'ffrsubtotald','ffrsubtotalhidden')}"><apex:outputText value="{!if(rowSubtotalGroup02ColumnJ==0,VZ,RowNumberPattern)}" rendered="{!RenderGroup02 && RenderColumnJ}"><apex:param value="{!rowSubtotalGroup02ColumnJ}"/></apex:outputText></td>
<td class="{!if(RenderGroup02 && RenderColumnK,'ffrsubtotald','ffrsubtotalhidden')}"><apex:outputText value="{!if(rowSubtotalGroup02ColumnK==0,VZ,RowNumberPattern)}" rendered="{!RenderGroup02 && RenderColumnK}"><apex:param value="{!rowSubtotalGroup02ColumnK}"/></apex:outputText></td>
<td class="{!if(RenderGroup02 && RenderColumnL,'ffrsubtotald','ffrsubtotalhidden')}"><apex:outputText value="{!if(rowSubtotalGroup02ColumnL==0,VZ,RowNumberPattern)}" rendered="{!RenderGroup02 && RenderColumnL}"><apex:param value="{!rowSubtotalGroup02ColumnL}"/></apex:outputText></td>
<td class="{!if(RenderGroup02 && RenderColumnM,'ffrsubtotald','ffrsubtotalhidden')}"><apex:outputText value="{!if(rowSubtotalGroup02ColumnM==0,VZ,RowNumberPattern)}" rendered="{!RenderGroup02 && RenderColumnM}"><apex:param value="{!rowSubtotalGroup02ColumnM}"/></apex:outputText></td>
<td class="{!if(RenderGroup02 && RenderColumnN,'ffrsubtotald','ffrsubtotalhidden')}"><apex:outputText value="{!if(rowSubtotalGroup02ColumnN==0,VZ,RowNumberPattern)}" rendered="{!RenderGroup02 && RenderColumnN}"><apex:param value="{!rowSubtotalGroup02ColumnN}"/></apex:outputText></td>
<td class="{!if(RenderGroup02 && RenderColumnO,'ffrsubtotald','ffrsubtotalhidden')}"><apex:outputText value="{!if(rowSubtotalGroup02ColumnO==0,VZ,RowNumberPattern)}" rendered="{!RenderGroup02 && RenderColumnO}"><apex:param value="{!rowSubtotalGroup02ColumnO}"/></apex:outputText></td>
<td class="{!if(RenderGroup02 && RenderColumnP,'ffrsubtotald','ffrsubtotalhidden')}"><apex:outputText value="{!if(rowSubtotalGroup02ColumnP==0,VZ,RowNumberPattern)}" rendered="{!RenderGroup02 && RenderColumnP}"><apex:param value="{!rowSubtotalGroup02ColumnP}"/></apex:outputText></td>
<td class="{!if(RenderGroup02 && RenderColumnQ,'ffrsubtotald','ffrsubtotalhidden')}"><apex:outputText value="{!if(rowSubtotalGroup02ColumnQ==0,VZ,RowNumberPattern)}" rendered="{!RenderGroup02 && RenderColumnQ}"><apex:param value="{!rowSubtotalGroup02ColumnQ}"/></apex:outputText></td>
<td class="{!if(RenderGroup02 && RenderColumnR,'ffrsubtotald','ffrsubtotalhidden')}"><apex:outputText value="{!if(rowSubtotalGroup02ColumnR==0,VZ,RowNumberPattern)}" rendered="{!RenderGroup02 && RenderColumnR}"><apex:param value="{!rowSubtotalGroup02ColumnR}"/></apex:outputText></td>
<td class="{!if(RenderGroup02 && RenderColumnS,'ffrsubtotald','ffrsubtotalhidden')}"><apex:outputText value="{!if(rowSubtotalGroup02ColumnS==0,VZ,RowNumberPattern)}" rendered="{!RenderGroup02 && RenderColumnS}"><apex:param value="{!rowSubtotalGroup02ColumnS}"/></apex:outputText></td>
<td class="{!if(RenderGroup02 && RenderColumnT,'ffrsubtotald','ffrsubtotalhidden')}"><apex:outputText value="{!if(rowSubtotalGroup02ColumnT==0,VZ,RowNumberPattern)}" rendered="{!RenderGroup02 && RenderColumnT}"><apex:param value="{!rowSubtotalGroup02ColumnT}"/></apex:outputText></td>
<td class="{!if(RenderGroup02 && RenderColumnU,'ffrsubtotald','ffrsubtotalhidden')}"><apex:outputText value="{!if(rowSubtotalGroup02ColumnU==0,VZ,RowNumberPattern)}" rendered="{!RenderGroup02 && RenderColumnU}"><apex:param value="{!rowSubtotalGroup02ColumnU}"/></apex:outputText></td>
<td class="{!if(RenderGroup02 && RenderColumnV,'ffrsubtotald','ffrsubtotalhidden')}"><apex:outputText value="{!if(rowSubtotalGroup02ColumnV==0,VZ,RowNumberPattern)}" rendered="{!RenderGroup02 && RenderColumnV}"><apex:param value="{!rowSubtotalGroup02ColumnV}"/></apex:outputText></td>
<td class="{!if(RenderGroup02 && RenderColumnW,'ffrsubtotald','ffrsubtotalhidden')}"><apex:outputText value="{!if(rowSubtotalGroup02ColumnW==0,VZ,RowNumberPattern)}" rendered="{!RenderGroup02 && RenderColumnW}"><apex:param value="{!rowSubtotalGroup02ColumnW}"/></apex:outputText></td>
<td class="{!if(RenderGroup02 && RenderColumnX,'ffrsubtotald','ffrsubtotalhidden')}"><apex:outputText value="{!if(rowSubtotalGroup02ColumnX==0,VZ,RowNumberPattern)}" rendered="{!RenderGroup02 && RenderColumnX}"><apex:param value="{!rowSubtotalGroup02ColumnX}"/></apex:outputText></td>
<td class="{!if(RenderGroup02 && RenderColumnY,'ffrsubtotald','ffrsubtotalhidden')}"><apex:outputText value="{!if(rowSubtotalGroup02ColumnY==0,VZ,RowNumberPattern)}" rendered="{!RenderGroup02 && RenderColumnY}"><apex:param value="{!rowSubtotalGroup02ColumnY}"/></apex:outputText></td>
<td class="{!if(RenderGroup02 && RenderColumnZ,'ffrsubtotald','ffrsubtotalhidden')}"><apex:outputText value="{!if(rowSubtotalGroup02ColumnZ==0,VZ,RowNumberPattern)}" rendered="{!RenderGroup02 && RenderColumnZ}"><apex:param value="{!rowSubtotalGroup02ColumnZ}"/></apex:outputText></td>
</tr>
</apex:outputPanel>
<!-- Setup for end of row -->
<!-- Add the row-total to the grand-total so that the grand-total accumulates across all the rows -->
<!-- Add up the values for the row total columns -->
<!-- Note that the row-totals are reset for each successive row -->
<tr><td class = "ffrhidden"><apex:variable value="{!0}" var="rowTotal" />
<apex:variable value="{!grandTotalColumnA+rowTotalColumnA}" var="grandTotalColumnA" rendered="{!RenderColumnA}"/>
<apex:variable value="{!rowTotal+rowTotalColumnA}" var="rowTotal" rendered="{!RenderColumnA}"/>
<apex:variable value="{!grandTotalColumnB+rowTotalColumnB}" var="grandTotalColumnB" rendered="{!RenderColumnB}"/>
<apex:variable value="{!rowTotal+rowTotalColumnB}" var="rowTotal" rendered="{!RenderColumnB}"/>
<apex:variable value="{!grandTotalColumnC+rowTotalColumnC}" var="grandTotalColumnC" rendered="{!RenderColumnC}"/>
<apex:variable value="{!rowTotal+rowTotalColumnC}" var="rowTotal" rendered="{!RenderColumnC}"/>
<apex:variable value="{!grandTotalColumnD+rowTotalColumnD}" var="grandTotalColumnD" rendered="{!RenderColumnD}"/>
<apex:variable value="{!rowTotal+rowTotalColumnD}" var="rowTotal" rendered="{!RenderColumnD}"/>
<apex:variable value="{!grandTotalColumnE+rowTotalColumnE}" var="grandTotalColumnE" rendered="{!RenderColumnE}"/>
<apex:variable value="{!rowTotal+rowTotalColumnE}" var="rowTotal" rendered="{!RenderColumnE}"/>
<apex:variable value="{!grandTotalColumnF+rowTotalColumnF}" var="grandTotalColumnF" rendered="{!RenderColumnF}"/>
<apex:variable value="{!rowTotal+rowTotalColumnF}" var="rowTotal" rendered="{!RenderColumnF}"/>
<apex:variable value="{!grandTotalColumnG+rowTotalColumnG}" var="grandTotalColumnG" rendered="{!RenderColumnG}"/>
<apex:variable value="{!rowTotal+rowTotalColumnG}" var="rowTotal" rendered="{!RenderColumnG}"/>
<apex:variable value="{!grandTotalColumnH+rowTotalColumnH}" var="grandTotalColumnH" rendered="{!RenderColumnH}"/>
<apex:variable value="{!rowTotal+rowTotalColumnH}" var="rowTotal" rendered="{!RenderColumnH}"/>
<apex:variable value="{!grandTotalColumnI+rowTotalColumnI}" var="grandTotalColumnI" rendered="{!RenderColumnI}"/>
<apex:variable value="{!rowTotal+rowTotalColumnI}" var="rowTotal" rendered="{!RenderColumnI}"/>
<apex:variable value="{!grandTotalColumnJ+rowTotalColumnJ}" var="grandTotalColumnJ" rendered="{!RenderColumnJ}"/>
<apex:variable value="{!rowTotal+rowTotalColumnJ}" var="rowTotal" rendered="{!RenderColumnJ}"/>
<apex:variable value="{!grandTotalColumnK+rowTotalColumnK}" var="grandTotalColumnK" rendered="{!RenderColumnK}"/>
<apex:variable value="{!rowTotal+rowTotalColumnK}" var="rowTotal" rendered="{!RenderColumnK}"/>
<apex:variable value="{!grandTotalColumnL+rowTotalColumnL}" var="grandTotalColumnL" rendered="{!RenderColumnL}"/>
<apex:variable value="{!rowTotal+rowTotalColumnL}" var="rowTotal" rendered="{!RenderColumnL}"/>
<apex:variable value="{!grandTotalColumnM+rowTotalColumnM}" var="grandTotalColumnM" rendered="{!RenderColumnM}"/>
<apex:variable value="{!rowTotal+rowTotalColumnM}" var="rowTotal" rendered="{!RenderColumnM}"/>
<apex:variable value="{!grandTotalColumnN+rowTotalColumnN}" var="grandTotalColumnN" rendered="{!RenderColumnN}"/>
<apex:variable value="{!rowTotal+rowTotalColumnN}" var="rowTotal" rendered="{!RenderColumnN}"/>
<apex:variable value="{!grandTotalColumnO+rowTotalColumnO}" var="grandTotalColumnO" rendered="{!RenderColumnO}"/>
<apex:variable value="{!rowTotal+rowTotalColumnO}" var="rowTotal" rendered="{!RenderColumnO}"/>
<apex:variable value="{!grandTotalColumnP+rowTotalColumnP}" var="grandTotalColumnP" rendered="{!RenderColumnP}"/>
<apex:variable value="{!rowTotal+rowTotalColumnP}" var="rowTotal" rendered="{!RenderColumnP}"/>
<apex:variable value="{!grandTotalColumnQ+rowTotalColumnQ}" var="grandTotalColumnQ" rendered="{!RenderColumnQ}"/>
<apex:variable value="{!rowTotal+rowTotalColumnQ}" var="rowTotal" rendered="{!RenderColumnQ}"/>
<apex:variable value="{!grandTotalColumnR+rowTotalColumnR}" var="grandTotalColumnR" rendered="{!RenderColumnR}"/>
<apex:variable value="{!rowTotal+rowTotalColumnR}" var="rowTotal" rendered="{!RenderColumnR}"/>
<apex:variable value="{!grandTotalColumnS+rowTotalColumnS}" var="grandTotalColumnS" rendered="{!RenderColumnS}"/>
<apex:variable value="{!rowTotal+rowTotalColumnS}" var="rowTotal" rendered="{!RenderColumnS}"/>
<apex:variable value="{!grandTotalColumnT+rowTotalColumnT}" var="grandTotalColumnT" rendered="{!RenderColumnT}"/>
<apex:variable value="{!rowTotal+rowTotalColumnT}" var="rowTotal" rendered="{!RenderColumnT}"/>
<apex:variable value="{!grandTotalColumnU+rowTotalColumnU}" var="grandTotalColumnU" rendered="{!RenderColumnU}"/>
<apex:variable value="{!rowTotal+rowTotalColumnU}" var="rowTotal" rendered="{!RenderColumnU}"/>
<apex:variable value="{!grandTotalColumnV+rowTotalColumnV}" var="grandTotalColumnV" rendered="{!RenderColumnV}"/>
<apex:variable value="{!rowTotal+rowTotalColumnV}" var="rowTotal" rendered="{!RenderColumnV}"/>
<apex:variable value="{!grandTotalColumnW+rowTotalColumnW}" var="grandTotalColumnW" rendered="{!RenderColumnW}"/>
<apex:variable value="{!rowTotal+rowTotalColumnW}" var="rowTotal" rendered="{!RenderColumnW}"/>
<apex:variable value="{!grandTotalColumnX+rowTotalColumnX}" var="grandTotalColumnX" rendered="{!RenderColumnX}"/>
<apex:variable value="{!rowTotal+rowTotalColumnX}" var="rowTotal" rendered="{!RenderColumnX}"/>
<apex:variable value="{!grandTotalColumnY+rowTotalColumnY}" var="grandTotalColumnY" rendered="{!RenderColumnY}"/>
<apex:variable value="{!rowTotal+rowTotalColumnY}" var="rowTotal" rendered="{!RenderColumnY}"/>
<apex:variable value="{!grandTotalColumnZ+rowTotalColumnZ}" var="grandTotalColumnZ" rendered="{!RenderColumnZ}"/>
<apex:variable value="{!rowTotal+rowTotalColumnZ}" var="rowTotal" rendered="{!RenderColumnZ}"/>
<!-- Accumulate Sales Revenue if the row is in the range 1-10 -->
<apex:outputPanel layout="none" rendered="{!rowKeyNum<11}">
<apex:variable value="{!salesRevenueTotalColumnA+rowTotalColumnA}" var="salesRevenueTotalColumnA" rendered="{!RenderColumnA}"/>
<apex:variable value="{!salesRevenueTotalColumnB+rowTotalColumnB}" var="salesRevenueTotalColumnB" rendered="{!RenderColumnB}"/>
<apex:variable value="{!salesRevenueTotalColumnC+rowTotalColumnC}" var="salesRevenueTotalColumnC" rendered="{!RenderColumnC}"/>
<apex:variable value="{!salesRevenueTotalColumnD+rowTotalColumnD}" var="salesRevenueTotalColumnD" rendered="{!RenderColumnD}"/>
<apex:variable value="{!salesRevenueTotalColumnE+rowTotalColumnE}" var="salesRevenueTotalColumnE" rendered="{!RenderColumnE}"/>
<apex:variable value="{!salesRevenueTotalColumnF+rowTotalColumnF}" var="salesRevenueTotalColumnF" rendered="{!RenderColumnF}"/>
<apex:variable value="{!salesRevenueTotalColumnG+rowTotalColumnG}" var="salesRevenueTotalColumnG" rendered="{!RenderColumnG}"/>
<apex:variable value="{!salesRevenueTotalColumnH+rowTotalColumnH}" var="salesRevenueTotalColumnH" rendered="{!RenderColumnH}"/>
<apex:variable value="{!salesRevenueTotalColumnI+rowTotalColumnI}" var="salesRevenueTotalColumnI" rendered="{!RenderColumnI}"/>
<apex:variable value="{!salesRevenueTotalColumnJ+rowTotalColumnJ}" var="salesRevenueTotalColumnJ" rendered="{!RenderColumnJ}"/>
<apex:variable value="{!salesRevenueTotalColumnK+rowTotalColumnK}" var="salesRevenueTotalColumnK" rendered="{!RenderColumnK}"/>
<apex:variable value="{!salesRevenueTotalColumnL+rowTotalColumnL}" var="salesRevenueTotalColumnL" rendered="{!RenderColumnL}"/>
<apex:variable value="{!salesRevenueTotalColumnM+rowTotalColumnM}" var="salesRevenueTotalColumnM" rendered="{!RenderColumnM}"/>
<apex:variable value="{!salesRevenueTotalColumnN+rowTotalColumnN}" var="salesRevenueTotalColumnN" rendered="{!RenderColumnN}"/>
<apex:variable value="{!salesRevenueTotalColumnO+rowTotalColumnO}" var="salesRevenueTotalColumnO" rendered="{!RenderColumnO}"/>
<apex:variable value="{!salesRevenueTotalColumnP+rowTotalColumnP}" var="salesRevenueTotalColumnP" rendered="{!RenderColumnP}"/>
<apex:variable value="{!salesRevenueTotalColumnQ+rowTotalColumnQ}" var="salesRevenueTotalColumnQ" rendered="{!RenderColumnQ}"/>
<apex:variable value="{!salesRevenueTotalColumnR+rowTotalColumnR}" var="salesRevenueTotalColumnR" rendered="{!RenderColumnR}"/>
<apex:variable value="{!salesRevenueTotalColumnS+rowTotalColumnS}" var="salesRevenueTotalColumnS" rendered="{!RenderColumnS}"/>
<apex:variable value="{!salesRevenueTotalColumnT+rowTotalColumnT}" var="salesRevenueTotalColumnT" rendered="{!RenderColumnT}"/>
<apex:variable value="{!salesRevenueTotalColumnU+rowTotalColumnU}" var="salesRevenueTotalColumnU" rendered="{!RenderColumnU}"/>
<apex:variable value="{!salesRevenueTotalColumnV+rowTotalColumnV}" var="salesRevenueTotalColumnV" rendered="{!RenderColumnV}"/>
<apex:variable value="{!salesRevenueTotalColumnW+rowTotalColumnW}" var="salesRevenueTotalColumnW" rendered="{!RenderColumnW}"/>
<apex:variable value="{!salesRevenueTotalColumnX+rowTotalColumnX}" var="salesRevenueTotalColumnX" rendered="{!RenderColumnX}"/>
<apex:variable value="{!salesRevenueTotalColumnY+rowTotalColumnY}" var="salesRevenueTotalColumnY" rendered="{!RenderColumnY}"/>
<apex:variable value="{!salesRevenueTotalColumnZ+rowTotalColumnZ}" var="salesRevenueTotalColumnZ" rendered="{!RenderColumnZ}"/>
</apex:outputPanel></td></tr>
<!-- Display the row totals -->

<!-- Display the row totals -->
<!-- Set calculated values as variables (for ease of use) -->
<apex:variable value="{!(rowTotalColumnA-rowTotalColumnB)}" var="rowTotalVarianceAB"/>
<apex:variable value="{!(rowTotalColumnC-rowTotalColumnD)}" var="rowTotalVarianceCD"/>
<apex:variable value="{!if(rowTotalColumnB=0,(if(rowTotalColumnA=0,0,(rowTotalVarianceAB/rowTotalColumnA))),(rowTotalVarianceAB/rowTotalColumnB))}" var="rowTotalVariancePercAB"/>
<apex:variable value="{!if(rowTotalColumnD=0,(if(rowTotalColumnC=0,0,(rowTotalVarianceCD/rowTotalColumnC))),(rowTotalVarianceCD/rowTotalColumnD))}" var="rowTotalVariancePercCD"/>
</tbody>
<tr>


<!--Display the title for the row-total - which is the row label -->
<!-- The td tag needs to span the number of groups being rendered -->
<td class="ffrgridsumlabeld" colspan="11">Total {!row.label}</td>
<td class="ffrgridspacerd"/>
<td class="{!if(RenderColumnA,'ffrgridsumd','ffrsubtotalhidden')}">{!Label['L05']}<apex:outputText value="{!if(rowTotalColumnA==0,VZ,RowNumberPattern)}" rendered="{!RenderColumnA}"><apex:param value="{!rowTotalColumnA}"/></apex:outputText></td>
<td class="{!if(RenderColumnB,'ffrgridsumd','ffrsubtotalhidden')}">{!Label['L05']}<apex:outputText value="{!if(rowTotalColumnB==0,VZ,RowNumberPattern)}" rendered="{!RenderColumnB}"><apex:param value="{!rowTotalColumnB}"/></apex:outputText></td>
<!--<td class="{!if(RenderColumnA && RenderColumnB,'ffrgridsumd','ffrsubtotalhidden')}">{!Label['L05']}<apex:outputText value="{!if(rowTotalVarianceAB==0,VZ,RowNumberPattern)}" rendered="{!RenderColumnA && RenderColumnB}"><apex:param value="{!rowTotalVarianceAB}"/></apex:outputText></td>
<td class="{!if(RenderColumnA && RenderColumnB,'ffrgridsumd','ffrsubtotalhidden')}"><apex:outputText value="{!if(rowTotalVariancePercAB==0,PZ,RowPercentagePattern)}" rendered="{!RenderColumnA && RenderColumnB}"><apex:param value="{!rowTotalVariancePercAB}"/></apex:outputText></td> -->
<td class="{!if(RenderColumnC,'ffrgridsumd','ffrsubtotalhidden')}">{!Label['L05']}<apex:outputText value="{!if(rowTotalColumnC==0,VZ,RowNumberPattern)}" rendered="{!RenderColumnC}"><apex:param value="{!rowTotalColumnC}"/></apex:outputText></td>
<td class="{!if(RenderColumnD,'ffrgridsumd','ffrsubtotalhidden')}">{!Label['L05']}<apex:outputText value="{!if(rowTotalColumnD==0,VZ,RowNumberPattern)}" rendered="{!RenderColumnD}"><apex:param value="{!rowTotalColumnD}"/></apex:outputText></td>
<!--<td class="{!if(RenderColumnC && RenderColumnD,'ffrgridsumd','ffrsubtotalhidden')}">{!Label['L05']}<apex:outputText value="{!if(rowTotalVarianceCD==0,VZ,RowNumberPattern)}" rendered="{!RenderColumnC && RenderColumnD}"><apex:param value="{!rowTotalVarianceCD}"/></apex:outputText></td>
<td class="{!if(RenderColumnC && RenderColumnD,'ffrgridsumd','ffrsubtotalhidden')}"><apex:outputText value="{!if(rowTotalVariancePercCD==0,PZ,RowPercentagePattern)}" rendered="{!RenderColumnC && RenderColumnD}"><apex:param value="{!rowTotalVariancePercCD}"/></apex:outputText></td> -->
<!--Standard lines from this area of the template-->
<td class="{!if(RenderColumnE,'ffrgridsumd','ffrsubtotalhidden')}">{!Label['L05']}<apex:outputText value="{!if(rowTotalColumnE==0,VZ,RowNumberPattern)}" rendered="{!RenderColumnE}"><apex:param value="{!rowTotalColumnE}"/></apex:outputText></td>
<td class="{!if(RenderColumnF,'ffrgridsumd','ffrsubtotalhidden')}">{!Label['L05']}<apex:outputText value="{!if(rowTotalColumnF==0,VZ,RowNumberPattern)}" rendered="{!RenderColumnF}"><apex:param value="{!rowTotalColumnF}"/></apex:outputText></td>
<td class="{!if(RenderColumnG,'ffrgridsumd','ffrsubtotalhidden')}">{!Label['L05']}<apex:outputText value="{!if(rowTotalColumnG==0,VZ,RowNumberPattern)}" rendered="{!RenderColumnG}"><apex:param value="{!rowTotalColumnG}"/></apex:outputText></td>
<td class="{!if(RenderColumnH,'ffrgridsumd','ffrsubtotalhidden')}">{!Label['L05']}<apex:outputText value="{!if(rowTotalColumnH==0,VZ,RowNumberPattern)}" rendered="{!RenderColumnH}"><apex:param value="{!rowTotalColumnH}"/></apex:outputText></td>
<td class="{!if(RenderColumnI,'ffrgridsumd','ffrsubtotalhidden')}">{!Label['L05']}<apex:outputText value="{!if(rowTotalColumnI==0,VZ,RowNumberPattern)}" rendered="{!RenderColumnI}"><apex:param value="{!rowTotalColumnI}"/></apex:outputText></td>
<td class="{!if(RenderColumnJ,'ffrgridsumd','ffrsubtotalhidden')}">{!Label['L05']}<apex:outputText value="{!if(rowTotalColumnJ==0,VZ,RowNumberPattern)}" rendered="{!RenderColumnJ}"><apex:param value="{!rowTotalColumnJ}"/></apex:outputText></td>
<td class="{!if(RenderColumnK,'ffrgridsumd','ffrsubtotalhidden')}">{!Label['L05']}<apex:outputText value="{!if(rowTotalColumnK==0,VZ,RowNumberPattern)}" rendered="{!RenderColumnK}"><apex:param value="{!rowTotalColumnK}"/></apex:outputText></td>
<td class="{!if(RenderColumnL,'ffrgridsumd','ffrsubtotalhidden')}">{!Label['L05']}<apex:outputText value="{!if(rowTotalColumnL==0,VZ,RowNumberPattern)}" rendered="{!RenderColumnL}"><apex:param value="{!rowTotalColumnL}"/></apex:outputText></td>
<td class="{!if(RenderColumnM,'ffrgridsumd','ffrsubtotalhidden')}">{!Label['L05']}<apex:outputText value="{!if(rowTotalColumnM==0,VZ,RowNumberPattern)}" rendered="{!RenderColumnM}"><apex:param value="{!rowTotalColumnM}"/></apex:outputText></td>
<td class="{!if(RenderColumnN,'ffrgridsumd','ffrsubtotalhidden')}">{!Label['L05']}<apex:outputText value="{!if(rowTotalColumnN==0,VZ,RowNumberPattern)}" rendered="{!RenderColumnN}"><apex:param value="{!rowTotalColumnN}"/></apex:outputText></td>
<td class="{!if(RenderColumnO,'ffrgridsumd','ffrsubtotalhidden')}">{!Label['L05']}<apex:outputText value="{!if(rowTotalColumnO==0,VZ,RowNumberPattern)}" rendered="{!RenderColumnO}"><apex:param value="{!rowTotalColumnO}"/></apex:outputText></td>
<td class="{!if(RenderColumnP,'ffrgridsumd','ffrsubtotalhidden')}">{!Label['L05']}<apex:outputText value="{!if(rowTotalColumnP==0,VZ,RowNumberPattern)}" rendered="{!RenderColumnP}"><apex:param value="{!rowTotalColumnP}"/></apex:outputText></td>
<td class="{!if(RenderColumnQ,'ffrgridsumd','ffrsubtotalhidden')}">{!Label['L05']}<apex:outputText value="{!if(rowTotalColumnQ==0,VZ,RowNumberPattern)}" rendered="{!RenderColumnQ}"><apex:param value="{!rowTotalColumnQ}"/></apex:outputText></td>
<td class="{!if(RenderColumnR,'ffrgridsumd','ffrsubtotalhidden')}">{!Label['L05']}<apex:outputText value="{!if(rowTotalColumnR==0,VZ,RowNumberPattern)}" rendered="{!RenderColumnR}"><apex:param value="{!rowTotalColumnR}"/></apex:outputText></td>
<td class="{!if(RenderColumnS,'ffrgridsumd','ffrsubtotalhidden')}">{!Label['L05']}<apex:outputText value="{!if(rowTotalColumnS==0,VZ,RowNumberPattern)}" rendered="{!RenderColumnS}"><apex:param value="{!rowTotalColumnS}"/></apex:outputText></td>
<td class="{!if(RenderColumnT,'ffrgridsumd','ffrsubtotalhidden')}">{!Label['L05']}<apex:outputText value="{!if(rowTotalColumnT==0,VZ,RowNumberPattern)}" rendered="{!RenderColumnT}"><apex:param value="{!rowTotalColumnT}"/></apex:outputText></td>
<td class="{!if(RenderColumnU,'ffrgridsumd','ffrsubtotalhidden')}">{!Label['L05']}<apex:outputText value="{!if(rowTotalColumnU==0,VZ,RowNumberPattern)}" rendered="{!RenderColumnU}"><apex:param value="{!rowTotalColumnU}"/></apex:outputText></td>
<td class="{!if(RenderColumnV,'ffrgridsumd','ffrsubtotalhidden')}">{!Label['L05']}<apex:outputText value="{!if(rowTotalColumnV==0,VZ,RowNumberPattern)}" rendered="{!RenderColumnV}"><apex:param value="{!rowTotalColumnV}"/></apex:outputText></td>
<td class="{!if(RenderColumnW,'ffrgridsumd','ffrsubtotalhidden')}">{!Label['L05']}<apex:outputText value="{!if(rowTotalColumnW==0,VZ,RowNumberPattern)}" rendered="{!RenderColumnW}"><apex:param value="{!rowTotalColumnW}"/></apex:outputText></td>
<td class="{!if(RenderColumnX,'ffrgridsumd','ffrsubtotalhidden')}">{!Label['L05']}<apex:outputText value="{!if(rowTotalColumnX==0,VZ,RowNumberPattern)}" rendered="{!RenderColumnX}"><apex:param value="{!rowTotalColumnX}"/></apex:outputText></td>
<td class="{!if(RenderColumnY,'ffrgridsumd','ffrsubtotalhidden')}">{!Label['L05']}<apex:outputText value="{!if(rowTotalColumnY==0,VZ,RowNumberPattern)}" rendered="{!RenderColumnY}"><apex:param value="{!rowTotalColumnY}"/></apex:outputText></td>
<td class="{!if(RenderColumnZ,'ffrgridsumd','ffrsubtotalhidden')}">{!Label['L05']}<apex:outputText value="{!if(rowTotalColumnZ==0,VZ,RowNumberPattern)}" rendered="{!RenderColumnZ}"><apex:param value="{!rowTotalColumnZ}"/></apex:outputText></td>
<!-- Columns Total -->
<!-- Running Total -->
</tr>
<!-- Make some vertical space before the next row -->
<tr><td class="ffrgridspacerd" colspan="11"></td></tr>
</apex:repeat><!-- Go to the next row -->
<!-- Setup for grand-total row -->
<!-- Initialise variable for the total for this row -->
<apex:variable value="{!0}" var="rowTotal"/>
<tr><td class = "ffrhidden">
<apex:variable value="{!rowTotal+grandTotalColumnA}" var="rowTotal" rendered="{!RenderColumnA}"/>
<apex:variable value="{!rowTotal+grandTotalColumnB}" var="rowTotal" rendered="{!RenderColumnB}"/>
<apex:variable value="{!rowTotal+grandTotalColumnC}" var="rowTotal" rendered="{!RenderColumnC}"/>
<apex:variable value="{!rowTotal+grandTotalColumnD}" var="rowTotal" rendered="{!RenderColumnD}"/>
<apex:variable value="{!rowTotal+grandTotalColumnE}" var="rowTotal" rendered="{!RenderColumnE}"/>
<apex:variable value="{!rowTotal+grandTotalColumnF}" var="rowTotal" rendered="{!RenderColumnF}"/>
<apex:variable value="{!rowTotal+grandTotalColumnG}" var="rowTotal" rendered="{!RenderColumnG}"/>
<apex:variable value="{!rowTotal+grandTotalColumnH}" var="rowTotal" rendered="{!RenderColumnH}"/>
<apex:variable value="{!rowTotal+grandTotalColumnI}" var="rowTotal" rendered="{!RenderColumnI}"/>
<apex:variable value="{!rowTotal+grandTotalColumnJ}" var="rowTotal" rendered="{!RenderColumnJ}"/>
<apex:variable value="{!rowTotal+grandTotalColumnK}" var="rowTotal" rendered="{!RenderColumnK}"/>
<apex:variable value="{!rowTotal+grandTotalColumnL}" var="rowTotal" rendered="{!RenderColumnL}"/>
<apex:variable value="{!rowTotal+grandTotalColumnM}" var="rowTotal" rendered="{!RenderColumnM}"/>
<apex:variable value="{!rowTotal+grandTotalColumnN}" var="rowTotal" rendered="{!RenderColumnN}"/>
<apex:variable value="{!rowTotal+grandTotalColumnO}" var="rowTotal" rendered="{!RenderColumnO}"/>
<apex:variable value="{!rowTotal+grandTotalColumnP}" var="rowTotal" rendered="{!RenderColumnP}"/>
<apex:variable value="{!rowTotal+grandTotalColumnQ}" var="rowTotal" rendered="{!RenderColumnQ}"/>
<apex:variable value="{!rowTotal+grandTotalColumnR}" var="rowTotal" rendered="{!RenderColumnR}"/>
<apex:variable value="{!rowTotal+grandTotalColumnS}" var="rowTotal" rendered="{!RenderColumnS}"/>
<apex:variable value="{!rowTotal+grandTotalColumnT}" var="rowTotal" rendered="{!RenderColumnT}"/>
<apex:variable value="{!rowTotal+grandTotalColumnU}" var="rowTotal" rendered="{!RenderColumnU}"/>
<apex:variable value="{!rowTotal+grandTotalColumnV}" var="rowTotal" rendered="{!RenderColumnV}"/>
<apex:variable value="{!rowTotal+grandTotalColumnW}" var="rowTotal" rendered="{!RenderColumnW}"/>
<apex:variable value="{!rowTotal+grandTotalColumnX}" var="rowTotal" rendered="{!RenderColumnX}"/>
<apex:variable value="{!rowTotal+grandTotalColumnY}" var="rowTotal" rendered="{!RenderColumnY}"/>
<apex:variable value="{!rowTotal+grandTotalColumnZ}" var="rowTotal" rendered="{!RenderColumnZ}"/>
</td></tr>
<!-- Display grand-total row -->
<!-- Set calculated values as variables (for ease of use) -->
<apex:variable value="{!(grandTotalColumnA-grandTotalColumnB)}" var="grandTotalVarianceAB"/>
<apex:variable value="{!(grandTotalColumnC-grandTotalColumnD)}" var="grandTotalVarianceCD"/>
<apex:variable value="{!if(grandTotalColumnB=0,(if(grandTotalColumnA=0,0,(grandTotalVarianceAB/grandTotalColumnA))),(grandTotalVarianceAB/grandTotalColumnB))}" var="grandTotalVariancePercAB"/>
<apex:variable value="{!if(grandTotalColumnD=0,(if(grandTotalColumnC=0,0,(grandTotalVarianceCD/grandTotalColumnC))),(grandTotalVarianceCD/grandTotalColumnD))}" var="grandTotalVariancePercCD"/>
<apex:variable value="{!if(salesRevenueTotalColumnA=0,0,grandTotalColumnA/salesRevenueTotalColumnA)}" var="netProfitPercA"/>
<apex:variable value="{!if(salesRevenueTotalColumnB=0,0,grandTotalColumnB/salesRevenueTotalColumnB)}" var="netProfitPercB"/>
<apex:variable value="{!if(salesRevenueTotalColumnC=0,0,grandTotalColumnC/salesRevenueTotalColumnC)}" var="netProfitPercC"/>
<apex:variable value="{!if(salesRevenueTotalColumnD=0,0,grandTotalColumnD/salesRevenueTotalColumnD)}" var="netProfitPercD"/>
<tr>
<!-- The td tag needs to span the number of groups being rendered -->
<td class="ffrgridsumlabeld" colspan="11">{!Label['L12']}</td>
<td class="ffrgridspacerd"/>
<td class="{!if(RenderColumnA,'ffrgridsumd','ffrsubtotalhidden')}">{!Label['L05']}<apex:outputText value="{!if(grandTotalColumnA==0,VZ,VR)}" rendered="{!RenderColumnA}"><apex:param value="{!grandTotalColumnA}"/></apex:outputText></td>
<td class="{!if(RenderColumnB,'ffrgridsumd','ffrsubtotalhidden')}">{!Label['L05']}<apex:outputText value="{!if(grandTotalColumnB==0,VZ,VR)}" rendered="{!RenderColumnB}"><apex:param value="{!grandTotalColumnB}"/></apex:outputText></td>
<!--<td class="{!if(RenderColumnA && RenderColumnB,'ffrgridsumd','ffrsubtotalhidden')}">{!Label['L05']}<apex:outputText value="{!if(grandTotalVarianceAB==0,VZ,VR)}" rendered="{!RenderColumnA && RenderColumnB}"><apex:param value="{!grandTotalVarianceAB}"/></apex:outputText></td>
<td class="{!if(RenderColumnA && RenderColumnB,'ffrgridsumd','ffrsubtotalhidden')}"><apex:outputText value="{!if(grandTotalVariancePercAB==0,PZ,PN)}" rendered="{!RenderColumnA && RenderColumnB}"><apex:param value="{!grandTotalVariancePercAB}"/></apex:outputText></td> -->
<td class="{!if(RenderColumnC,'ffrgridsumd','ffrsubtotalhidden')}">{!Label['L05']}<apex:outputText value="{!if(grandTotalColumnC==0,VZ,VR)}" rendered="{!RenderColumnC}"><apex:param value="{!grandTotalColumnC}"/></apex:outputText></td>
<td class="{!if(RenderColumnD,'ffrgridsumd','ffrsubtotalhidden')}">{!Label['L05']}<apex:outputText value="{!if(grandTotalColumnD==0,VZ,VR)}" rendered="{!RenderColumnD}"><apex:param value="{!grandTotalColumnD}"/></apex:outputText></td>
<!--<td class="{!if(RenderColumnC && RenderColumnD,'ffrgridsumd','ffrsubtotalhidden')}">{!Label['L05']}<apex:outputText value="{!if(grandTotalVarianceCD==0,VZ,VR)}" rendered="{!RenderColumnC && RenderColumnD}"><apex:param value="{!grandTotalVarianceCD}"/></apex:outputText></td>
<td class="{!if(RenderColumnC && RenderColumnD,'ffrgridsumd','ffrsubtotalhidden')}"><apex:outputText value="{!if(grandTotalVariancePercCD==0,PZ,PN)}" rendered="{!RenderColumnC && RenderColumnD}"><apex:param value="{!grandTotalVariancePercCD}"/></apex:outputText></td>-->
<!--Standard lines from this area of the template-->
<td class="{!if(RenderColumnE,'ffrgridsumd','ffrsubtotalhidden')}">{!Label['L05']}<apex:outputText value="{!if(grandTotalColumnE==0,VZ,VR)}" rendered="{!RenderColumnE}"><apex:param value="{!grandTotalColumnE}"/></apex:outputText></td>
<td class="{!if(RenderColumnF,'ffrgridsumd','ffrsubtotalhidden')}">{!Label['L05']}<apex:outputText value="{!if(grandTotalColumnF==0,VZ,VR)}" rendered="{!RenderColumnF}"><apex:param value="{!grandTotalColumnF}"/></apex:outputText></td>
<td class="{!if(RenderColumnG,'ffrgridsumd','ffrsubtotalhidden')}">{!Label['L05']}<apex:outputText value="{!if(grandTotalColumnG==0,VZ,VR)}" rendered="{!RenderColumnG}"><apex:param value="{!grandTotalColumnG}"/></apex:outputText></td>
<td class="{!if(RenderColumnH,'ffrgridsumd','ffrsubtotalhidden')}">{!Label['L05']}<apex:outputText value="{!if(grandTotalColumnH==0,VZ,VR)}" rendered="{!RenderColumnH}"><apex:param value="{!grandTotalColumnH}"/></apex:outputText></td>
<td class="{!if(RenderColumnI,'ffrgridsumd','ffrsubtotalhidden')}">{!Label['L05']}<apex:outputText value="{!if(grandTotalColumnI==0,VZ,VR)}" rendered="{!RenderColumnI}"><apex:param value="{!grandTotalColumnI}"/></apex:outputText></td>
<td class="{!if(RenderColumnJ,'ffrgridsumd','ffrsubtotalhidden')}">{!Label['L05']}<apex:outputText value="{!if(grandTotalColumnJ==0,VZ,VR)}" rendered="{!RenderColumnJ}"><apex:param value="{!grandTotalColumnJ}"/></apex:outputText></td>
<td class="{!if(RenderColumnK,'ffrgridsumd','ffrsubtotalhidden')}">{!Label['L05']}<apex:outputText value="{!if(grandTotalColumnK==0,VZ,VR)}" rendered="{!RenderColumnK}"><apex:param value="{!grandTotalColumnK}"/></apex:outputText></td>
<td class="{!if(RenderColumnL,'ffrgridsumd','ffrsubtotalhidden')}">{!Label['L05']}<apex:outputText value="{!if(grandTotalColumnL==0,VZ,VR)}" rendered="{!RenderColumnL}"><apex:param value="{!grandTotalColumnL}"/></apex:outputText></td>
<td class="{!if(RenderColumnM,'ffrgridsumd','ffrsubtotalhidden')}">{!Label['L05']}<apex:outputText value="{!if(grandTotalColumnM==0,VZ,VR)}" rendered="{!RenderColumnM}"><apex:param value="{!grandTotalColumnM}"/></apex:outputText></td>
<td class="{!if(RenderColumnN,'ffrgridsumd','ffrsubtotalhidden')}">{!Label['L05']}<apex:outputText value="{!if(grandTotalColumnN==0,VZ,VR)}" rendered="{!RenderColumnN}"><apex:param value="{!grandTotalColumnN}"/></apex:outputText></td>
<td class="{!if(RenderColumnO,'ffrgridsumd','ffrsubtotalhidden')}">{!Label['L05']}<apex:outputText value="{!if(grandTotalColumnO==0,VZ,VR)}" rendered="{!RenderColumnO}"><apex:param value="{!grandTotalColumnO}"/></apex:outputText></td>
<td class="{!if(RenderColumnP,'ffrgridsumd','ffrsubtotalhidden')}">{!Label['L05']}<apex:outputText value="{!if(grandTotalColumnP==0,VZ,VR)}" rendered="{!RenderColumnP}"><apex:param value="{!grandTotalColumnP}"/></apex:outputText></td>
<td class="{!if(RenderColumnQ,'ffrgridsumd','ffrsubtotalhidden')}">{!Label['L05']}<apex:outputText value="{!if(grandTotalColumnQ==0,VZ,VR)}" rendered="{!RenderColumnQ}"><apex:param value="{!grandTotalColumnQ}"/></apex:outputText></td>
<td class="{!if(RenderColumnR,'ffrgridsumd','ffrsubtotalhidden')}">{!Label['L05']}<apex:outputText value="{!if(grandTotalColumnR==0,VZ,VR)}" rendered="{!RenderColumnR}"><apex:param value="{!grandTotalColumnR}"/></apex:outputText></td>
<td class="{!if(RenderColumnS,'ffrgridsumd','ffrsubtotalhidden')}">{!Label['L05']}<apex:outputText value="{!if(grandTotalColumnS==0,VZ,VR)}" rendered="{!RenderColumnS}"><apex:param value="{!grandTotalColumnS}"/></apex:outputText></td>
<td class="{!if(RenderColumnT,'ffrgridsumd','ffrsubtotalhidden')}">{!Label['L05']}<apex:outputText value="{!if(grandTotalColumnT==0,VZ,VR)}" rendered="{!RenderColumnT}"><apex:param value="{!grandTotalColumnT}"/></apex:outputText></td>
<td class="{!if(RenderColumnU,'ffrgridsumd','ffrsubtotalhidden')}">{!Label['L05']}<apex:outputText value="{!if(grandTotalColumnU==0,VZ,VR)}" rendered="{!RenderColumnU}"><apex:param value="{!grandTotalColumnU}"/></apex:outputText></td>
<td class="{!if(RenderColumnV,'ffrgridsumd','ffrsubtotalhidden')}">{!Label['L05']}<apex:outputText value="{!if(grandTotalColumnV==0,VZ,VR)}" rendered="{!RenderColumnV}"><apex:param value="{!grandTotalColumnV}"/></apex:outputText></td>
<td class="{!if(RenderColumnW,'ffrgridsumd','ffrsubtotalhidden')}">{!Label['L05']}<apex:outputText value="{!if(grandTotalColumnW==0,VZ,VR)}" rendered="{!RenderColumnW}"><apex:param value="{!grandTotalColumnW}"/></apex:outputText></td>
<td class="{!if(RenderColumnX,'ffrgridsumd','ffrsubtotalhidden')}">{!Label['L05']}<apex:outputText value="{!if(grandTotalColumnX==0,VZ,VR)}" rendered="{!RenderColumnX}"><apex:param value="{!grandTotalColumnX}"/></apex:outputText></td>
<td class="{!if(RenderColumnY,'ffrgridsumd','ffrsubtotalhidden')}">{!Label['L05']}<apex:outputText value="{!if(grandTotalColumnY==0,VZ,VR)}" rendered="{!RenderColumnY}"><apex:param value="{!grandTotalColumnY}"/></apex:outputText></td>
<td class="{!if(RenderColumnZ,'ffrgridsumd','ffrsubtotalhidden')}">{!Label['L05']}<apex:outputText value="{!if(grandTotalColumnZ==0,VZ,VR)}" rendered="{!RenderColumnZ}"><apex:param value="{!grandTotalColumnZ}"/></apex:outputText></td>
<!-- Running Total is blank at grand-total level -->
<!-- Spacer -->
<tr><td class="ffrgridspacerd" colspan="11"></td></tr>
<!-- Display Net Margin % -->
<tr>
<td class="ffrcalcsumlabeld" colspan="11">{!label['L13']}</td>
<td class="ffrgridspacerd"/>
<th class="{!if(RenderColumnA,'ffrcalcsumd','ffrsubtotalhidden')}"><apex:outputText value="{!if(netProfitPercA==0,PZ,PN)}" rendered="{!RenderColumnA}"><apex:param value="{!netProfitPercA}"/></apex:outputText></th>
<th class="{!if(RenderColumnB,'ffrcalcsumd','ffrsubtotalhidden')}"><apex:outputText value="{!if(netProfitPercB==0,PZ,PN)}" rendered="{!RenderColumnB}"><apex:param value="{!netProfitPercB}"/></apex:outputText></th>
<!--<th class="{!if(RenderColumnA && RenderColumnB,'ffrcalcsumd','ffrsubtotalhidden')}"><apex:outputText value="{!if((netProfitPercA-netProfitPercB)==0,PZ,PN)}" rendered="{!RenderColumnA && RenderColumnB}"><apex:param value="{!(netProfitPercA-netProfitPercB)}"/></apex:outputText></th>
<th class="{!if(RenderColumnA && RenderColumnB,'ffrcalcsumd','ffrsubtotalhidden')}"><apex:outputText value="{!if((netProfitPercA-netProfitPercB)==0,PZ,PN)}" rendered="{!RenderColumnA && RenderColumnB}"><apex:param value="{!(netProfitPercA-netProfitPercB)}"/></apex:outputText></th>-->
<th class="{!if(RenderColumnC,'ffrcalcsumd','ffrsubtotalhidden')}"><apex:outputText value="{!if(netProfitPercC==0,PZ,PN)}" rendered="{!RenderColumnC}"><apex:param value="{!netProfitPercC}"/></apex:outputText></th>
<th class="{!if(RenderColumnD,'ffrcalcsumd','ffrsubtotalhidden')}"><apex:outputText value="{!if(netProfitPercD==0,PZ,PN)}" rendered="{!RenderColumnD}"><apex:param value="{!netProfitPercD}"/></apex:outputText></th>
<!--<th class="{!if(RenderColumnC && RenderColumnD,'ffrcalcsumd','ffrsubtotalhidden')}"><apex:outputText value="{!if((netProfitPercC-netProfitPercD)==0,PZ,PN)}" rendered="{!RenderColumnC && RenderColumnD}"><apex:param value="{!(netProfitPercC-netProfitPercD)}"/></apex:outputText></th>
<th class="{!if(RenderColumnC && RenderColumnD,'ffrcalcsumd','ffrsubtotalhidden')}"><apex:outputText value="{!if((netProfitPercC-netProfitPercD)==0,PZ,PN)}" rendered="{!RenderColumnC && RenderColumnD}"><apex:param value="{!(netProfitPercC-netProfitPercD)}"/></apex:outputText></th>-->
<th class="{!if(RenderColumnE,'ffrcalcsumd','ffrsubtotalhidden')}"><apex:outputText value="{!if(if(salesRevenueTotalColumnE=0,0,grandTotalColumnE/salesRevenueTotalColumnE)==0,PZ,PN)}" rendered="{!RenderColumnE}"><apex:param value="{!if(salesRevenueTotalColumnE=0,0,grandTotalColumnE/salesRevenueTotalColumnE)}"/></apex:outputText></th>
<th class="{!if(RenderColumnF,'ffrcalcsumd','ffrsubtotalhidden')}"><apex:outputText value="{!if(if(salesRevenueTotalColumnF=0,0,grandTotalColumnF/salesRevenueTotalColumnF)==0,PZ,PN)}" rendered="{!RenderColumnF}"><apex:param value="{!if(salesRevenueTotalColumnF=0,0,grandTotalColumnF/salesRevenueTotalColumnF)}"/></apex:outputText></th>
<th class="{!if(RenderColumnG,'ffrcalcsumd','ffrsubtotalhidden')}"><apex:outputText value="{!if(if(salesRevenueTotalColumnG=0,0,grandTotalColumnG/salesRevenueTotalColumnG)==0,PZ,PN)}" rendered="{!RenderColumnG}"><apex:param value="{!if(salesRevenueTotalColumnG=0,0,grandTotalColumnG/salesRevenueTotalColumnG)}"/></apex:outputText></th>
<th class="{!if(RenderColumnH,'ffrcalcsumd','ffrsubtotalhidden')}"><apex:outputText value="{!if(if(salesRevenueTotalColumnH=0,0,grandTotalColumnH/salesRevenueTotalColumnH)==0,PZ,PN)}" rendered="{!RenderColumnH}"><apex:param value="{!if(salesRevenueTotalColumnH=0,0,grandTotalColumnH/salesRevenueTotalColumnH)}"/></apex:outputText></th>
<th class="{!if(RenderColumnI,'ffrcalcsumd','ffrsubtotalhidden')}"><apex:outputText value="{!if(if(salesRevenueTotalColumnI=0,0,grandTotalColumnI/salesRevenueTotalColumnI)==0,PZ,PN)}" rendered="{!RenderColumnI}"><apex:param value="{!if(salesRevenueTotalColumnI=0,0,grandTotalColumnI/salesRevenueTotalColumnI)}"/></apex:outputText></th>
<th class="{!if(RenderColumnJ,'ffrcalcsumd','ffrsubtotalhidden')}"><apex:outputText value="{!if(if(salesRevenueTotalColumnJ=0,0,grandTotalColumnJ/salesRevenueTotalColumnJ)==0,PZ,PN)}" rendered="{!RenderColumnJ}"><apex:param value="{!if(salesRevenueTotalColumnJ=0,0,grandTotalColumnJ/salesRevenueTotalColumnJ)}"/></apex:outputText></th>
<th class="{!if(RenderColumnK,'ffrcalcsumd','ffrsubtotalhidden')}"><apex:outputText value="{!if(if(salesRevenueTotalColumnK=0,0,grandTotalColumnK/salesRevenueTotalColumnK)==0,PZ,PN)}" rendered="{!RenderColumnK}"><apex:param value="{!if(salesRevenueTotalColumnK=0,0,grandTotalColumnK/salesRevenueTotalColumnK)}"/></apex:outputText></th>
<th class="{!if(RenderColumnL,'ffrcalcsumd','ffrsubtotalhidden')}"><apex:outputText value="{!if(if(salesRevenueTotalColumnL=0,0,grandTotalColumnL/salesRevenueTotalColumnL)==0,PZ,PN)}" rendered="{!RenderColumnL}"><apex:param value="{!if(salesRevenueTotalColumnL=0,0,grandTotalColumnL/salesRevenueTotalColumnL)}"/></apex:outputText></th>
<th class="{!if(RenderColumnM,'ffrcalcsumd','ffrsubtotalhidden')}"><apex:outputText value="{!if(if(salesRevenueTotalColumnM=0,0,grandTotalColumnM/salesRevenueTotalColumnM)==0,PZ,PN)}" rendered="{!RenderColumnM}"><apex:param value="{!if(salesRevenueTotalColumnM=0,0,grandTotalColumnM/salesRevenueTotalColumnM)}"/></apex:outputText></th>
<th class="{!if(RenderColumnN,'ffrcalcsumd','ffrsubtotalhidden')}"><apex:outputText value="{!if(if(salesRevenueTotalColumnN=0,0,grandTotalColumnN/salesRevenueTotalColumnN)==0,PZ,PN)}" rendered="{!RenderColumnN}"><apex:param value="{!if(salesRevenueTotalColumnN=0,0,grandTotalColumnN/salesRevenueTotalColumnN)}"/></apex:outputText></th>
<th class="{!if(RenderColumnO,'ffrcalcsumd','ffrsubtotalhidden')}"><apex:outputText value="{!if(if(salesRevenueTotalColumnO=0,0,grandTotalColumnO/salesRevenueTotalColumnO)==0,PZ,PN)}" rendered="{!RenderColumnO}"><apex:param value="{!if(salesRevenueTotalColumnO=0,0,grandTotalColumnO/salesRevenueTotalColumnO)}"/></apex:outputText></th>
<th class="{!if(RenderColumnP,'ffrcalcsumd','ffrsubtotalhidden')}"><apex:outputText value="{!if(if(salesRevenueTotalColumnP=0,0,grandTotalColumnP/salesRevenueTotalColumnP)==0,PZ,PN)}" rendered="{!RenderColumnP}"><apex:param value="{!if(salesRevenueTotalColumnP=0,0,grandTotalColumnP/salesRevenueTotalColumnP)}"/></apex:outputText></th>
<th class="{!if(RenderColumnQ,'ffrcalcsumd','ffrsubtotalhidden')}"><apex:outputText value="{!if(if(salesRevenueTotalColumnQ=0,0,grandTotalColumnQ/salesRevenueTotalColumnQ)==0,PZ,PN)}" rendered="{!RenderColumnQ}"><apex:param value="{!if(salesRevenueTotalColumnQ=0,0,grandTotalColumnQ/salesRevenueTotalColumnQ)}"/></apex:outputText></th>
<th class="{!if(RenderColumnR,'ffrcalcsumd','ffrsubtotalhidden')}"><apex:outputText value="{!if(if(salesRevenueTotalColumnR=0,0,grandTotalColumnR/salesRevenueTotalColumnR)==0,PZ,PN)}" rendered="{!RenderColumnR}"><apex:param value="{!if(salesRevenueTotalColumnR=0,0,grandTotalColumnR/salesRevenueTotalColumnR)}"/></apex:outputText></th>
<th class="{!if(RenderColumnS,'ffrcalcsumd','ffrsubtotalhidden')}"><apex:outputText value="{!if(if(salesRevenueTotalColumnS=0,0,grandTotalColumnS/salesRevenueTotalColumnS)==0,PZ,PN)}" rendered="{!RenderColumnS}"><apex:param value="{!if(salesRevenueTotalColumnS=0,0,grandTotalColumnS/salesRevenueTotalColumnS)}"/></apex:outputText></th>
<th class="{!if(RenderColumnT,'ffrcalcsumd','ffrsubtotalhidden')}"><apex:outputText value="{!if(if(salesRevenueTotalColumnT=0,0,grandTotalColumnT/salesRevenueTotalColumnT)==0,PZ,PN)}" rendered="{!RenderColumnT}"><apex:param value="{!if(salesRevenueTotalColumnT=0,0,grandTotalColumnT/salesRevenueTotalColumnT)}"/></apex:outputText></th>
<th class="{!if(RenderColumnU,'ffrcalcsumd','ffrsubtotalhidden')}"><apex:outputText value="{!if(if(salesRevenueTotalColumnU=0,0,grandTotalColumnU/salesRevenueTotalColumnU)==0,PZ,PN)}" rendered="{!RenderColumnU}"><apex:param value="{!if(salesRevenueTotalColumnU=0,0,grandTotalColumnU/salesRevenueTotalColumnU)}"/></apex:outputText></th>
<th class="{!if(RenderColumnV,'ffrcalcsumd','ffrsubtotalhidden')}"><apex:outputText value="{!if(if(salesRevenueTotalColumnV=0,0,grandTotalColumnV/salesRevenueTotalColumnV)==0,PZ,PN)}" rendered="{!RenderColumnV}"><apex:param value="{!if(salesRevenueTotalColumnV=0,0,grandTotalColumnV/salesRevenueTotalColumnV)}"/></apex:outputText></th>
<th class="{!if(RenderColumnW,'ffrcalcsumd','ffrsubtotalhidden')}"><apex:outputText value="{!if(if(salesRevenueTotalColumnW=0,0,grandTotalColumnW/salesRevenueTotalColumnW)==0,PZ,PN)}" rendered="{!RenderColumnW}"><apex:param value="{!if(salesRevenueTotalColumnW=0,0,grandTotalColumnW/salesRevenueTotalColumnW)}"/></apex:outputText></th>
<th class="{!if(RenderColumnX,'ffrcalcsumd','ffrsubtotalhidden')}"><apex:outputText value="{!if(if(salesRevenueTotalColumnX=0,0,grandTotalColumnX/salesRevenueTotalColumnX)==0,PZ,PN)}" rendered="{!RenderColumnX}"><apex:param value="{!if(salesRevenueTotalColumnX=0,0,grandTotalColumnX/salesRevenueTotalColumnX)}"/></apex:outputText></th>
<th class="{!if(RenderColumnY,'ffrcalcsumd','ffrsubtotalhidden')}"><apex:outputText value="{!if(if(salesRevenueTotalColumnY=0,0,grandTotalColumnY/salesRevenueTotalColumnY)==0,PZ,PN)}" rendered="{!RenderColumnY}"><apex:param value="{!if(salesRevenueTotalColumnY=0,0,grandTotalColumnY/salesRevenueTotalColumnY)}"/></apex:outputText></th>
<th class="{!if(RenderColumnZ,'ffrcalcsumd','ffrsubtotalhidden')}"><apex:outputText value="{!if(if(salesRevenueTotalColumnZ=0,0,grandTotalColumnZ/salesRevenueTotalColumnZ)==0,PZ,PN)}" rendered="{!RenderColumnZ}"><apex:param value="{!if(salesRevenueTotalColumnZ=0,0,grandTotalColumnZ/salesRevenueTotalColumnZ)}"/></apex:outputText></th>
</tr>
<!-- Spacer -->
<tr><td class="ffrgridspacerd" colspan="11"></td></tr>
</tr>
</table>
</apex:repeat>
<!-- REGION 06: REPORT CHATTER START -->
<ffr:ShowChatter value="{!ReportingLog}" rendered="{!PrintChatterFeed}"/>
<!-- REGION 06: REPORT CHATTER END -->

<apex:includeScript value="{!URLFOR($Resource.ReportingJavascript, '/Javascripting/jquery-1.11.2.min.js')}"/>
<apex:includeScript value="{!URLFOR($Resource.ReportingJavascript, '/Javascripting/jquery-ui.min.js')}"/>
<apex:includeScript value="{!URLFOR($Resource.ReportingJavascript, '/Javascripting/JavascriptTest.js')}"/>


</apex:page>